<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hexo+Nextæ­å»ºåšå®¢ï¼šåŸºç¡€æ­å»º</title>
    <url>/archives/92090b6.html</url>
    <content><![CDATA[<h3 id="ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#ç¯å¢ƒ"></a> ç¯å¢ƒ</h3>
<p>é€šè¿‡ <code>Hexo</code> æ­å»ºåšå®¢å‰ï¼Œéœ€è¦åœ¨æœ¬åœ°å®‰è£…ä¸€äº›å¿…è¦çš„ç¯å¢ƒã€‚</p>
<h4 id="nodejs"><a class="markdownIt-Anchor" href="#nodejs"></a> node.js</h4>
<p>å‘½ä»¤è¡Œå®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ brew install nodejs</span><br></pre></td></tr></table></figure>
<h4 id="npm"><a class="markdownIt-Anchor" href="#npm"></a> npm</h4>
<p>å‘½ä»¤è¡Œå®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ brew install npm</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h3 id="hexo"><a class="markdownIt-Anchor" href="#hexo"></a> Hexo</h3>
<p><code>Hexo</code> æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚</p>
<h4 id="å®‰è£…-hexo"><a class="markdownIt-Anchor" href="#å®‰è£…-hexo"></a> å®‰è£… Hexo</h4>
<p>å‘½ä»¤è¡Œå®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºæœ¬åœ°åšå®¢"><a class="markdownIt-Anchor" href="#åˆ›å»ºæœ¬åœ°åšå®¢"></a> åˆ›å»ºæœ¬åœ°åšå®¢</h4>
<p>åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå¦‚ï¼š<code>Blog</code>ï¼Œåœ¨æ­¤ç›®å½•ä¸‹æ‰§è¡Œåˆå§‹åŒ–</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mkdir Blog</span><br><span class="line">$ <span class="built_in">cd</span> Blog</span><br><span class="line">$ hexo init</span><br><span class="line">$ hexo generate     <span class="comment"># ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">$ hexo server       <span class="comment"># åœ¨æœ¬åœ°æœåŠ¡å™¨è¿è¡Œ</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨è®¿é—® <a href="http://localhost:4000/">http://localhost:4000</a>ã€‚</p>
<p>ä¹‹åå°±å¯ä»¥é€šè¿‡ <code>hexo new page pageName</code> å’Œ <code>hexo new postName</code> åˆ›å»ºæ–°çš„é¡µé¢ <code>page</code> å’Œ æ–‡ç«  <code>post</code> äº†ã€‚</p>
<h3 id="next"><a class="markdownIt-Anchor" href="#next"></a> NexT</h3>
<p><code>Hexo</code> è‡ªå¸¦çš„ä¸»é¢˜ä¸æ˜¯å¾ˆç¾è§‚ï¼ˆä¸ªäººæ„Ÿè§‰ï¼‰ï¼Œå¯ä»¥å®‰è£…å…¶ä»–ä¸»é¢˜æ¥ç¾åŒ–åšå®¢ã€‚</p>
<p><code>Hexo</code> æä¾›ä¼—å¤šä¸»é¢˜ä¾›ç”¨æˆ·é€‰æ‹©ï¼Œè¿™é‡Œé€‰æ‹©ä½¿ç”¨äººæ•°æœ€å¤šçš„ <code>Next</code> ä¸»é¢˜ã€‚</p>
<h4 id="å®‰è£…ä¸»é¢˜"><a class="markdownIt-Anchor" href="#å®‰è£…ä¸»é¢˜"></a> å®‰è£…ä¸»é¢˜</h4>
<p>ä¸»é¢˜çš„å®‰è£…æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>
<div class="tabs" id="next-å®‰è£…"><ul class="nav-tabs"><li class="tab active"><a href="#next-å®‰è£…-1">git å®‰è£…</a></li><li class="tab"><a href="#next-å®‰è£…-2">npm å®‰è£…</a></li></ul><div class="tab-content"><div class="tab-pane active" id="next-å®‰è£…-1"><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/next-theme/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="next-å®‰è£…-2"><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-theme-next@latest</span><br></pre></td></tr></table></figure></div></div></div>
<p>ä»¥ä¸Šä¸¤ç§æ–¹å¼å®‰è£…çš„éƒ½æ˜¯ <code>NexT</code> çš„æœ€æ–°ç‰ˆæœ¬ã€‚</p>
<h4 id="å¯ç”¨ä¸»é¢˜"><a class="markdownIt-Anchor" href="#å¯ç”¨ä¸»é¢˜"></a> å¯ç”¨ä¸»é¢˜</h4>
<p>ä¿®æ”¹ç«™ç‚¹ï¼ˆåšå®¢ï¼‰é…ç½®æ–‡ä»¶ <code>_config.xml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure>
<h3 id="å°†åšå®¢éƒ¨ç½²åˆ°-gitee-pages"><a class="markdownIt-Anchor" href="#å°†åšå®¢éƒ¨ç½²åˆ°-gitee-pages"></a> å°†åšå®¢éƒ¨ç½²åˆ° Gitee Pages</h3>
<p><code>Gitee Pages</code> æ˜¯ä¸€ä¸ªå…è´¹çš„é™æ€ç½‘é¡µæ‰˜ç®¡æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>Gitee Pages</code> æ‰˜ç®¡åšå®¢ã€é¡¹ç›®å®˜ç½‘ç­‰é™æ€ç½‘é¡µã€‚ç›®å‰ <code>Gitee Pages</code> æ”¯æŒ <code>Jekyll</code>ã€<code>Hugo</code>ã€<code>Hexo</code>ç¼–è¯‘é™æ€èµ„æºã€‚</p>
<h4 id="æ³¨å†Œ-gtiee-è´¦å·"><a class="markdownIt-Anchor" href="#æ³¨å†Œ-gtiee-è´¦å·"></a> æ³¨å†Œ Gtiee è´¦å·</h4>
<h4 id="åˆ›å»ºä»“åº“"><a class="markdownIt-Anchor" href="#åˆ›å»ºä»“åº“"></a> åˆ›å»ºä»“åº“</h4>
<p><strong>æ³¨æ„<mark>è·¯å¾„</mark>ä¸€å®šè¦å¡«å†™ <code>username.gitee.io</code> è¿™æ ·åé¢æ‰èƒ½ä½¿ç”¨ <code>Gitee Pages</code> åŠŸèƒ½ã€‚</strong></p>
<p>æ¯ä¸ªå¸å·åªèƒ½æœ‰ä¸€ä¸ªä»“åº“æ¥å­˜æ”¾ä¸ªäººä¸»é¡µï¼Œè€Œä¸”ä»“åº“çš„åå­—å¿…é¡»æ˜¯ <code>username/username.gitee.io</code>ï¼Œè¿™æ˜¯ç‰¹æ®Šçš„å‘½åçº¦å®šï¼Œä¹‹åå°±å¯ä»¥é€šè¿‡ <a href="http://username.gitee.io/">http://username.gitee.io</a>  æ¥è®¿é—®ä¸ªäººä¸»é¡µã€‚</p>
<h4 id="é…ç½®-ssh"><a class="markdownIt-Anchor" href="#é…ç½®-ssh"></a> é…ç½® SSH</h4>
<p>ä¸Šä¼ æ–‡ä»¶éœ€è¦é…ç½® <code>ssh key</code>ï¼Œä¸ç„¶æ— æ³•ä¸Šä¼ ã€‚</p>
<p>é¦–å…ˆå…ˆæ£€æŸ¥ä¸€ä¸‹æœ¬åœ°æ˜¯å¦å·²ç»å­˜åœ¨ <code>ssh key</code>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ls -al ~/.ssh</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä¸å­˜åœ¨ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C <span class="string">&quot;XXXXX@qq.com&quot;</span></span><br></pre></td></tr></table></figure>
<p>é‚®ç®±æ˜¯æ³¨å†Œ <code>Gitee</code> æ—¶å€™çš„é‚®ç®±ã€‚</p>
<p>æ‰§è¡Œå®Œåä¼šåœ¨ <code>~/.ssh/</code>ä¸‹ç”Ÿæˆ <code>id_rsa</code> å’Œ <code>id_rsa.pub</code> ä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<p>ç‚¹å‡» <code>Gitee -&gt; å³ä¸Šè§’è®¾ç½® -&gt; SSH å…¬é’¥</code>ï¼Œå°† <code>id_rsa.pub</code> æ–‡ä»¶å†…å®¹å¤åˆ¶è¿›å»å³å¯ã€‚</p>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh git@gitee.com</span><br></pre></td></tr></table></figure>
<h4 id="å°†æœ¬åœ°åšå®¢éƒ¨ç½²åˆ°-gitee"><a class="markdownIt-Anchor" href="#å°†æœ¬åœ°åšå®¢éƒ¨ç½²åˆ°-gitee"></a> å°†æœ¬åœ°åšå®¢éƒ¨ç½²åˆ° Gitee</h4>
<p>å®‰è£… <code>git</code> éƒ¨ç½²éœ€è¦çš„åŒ…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-deployer-git â€”save</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘ç«™ç‚¹ï¼ˆåšå®¢ï¼‰é…ç½®æ–‡ä»¶ <code>_config.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@gitee.com:username/username.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
<p>éƒ¨ç½²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€ä¹‹å‰åˆ›å»ºçš„ä»“åº“ <code>gitee/username/username</code> ï¼Œç‚¹å‡»<code>æœåŠ¡ -&gt; Gitee Pages -&gt;æ›´æ–°</code>ï¼Œå°±å¯ä»¥é€šè¿‡ <a href="https://gitee.username.io">https://gitee.username.io</a> è®¿é—®ä¸ªäººåšå®¢äº†ã€‚ä¸è¿‡æœ‰ä¸€ç‚¹ä¸å¥½çš„æ˜¯ï¼Œæ¯å½“åœ¨æœ¬æ–‡åˆ›å»ºäº†æ–°çš„ <code>post</code> æˆ– <code>page</code> å¹¶é‡æ–°éƒ¨ç½²åï¼Œéƒ½éœ€è¦æ‰‹åŠ¨åœ¨ <code>Gitee Pages</code> æ›´æ–°ä¸€ä¸‹æ‰èƒ½çœ‹åˆ°æœ€æ–°æäº¤çš„å†…å®¹ã€‚</p>
]]></content>
      <categories>
        <category>Hexo&amp;NexT</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>NexT</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo+Nextæ­å»ºåšå®¢ï¼šä¸»é¢˜åˆæ­¥ç¾åŒ–</title>
    <url>/archives/54ce2e51.html</url>
    <content><![CDATA[<p>å®‰è£…å¹¶å¯ç”¨ <code>Next</code> ä¸»é¢˜åï¼Œæœ‰å¿…è¦å¯¹å…¶è¿›è¡Œè¿›ä¸€æ­¥çš„ç¾åŒ–ã€‚é€šè¿‡é˜…è¯» <a href="https://theme-next.js.org/">NexT å®˜æ–¹æ–‡æ¡£</a> ä»¥åŠç½‘ä¸Šæœç½—çš„ä¸€äº›å…¶ä»–å¤§ç¥çš„æ–‡ç« ï¼Œæœ¬æ–‡æ€»ç»“äº†ä¸€äº›å¯¹ <code>NexT</code> çš„åˆæ­¥ç¾åŒ–æ“ä½œæ­¥éª¤ã€‚</p>
<p>æ–°ç‰ˆ <code>NexT</code> å»ºè®®å¤åˆ¶ä¸»é¢˜é…ç½®æ–‡ä»¶åˆ°ç«™ç‚¹æ ¹ç›®å½•ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Installed through npm</span></span><br><span class="line">cp node_modules/hexo-theme-next/_config.yml _config.next.yml</span><br><span class="line"></span><br><span class="line"><span class="comment"># Installed through Git</span></span><br><span class="line">cp theme/next/_config.yml _config.next.yml</span><br></pre></td></tr></table></figure>
<p>ä¹‹åå¯¹ä¸»é¢˜çš„ä¿®æ”¹å°±åœ¨ <code>_config.next.yml</code> ä¸­è¿›è¡Œé…ç½®ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥ä¸æ”¹åŠ¨ <code>NexT</code> åŒ…ä¸­çš„å†…å®¹ï¼Œå¦‚æœä¸»é¢˜æœ‰æ›´æ–°ï¼Œæœ¬åœ°å¯ä»¥æ›´åŠ çš„å¹³æ»‘çš„éšä¹‹å‡çº§ã€‚</p>
<span id="more"></span>
<h3 id="èƒŒæ™¯å›¾ç‰‡"><a class="markdownIt-Anchor" href="#èƒŒæ™¯å›¾ç‰‡"></a> èƒŒæ™¯å›¾ç‰‡</h3>
<p>å°†å›¾ç‰‡æ”¾è¿› <code>source/images</code> æ–‡ä»¶å¤¹ã€‚</p>
<p>ï¼ˆåˆ›å»ºï¼‰ä¿®æ”¹ <code>source/_data/styles.styl</code>ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// èƒŒæ™¯å›¾ç‰‡</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">/images/bg.jpg</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-attachment</span>: fixed; //ä¸é‡å¤</span><br><span class="line">    <span class="attribute">background-size</span>: cover;      //å¡«å……</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">50%</span> <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ <code>_config.next.yml</code> ä¸­å¯ç”¨</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">custom_file_path:</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">source/_data/styles.styl</span></span><br></pre></td></tr></table></figure>
<p>èƒŒæ™¯å›¾ç‰‡ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºåŠ¨æ€çš„ï¼Œå°† <code>url</code> æ¢æˆå›¾ç‰‡ç½‘ç«™é“¾æ¥å³å¯ï¼Œå¦‚ï¼š<a href="https://source.unsplash.com/random/1600x900">unsplash</a>ã€‚è¿™æ ·æ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½ä¼šåŠ è½½ä¸åŒçš„èƒŒæ™¯å›¾ç‰‡ã€‚</p>
<p>åŒæ—¶ï¼Œä¸ºäº†æ›´å¥½åœ°æ˜¾ç¤ºèƒŒæ™¯å›¾ç‰‡ï¼Œå¯ä»¥è®¾ç½®æ–‡ç« çš„é€æ˜åº¦ã€‚</p>
<p>ä¿®æ”¹ <code>source/_data/styles.styl</code>ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">//æ–‡ç« å†…å®¹çš„é€æ˜åº¦è®¾ç½®</span><br><span class="line"><span class="selector-class">.content-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.85</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ä¾§è¾¹æ¡†çš„é€æ˜åº¦è®¾ç½®</span><br><span class="line"><span class="selector-class">.sidebar</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.85</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//èœå•æ çš„é€æ˜åº¦è®¾ç½®</span><br><span class="line"><span class="selector-class">.header-inner</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.85</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æœç´¢æ¡†ï¼ˆlocal-searchï¼‰çš„é€æ˜åº¦è®¾ç½®</span><br><span class="line"><span class="selector-class">.popup</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0.9</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>opacity</code> èŒƒå›´æ˜¯ 0~1ï¼Œ0 è¡¨ç¤ºå®Œå…¨é€æ˜ï¼Œ1 è¡¨ç¤ºå®Œå…¨ä¸é€æ˜ã€‚</p>
<h3 id="ä¾§è¾¹æ "><a class="markdownIt-Anchor" href="#ä¾§è¾¹æ "></a> ä¾§è¾¹æ </h3>
<h4 id="èœå•é¡¹"><a class="markdownIt-Anchor" href="#èœå•é¡¹"></a> èœå•é¡¹</h4>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># _config.next.yml</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="comment">#home: / || fa fa-home</span></span><br><span class="line">  <span class="comment">#about: /about/ || fa fa-user</span></span><br><span class="line">  <span class="comment">#tags: /tags/ || fa fa-tags</span></span><br><span class="line">  <span class="comment">#categories: /categories/ || fa fa-th</span></span><br><span class="line">  <span class="comment">#archives: /archives/ || fa fa-archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || fa fa-calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || fa fa-sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || fa fa-heartbeat</span></span><br></pre></td></tr></table></figure>
<p>æ–°ç‰ˆ <code>NexT</code> çš„é…ç½®æ–‡ä»¶é»˜è®¤æ²¡æœ‰ç”Ÿæˆä»»ä½•é¡µé¢ï¼Œè‡ªå·±å¸Œæœ›åœ¨ä¾§è¾¹æ æœ‰å“ªä¸ªèœå•é¡¹ï¼Œå»æ‰æ³¨é‡Šå³å¯ã€‚ç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆå¯¹åº”çš„é¡µé¢ï¼Œè¦ä¸ç‚¹å‡»èœå•é¡¹æ—¶ä¼šæŠ¥ 404ã€‚</p>
<p>ä»¥ <code>home</code> ä¸ºä¾‹ï¼Œå…ˆåˆ›å»ºé¡µé¢ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page <span class="string">&quot;home&quot;</span></span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨ç«™ç‚¹çš„ <code>source</code> ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª <code>home</code> ç›®å½•ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ª <code>index.md</code> æ–‡ä»¶ã€‚æ‰“å¼€ <code>index.md</code>ï¼Œåœ¨ <code>front matter</code> ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">type: &quot;about&quot;</span><br></pre></td></tr></table></figure>
<p>å…¶ä»–çš„é¡µé¢æ“ä½œç±»ä¼¼ã€‚</p>
<h4 id="å›åˆ°é¡¶éƒ¨"><a class="markdownIt-Anchor" href="#å›åˆ°é¡¶éƒ¨"></a> å›åˆ°é¡¶éƒ¨</h4>
<p>åœ¨é˜…è¯»è¿‡ç¨‹ä¸­å¯ä»¥ç‚¹å‡»å›åˆ°é¡¶éƒ¨æŒ‰é’®å¿«é€Ÿå›åˆ°é¡¶éƒ¨ã€‚</p>
<p>ä¿®æ”¹ <code>_config.next.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Back to top in sidebar.</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Scroll percent label in b2t button.</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h4 id="æœ¬åœ°æœç´¢"><a class="markdownIt-Anchor" href="#æœ¬åœ°æœç´¢"></a> æœ¬åœ°æœç´¢</h4>
<p>å®‰è£…æ’ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.next.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="åº•éƒ¨"><a class="markdownIt-Anchor" href="#åº•éƒ¨"></a> åº•éƒ¨</h3>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="comment"># Specify the year when the site was setup. If not defined, current year will be used.</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2021</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Icon between year and copyright info.</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">    <span class="comment"># Icon name in Font Awesome. See: https://fontawesome.com/icons</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">    <span class="comment"># If you want to animate the icon, set it to true.</span></span><br><span class="line">    <span class="attr">animated:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Change the color of icon, using Hex Code.</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;#808080&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># If not defined, `author` from Hexo `_config.yml` will be used.</span></span><br><span class="line">  <span class="attr">copyright:</span> <span class="string">Time_Wait</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Powered by Hexo &amp; NexT</span></span><br><span class="line">  <span class="attr">powered:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="æ–‡ç« "><a class="markdownIt-Anchor" href="#æ–‡ç« "></a> æ–‡ç« </h3>
<h4 id="é˜…è¯»è¿›åº¦æ¡"><a class="markdownIt-Anchor" href="#é˜…è¯»è¿›åº¦æ¡"></a> é˜…è¯»è¿›åº¦æ¡</h4>
<p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.next.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Reading progress bar</span></span><br><span class="line"><span class="attr">reading_progress:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Available values: left | right</span></span><br><span class="line">  <span class="attr">startAt:</span> <span class="string">left</span></span><br><span class="line">  <span class="comment"># Available values: top | bottom</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span></span><br><span class="line">  <span class="attr">reversed:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#37c6c0&quot;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">2px</span></span><br></pre></td></tr></table></figure>
<h4 id="æ–‡ç« -id"><a class="markdownIt-Anchor" href="#æ–‡ç« -id"></a> æ–‡ç«  ID</h4>
<p><code>Hexo</code> ç»™æ–‡ç« ç”Ÿæˆçš„é»˜è®¤çš„ <code>url</code> æ˜¯ <code>username.gitee.io/year/month/day/title.html</code>ï¼Œä¸ºäº†è®© <code>url</code> ç®€çŸ­ä¸€ç‚¹ï¼Œå¯ä»¥ç»™æ–‡ç« ä¸€ä¸ªå›ºå®š<code>ID</code>ã€‚</p>
<p>å®‰è£…æ’ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶ <code>_config.yml</code>ï¼Œæ‰¾åˆ°</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">url:</span> <span class="string">https://seventw.gitee.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">archives/:abbrlink.html</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line">  <span class="attr">alg:</span> <span class="string">crc32</span>  <span class="comment"># ç®—æ³•ï¼šcrc16(default) and crc32</span></span><br><span class="line">  <span class="attr">rep:</span> <span class="string">hex</span>    <span class="comment"># è¿›åˆ¶ï¼šdec(default) and hex</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æ–‡ç« çš„ <code>url</code> å°±å˜æˆ <code>username.gitee.io/archives/54ce2e51.html</code> è¿™æ ·çš„ã€‚</p>
<h4 id="æ–‡ç« å­—æ•°ç»Ÿè®¡"><a class="markdownIt-Anchor" href="#æ–‡ç« å­—æ•°ç»Ÿè®¡"></a> æ–‡ç« å­—æ•°ç»Ÿè®¡</h4>
<p>å®‰è£…æ’ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-word-counter</span><br><span class="line">$ hexo clean</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶ <code>_config.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Post Wordcount</span></span><br><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span>          <span class="comment"># the number of post words</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span>             <span class="comment"># the estimated reading time of post</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">false</span>   <span class="comment"># the number of all posts words</span></span><br><span class="line">  <span class="attr">total_times:</span> <span class="literal">false</span>     <span class="comment"># the estimated reading time of all posts</span></span><br><span class="line">  <span class="attr">awl:</span> <span class="number">4</span>                 <span class="comment"># the average Word Length (chars count in word)</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">275</span>               <span class="comment"># the average words per minute</span></span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.next.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span> 		<span class="comment"># æŠŠæ–‡ç« å­—æ•°å’Œé¢„ä¼°é˜…è¯»æ—¶é—´æ”¾åœ¨ä¸€è¡Œ</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">false</span>  <span class="comment"># æ§åˆ¶æ˜¯å¦åœ¨æ–‡ç« çš„åº•éƒ¨æ˜¾ç¤º</span></span><br></pre></td></tr></table></figure>
<h4 id="æ–‡ç« é¦–å­—ä¸‹æ²‰"><a class="markdownIt-Anchor" href="#æ–‡ç« é¦–å­—ä¸‹æ²‰"></a> æ–‡ç« é¦–å­—ä¸‹æ²‰</h4>
<p>åœ¨ <code>source/_data/styles.styl</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-body</span>&gt;<span class="selector-tag">p</span><span class="selector-pseudo">:first</span>-child<span class="selector-pseudo">::first-letter</span>&#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line"><span class="comment">/* height: 32px;*/</span></span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">42px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">28px</span>;</span><br><span class="line">  <span class="attribute">font-style</span>: normal;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">400</span>;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç›¸å…³æ–‡ç« æ¨è"><a class="markdownIt-Anchor" href="#ç›¸å…³æ–‡ç« æ¨è"></a> ç›¸å…³æ–‡ç« æ¨è</h4>
<p>å®‰è£…æ’ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-related-popular-posts</span><br><span class="line">$ hexo clean</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.next.yml</code>ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">related_posts:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h4 id="æ¸²æŸ“å™¨"><a class="markdownIt-Anchor" href="#æ¸²æŸ“å™¨"></a> æ¸²æŸ“å™¨</h4>
<p><code>Hexo</code> è‡ªå¸¦çš„ <code>markdown</code> æ¸²æŸ“å™¨ä¸èƒ½è§£ææ³¨è„šï¼Œå¯¹å…¶è¿›è¡Œæ›´æ¢ã€‚</p>
<p>å¸è½½è‡ªå¸¦çš„æ¸²æŸ“å™¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm uni hexo-renderer-marked --save</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½æ–°çš„æ¸²æŸ“å™¨ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i @upupming/hexo-renderer-markdown-it-plus --save</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶ <code>_config.yml</code>ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Render</span></span><br><span class="line"><span class="attr">markdown_it_plus:</span></span><br><span class="line">    <span class="attr">highlight:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">html:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">xhtmlOut:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">breaks:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">langPrefix:</span></span><br><span class="line">    <span class="attr">linkify:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">typographer:</span></span><br><span class="line">    <span class="attr">quotes:</span> <span class="string">â€œâ€â€˜â€™</span></span><br><span class="line">    <span class="attr">plugins:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-emoji</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-sub</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-sup</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-deflist</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-abbr</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-footnote</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-ins</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-mark</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">plugin:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">markdown-it-toc-and-anchor</span></span><br><span class="line">          <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">pre_class:</span> <span class="string">highlight</span></span><br></pre></td></tr></table></figure>
<h3 id="æ ‡ç­¾é¡µ"><a class="markdownIt-Anchor" href="#æ ‡ç­¾é¡µ"></a> æ ‡ç­¾é¡µ</h3>
<p>é»˜è®¤çš„æ ‡ç­¾é¡µæ ·å¼ä¸å¤ªå¥½çœ‹ï¼Œå¯ä»¥åœ¨åœ¨ <code>source/_data/sidebar.njk</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  <span class="selector-class">.tag-cloud-tags</span>&#123;</span><br><span class="line">    <span class="comment">/*font-family: Helvetica, Tahoma, Arial;*/</span></span><br><span class="line">    <span class="comment">/*font-weight: 100;*/</span></span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">counter-reset</span>: tags;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span>&#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">5px</span> <span class="number">0px</span> <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span>:before&#123;</span><br><span class="line">    content: <span class="string">&quot;ğŸ”–&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">     <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">5px</span> <span class="number">15px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">4</span>);</span><br><span class="line">     <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">     <span class="comment">/*box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);*/</span></span><br><span class="line">     <span class="attribute">transition-duration</span>: <span class="number">0.15s</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h3 id="å½’æ¡£é¡µ"><a class="markdownIt-Anchor" href="#å½’æ¡£é¡µ"></a> å½’æ¡£é¡µ</h3>
<p>ä¿®æ”¹ <code>next/layout/_macro/post-collapse.swig</code> åçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% macro render(post) %&#125;</span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">&quot;my-post post-type-&#123;&#123; post.type | default(&#x27;normal&#x27;) &#125;&#125;&quot;</span> <span class="attr">itemscope</span> <span class="attr">itemtype</span>=<span class="string">&quot;http://schema.org/Article&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">&quot;my-post-header&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;my-post-meta&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">time</span> <span class="attr">class</span>=<span class="string">&quot;my-post-time&quot;</span> <span class="attr">itemprop</span>=<span class="string">&quot;dateCreated&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">datetime</span>=<span class="string">&quot;&#123;&#123; moment(post.date).format() &#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">content</span>=<span class="string">&quot;&#123;&#123; date(post.date, config.date_format) &#125;&#125;&quot;</span> &gt;</span></span><br><span class="line">          &#123;&#123; date(post.date, &#x27;MM-DD&#x27;) &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">time</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      &lt;&#123;% if theme.seo %&#125;h3&#123;% else %&#125;h2&#123;% endif %&#125; class=&quot;my-post-title&quot;&gt;</span><br><span class="line">        &#123;% if post.link %&#125;&#123;# Link posts #&#125;</span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;my-post-title-link post-title-link-external&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(post.link) &#125;&#125;&quot;</span> <span class="attr">itemprop</span>=<span class="string">&quot;url&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; post.title or post.link &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-external-link&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;my-post-title-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot;</span> <span class="attr">itemprop</span>=<span class="string">&quot;url&quot;</span>&gt;</span></span><br><span class="line">              &#123;% if post.type === &#x27;picture&#x27; %&#125;</span><br><span class="line">                &#123;&#123; post.content &#125;&#125;</span><br><span class="line">              &#123;% else %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">itemprop</span>=<span class="string">&quot;name&quot;</span>&gt;</span>&#123;&#123; post.title | default(__(&#x27;post.untitled&#x27;)) &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              &#123;% endif %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">      &lt;/&#123;% if theme.seo %&#125;h3&#123;% else %&#125;h2&#123;% endif %&#125;&gt;</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% endmacro %&#125;</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ <code>source/_data/styles.styl</code>ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å½’æ¡£é¡µæ ·å¼ began */</span></span><br><span class="line"><span class="selector-class">.page-archive</span> <span class="selector-class">.archive-page-counter</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.my-post-time</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">11px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.mypost</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">  -webkit-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  -moz-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  -o-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  -ms-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-class">.my-post-title-link</span>:before&#123;</span><br><span class="line">  top: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;ğŸ“š&quot;</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">font</span>: normal normal normal <span class="number">14px</span>/<span class="number">1</span> FontAwesome;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.my-post</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">10px</span> <span class="number">10px</span> <span class="number">15px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">12</span>), <span class="number">0</span> <span class="number">0</span> <span class="number">6px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">104</span>, <span class="number">104</span>, <span class="number">105</span>, <span class="number">0.1</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1px</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">25px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">transition-duration</span>: <span class="number">0.15s</span>;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">260px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">18px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  //<span class="attribute">display</span>:flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-class">.my-post-title-link</span>&#123;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">400</span>;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.my-post-title</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">4.5rem</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#4c4948</span>;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  <span class="attribute">font-size</span>: .<span class="number">8rem</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    //<span class="attribute">margin-left</span>: <span class="number">4rem</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.my-post-header</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: top;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1rem</span>;</span><br><span class="line">  -webkit-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  -moz-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  -o-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  -ms-<span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">  <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line">//<span class="selector-class">.my-post-title-link</span>&#123;</span><br><span class="line">//  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">//  <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">//&#125;</span><br><span class="line"><span class="selector-class">.my-post-meta</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#99a9bf</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#114142</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.post-block</span><span class="selector-class">.tag</span> <span class="selector-class">.collection-title</span> <span class="selector-tag">h2</span> &#123;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#3f3f3f</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">22px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#b4e8fa</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">letter-spacing</span>: <span class="number">1.5px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#3f3f3f</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.category-list-link</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">10px</span> <span class="number">10px</span> <span class="number">15px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">12</span>), <span class="number">0</span> <span class="number">0</span> <span class="number">6px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">104</span>, <span class="number">104</span>, <span class="number">105</span>, <span class="number">0.1</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1px</span> <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">transition-duration</span>: <span class="number">0.15s</span>;</span><br><span class="line">  //<span class="attribute">display</span>:flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å½’æ¡£é¡µæ ·å¼ end */</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Hexo&amp;NexT</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>NexT</tag>
        <tag>åˆæ­¥ç¾åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>JVM</title>
    <url>/archives/66c016fb.html</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>JVM</category>
      </categories>
      <tags>
        <tag>Javaå†…å­˜æ¨¡å‹</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQL</title>
    <url>/archives/c24675b4.html</url>
    <content><![CDATA[<h4 id="ç´¢å¼•"><a class="markdownIt-Anchor" href="#ç´¢å¼•"></a> ç´¢å¼•</h4>
<p>ç´¢å¼•çš„ä½œç”¨æ˜¯æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>
<p>å®ç°ç´¢å¼•å¯ä»¥æœ‰å¤šç§æ–¹å¼ï¼Œå¸¸è§çš„æœ‰<strong>å“ˆå¸Œè¡¨</strong>ã€<strong>æœ‰åºæ•°ç»„</strong>å’Œ<strong>æœç´¢æ ‘</strong>ã€‚</p>
<ul>
<li>
<p>å“ˆå¸Œè¡¨</p>
<div class="note "><p>å“ˆå¸Œè¡¨æ˜¯ä¸€ç§å­˜å‚¨é”®å€¼å¯¹çš„æ•°æ®ç»“æ„ï¼Œæ ¹æ® <code>key</code> å¯ä»¥åœ¨ <code>O(1)</code> æ—¶é—´å†…æ‰¾åˆ°å¯¹åº”çš„ <code>value</code>ã€‚</p>
<p>å“ˆå¸Œè¡¨åœ¨<strong>ç­‰å€¼ï¼ˆå•ä¸ªï¼‰æŸ¥è¯¢</strong>åœºæ™¯è¡¨ç°å¾ˆå¥½ï¼Œä½†æ˜¯å› ä¸ºå“ˆå¸Œè¡¨ä¸æ˜¯æœ‰åºçš„ï¼Œå› æ­¤åœ¨åš<strong>åŒºé—´æŸ¥è¯¢</strong>æ—¶æ€§èƒ½å°±å¾ˆå·®ã€‚</p>
</div>
</li>
<li>
<p>æœ‰åºæ•°ç»„</p>
<div class="note "><p>æœ‰åºæ•°ç»„åœ¨ç­‰å€¼æŸ¥è¯¢å’ŒåŒºé—´æŸ¥è¯¢åœºæ™¯ä¸­çš„æ€§èƒ½éƒ½å¾ˆä¼˜ç§€ï¼Œä½†æ˜¯å¦‚æœæœ‰æ•°æ®æ’å…¥å’Œåˆ é™¤å°±æ¯”è¾ƒè€—æ—¶äº†ï¼Œå› ä¸ºå¯èƒ½éœ€è¦ç§»åŠ¨å¾ˆå¤šæ•°æ®ã€‚</p>
</div>
</li>
<li>
<p>æœç´¢æ ‘</p>
</li>
</ul>
<p>åœ¨ <code>MySQL</code> ä¸­ï¼Œç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚å®ç°çš„ï¼Œå› æ­¤ä¸åŒçš„å­˜å‚¨å¼•æ“å¯èƒ½æœ‰ä¸ä¸€æ ·çš„ç´¢å¼•å®ç°ã€‚</p>
<h5 id="è¦†ç›–ç´¢å¼•"><a class="markdownIt-Anchor" href="#è¦†ç›–ç´¢å¼•"></a> è¦†ç›–ç´¢å¼•</h5>
<p>å‡å¦‚æœ‰è¿™æ ·ä¸€æ¡æŸ¥è¯¢è¯­å¥ï¼š<code>select * from T where k between 3 and 5;</code> å¹¶ä¸”ä¸º <code>k</code> å»ºç«‹äº†ç´¢å¼•ã€‚</p>
<p>å› ä¸ºè¦æŸ¥å…¨å­—æ®µï¼Œæ‰€ä»¥åœ¨ <code>k</code> ç´¢å¼•æ ‘ä¸ŠæŸ¥å®Œï¼Œå¾—åˆ°ä¸»é”®å€¼åï¼Œè¦æ ¹æ®ä¸»é”®å€¼å›åˆ°ä¸»é”®ç´¢å¼•æ ‘ä¸Šå»æŸ¥å…¨å­—æ®µæ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå›è¡¨ã€‚</p>
<p>è€Œå¦‚æœæŸ¥è¯¢è¯­å¥æ˜¯ï¼š<code>select ID from T where k between 3 and 5;</code> <code>ID</code> æ˜¯ä¸»é”®ã€‚</p>
<p>æ­¤æ—¶ <code>k</code> ç´¢å¼•æ ‘å¯ä»¥ç›´æ¥æä¾›æŸ¥è¯¢ç»“æœï¼Œå°±ä¸éœ€è¦å›è¡¨äº†ã€‚åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œç´¢å¼• <code>k</code> å·²ç»è¦†ç›–äº†æŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºè¦†ç›–ç´¢å¼•ã€‚</p>
<p>è™½ç„¶ç»´æŠ¤ç´¢å¼•éœ€è¦é¢å¤–å¼€é”€ï¼Œä½†æ˜¯åŸºäºè¦†ç›–ç´¢å¼•çš„ç‰¹æ€§ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¸ºæŸ¥è¯¢é¢‘ç‡è¾ƒé«˜çš„å­—æ®µå»ºç«‹è”åˆç´¢å¼•ï¼Œä»¥æœŸè®©è¿™ä¸ªè”åˆç´¢å¼•è¦†ç›–æŸ¥è¯¢è¯·æ±‚ï¼Œå‡å°‘å›è¡¨çš„æ¬¡æ•°ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>
<h5 id="æœ€å·¦å‰ç¼€åŸåˆ™"><a class="markdownIt-Anchor" href="#æœ€å·¦å‰ç¼€åŸåˆ™"></a> æœ€å·¦å‰ç¼€åŸåˆ™</h5>
<p>å‡å¦‚æœ‰ä¸€ä¸ªç»„åˆç´¢å¼•ï¼ˆ<code>a, b</code>ï¼‰ï¼Œç´¢å¼•é¡¹ä¼šå…ˆæ ¹æ® <code>a</code> æ’åºï¼Œå†æ ¹æ® <code>b</code> æ’åºã€‚</p>
<p>è¿™æ—¶å¦‚æœåªæ ¹æ® <code>a</code> æ¥æŸ¥è¯¢æ•°æ®ï¼Œå¯ä»¥ç”¨ä¸Šè¿™ä¸ªç´¢å¼•ï¼›</p>
<p>å¦‚æœ <code>a</code> æ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ <code>name</code>ï¼Œé‚£ç±»ä¼¼ <code>select name like â€˜å¼ %â€™</code> è¿™æ ·çš„æŸ¥è¯¢ä¹Ÿå¯ä»¥ç”¨ä¸Š ï¼ˆ<code>name, b</code>ï¼‰è¿™ä¸ªç´¢å¼•ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æ»¡è¶³ç´¢å¼•çš„æœ€å·¦å‰ç¼€åŸåˆ™å°±å¯ä»¥ç”¨ä¸Šä¸€ä¸ªç»„åˆç´¢å¼•ã€‚è¿™ä¸ªæœ€å·¦å‰ç¼€å¯ä»¥æ˜¯ç»„åˆç´¢å¼•çš„å‰ <code>N</code> ä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²ç´¢å¼•çš„å‰ <code>N</code> ä¸ªå­—ç¬¦ã€‚</p>
<p><strong>ç»„åˆç´¢å¼•å¦‚ä½•å®‰æ’å­—æ®µé¡ºåº</strong></p>
<ul>
<li>
<p><strong>å¤ç”¨èƒ½åŠ›</strong> - å› ä¸ºæœ‰æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œæœ‰äº†ç»„åˆç´¢å¼•ï¼ˆ<code>a, b</code>ï¼‰ï¼Œå°±ä¸ç”¨ä¸º <code>a</code> å•ç‹¬å»ºç«‹ç´¢å¼•äº†ã€‚ä¹Ÿå°±è¯´ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘å¯ä»¥å‡å°‘ä¸€ä¸ªç´¢å¼•çš„å­—æ®µé¡ºåºã€‚</p>
</li>
<li>
<p><strong>ç©ºé—´</strong> - å¦‚æœæ—¢æœ‰è”åˆæŸ¥è¯¢ï¼Œåˆæœ‰åŸºäº <code>a</code> å’Œ <code>b</code> å„è‡ªçš„æŸ¥è¯¢ï¼ŒåŸºäº <code>b</code> çš„æŸ¥è¯¢æ˜¯æ— æ³•ä½¿ç”¨è”åˆç´¢å¼• ï¼ˆ<code>a, b</code>ï¼‰çš„ï¼Œä¸å¾—ä¸ä¸º <code>b</code> å¦å»ºä¸€ä¸ªç´¢å¼•ã€‚è¿™æ—¶å°±éœ€è¦è€ƒè™‘ç©ºé—´å› ç´ ï¼Œå¦‚æœå­—æ®µ <code>a</code> æ¯” <code>b</code> å¤§ï¼Œå°±åº”è¯¥è€ƒè™‘å»ºç«‹ç´¢å¼•</p>
<p>ï¼ˆ<code>a, b</code>ï¼‰å’Œ <code>b</code>ï¼Œå¦åˆ™ï¼Œå°±å»ºç«‹ç´¢å¼•ï¼ˆ<code>b, a</code>ï¼‰å’Œ <code>a</code>ã€‚</p>
</li>
</ul>
<h5 id="ç´¢å¼•ä¸‹æ¨"><a class="markdownIt-Anchor" href="#ç´¢å¼•ä¸‹æ¨"></a> ç´¢å¼•ä¸‹æ¨</h5>
<p>æœ‰ä¸€å¼  <code>user</code> è¡¨ï¼Œå»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create table user (</span><br><span class="line">ID int primary key,</span><br><span class="line">name char(20) not null,</span><br><span class="line">age int not null,</span><br><span class="line">ismale char(1) not null default 1,</span><br><span class="line">index k(name, age)</span><br><span class="line">) engine&#x3D;InnoDB;</span><br></pre></td></tr></table></figure>
<p>é™¤äº†ä¸»é”®ç´¢å¼•ï¼Œè¿˜æœ‰ä¸€ä¸ªç»„åˆç´¢å¼•ï¼ˆ<code>name, age</code>ï¼‰ã€‚</p>
<p>ç°æœ‰æŸ¥è¯¢è¯­å¥ï¼š<code>select * from user where name like â€˜å¼ %â€™ and age=10 and ismale=1;</code></p>
<p>åœ¨ <code>MySQL 5.6</code> ä¹‹å‰ï¼Œæ ¹æ®æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œåœ¨æ‰¾åˆ°ä»¥â€œå¼ â€å¼€å¤´çš„æ•°æ®åï¼Œéœ€è¦é€ä¸ªå›è¡¨ï¼Œåˆ°ä¸»é”®ç´¢å¼•æ ‘ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ•°æ®è¡Œï¼Œå†æ¯”è¾ƒåé¢å­—æ®µå€¼ã€‚</p>
<p>è€Œ <code>MySQL 5.6</code> å¼€å§‹ï¼Œå¼•å…¥äº†<strong>ç´¢å¼•ä¸‹æ¨</strong>ï¼Œæ‰¾åˆ°ä»¥â€œå¼ â€å¼€å¤´çš„æ•°æ®åï¼Œå¹¶ä¸æ˜¯ç›´æ¥å›è¡¨ï¼Œè€Œæ˜¯ä¼šå†æ ¹æ®ç»„åˆç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µå†åˆ¤æ–­ï¼Œè¿‡æ»¤æ‰ä¸ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œå‡å°‘å›è¡¨æ¬¡æ•°ã€‚</p>
<h5 id="ç´¢å¼•å¤±æ•ˆ"><a class="markdownIt-Anchor" href="#ç´¢å¼•å¤±æ•ˆ"></a> ç´¢å¼•å¤±æ•ˆ</h5>
<ul>
<li>åœ¨ç´¢å¼•åˆ—ä¸Šæœ‰è®¡ç®—ã€å‡½æ•°ã€ç±»å‹è½¬æ¢ï¼Œä¼šä½¿ç´¢å¼•å¤±æ•ˆè¿›è€Œæ‰«æå…¨è¡¨</li>
<li>ç»„åˆç´¢å¼•ä¸­å¯¹æŸåˆ—è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼Œä¼šä½¿è¯¥åˆ—å³è¾¹çš„åˆ—ä¸èƒ½ä½¿ç”¨</li>
<li>ä½¿ç”¨ä¸ç­‰äºï¼ˆ<code>!= or &lt;&gt;</code>ï¼‰ä¼šä½¿ç´¢å¼•å¤±æ•ˆ</li>
<li>ç»„åˆç´¢å¼•ä¸­å¯¹æŸåˆ—è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œä¼šä½¿è¯¥åˆ—å³è¾¹çš„åˆ—ä¸èƒ½ä½¿ç”¨</li>
</ul>
<h4 id="å­˜å‚¨å¼•æ“"><a class="markdownIt-Anchor" href="#å­˜å‚¨å¼•æ“"></a> å­˜å‚¨å¼•æ“</h4>
<h5 id="innodb"><a class="markdownIt-Anchor" href="#innodb"></a> <code>InnoDB</code></h5>
<p>åœ¨ <code>InnoDB</code> ä¸­ï¼Œè¡¨æ˜¯æ ¹æ®ä¸»é”®é¡ºåºä»¥ç´¢å¼•çš„å½¢å¼å­˜æ”¾çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„è¡¨ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨ã€‚</p>
<p>æ¯ä¸€ä¸ªç´¢å¼•åœ¨ <code>InnoDB</code> é‡Œé¢å¯¹åº”ä¸€æ£µ B+ æ ‘ã€‚</p>
<p>ç´¢å¼•ç±»å‹åŒ…æ‹¬ä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ï¼š</p>
<ul>
<li><strong>ä¸»é”®ç´¢å¼• - ä¹Ÿç§°èšç°‡ç´¢å¼•</strong>ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨å­˜å‚¨çš„æ˜¯æ•´è¡Œæ•°æ®ã€‚</li>
<li><strong>éä¸»é”®ç´¢å¼• - ä¹Ÿç§°æ™®é€šç´¢å¼•ã€äºŒçº§ç´¢å¼•</strong>ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®çš„å€¼ã€‚</li>
</ul>
<p>åŸºäºä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢é€šè¿‡æŸ¥è¯¢ä¸»é”®ç´¢å¼•æ ‘å¯ä»¥ç›´æ¥å¾—åˆ°æ•´è¡Œæ•°æ®ï¼›</p>
<p>è€ŒåŸºäºæ™®é€šç´¢å¼•ï¼Œå¾—å…ˆæŸ¥è¯¢æ™®é€šç´¢å¼•æ ‘ï¼Œå¾—åˆ°ä¸»é”®çš„å€¼ï¼Œç„¶åæ ¹æ®ä¸»é”®çš„å€¼å»æŸ¥è¯¢ä¸»é”®ç´¢å¼•æ ‘æ‰èƒ½å¾—åˆ°æƒ³è¦çš„æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç§°ä¸º<strong>å›è¡¨</strong>ã€‚</p>
<p>æ˜¾ç„¶ï¼ŒåŸºäºæ™®é€šç´¢å¼•çš„æŸ¥è¯¢æ¯”åŸºäºä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€é¢—ç´¢å¼•æ ‘ï¼Œå› æ­¤å»ºè®®å°½é‡é€šè¿‡ä¸»é”®æŸ¥è¯¢ã€‚</p>
<h4 id="åˆ‡åˆ†"><a class="markdownIt-Anchor" href="#åˆ‡åˆ†"></a> åˆ‡åˆ†</h4>
<h5 id="æ°´å¹³åˆ‡åˆ†"><a class="markdownIt-Anchor" href="#æ°´å¹³åˆ‡åˆ†"></a> æ°´å¹³åˆ‡åˆ†</h5>
<h5 id="å‚ç›´åˆ‡åˆ†"><a class="markdownIt-Anchor" href="#å‚ç›´åˆ‡åˆ†"></a> å‚ç›´åˆ‡åˆ†</h5>
<h4 id="å¤åˆ¶"><a class="markdownIt-Anchor" href="#å¤åˆ¶"></a> å¤åˆ¶</h4>
<h4 id="æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–"></a> æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–</h4>
<h4 id="æ•°æ®ç±»å‹"><a class="markdownIt-Anchor" href="#æ•°æ®ç±»å‹"></a> æ•°æ®ç±»å‹</h4>
]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLè¯­æ³•</title>
    <url>/archives/e272e39a.html</url>
    <content><![CDATA[<h4 id="æ³¨é‡Š"><a class="markdownIt-Anchor" href="#æ³¨é‡Š"></a> æ³¨é‡Š</h4>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ³¨é‡Š1</span><br><span class="line">SELECT *</span><br><span class="line">FROM mytable; -- æ³¨é‡Š2</span><br><span class="line">&#x2F;** </span><br><span class="line"> * æ³¨é‡Š3</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure>
<h4 id="æ•°æ®åº“"><a class="markdownIt-Anchor" href="#æ•°æ®åº“"></a> æ•°æ®åº“</h4>
<ul>
<li>åˆ›å»º</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create database db_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use db_name;</span><br></pre></td></tr></table></figure>
<h4 id="è¡¨"><a class="markdownIt-Anchor" href="#è¡¨"></a> è¡¨</h4>
<h5 id="åˆ›å»º"><a class="markdownIt-Anchor" href="#åˆ›å»º"></a> åˆ›å»º</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE table_name (</span><br><span class="line">  # int ç±»å‹ï¼Œä¸ä¸ºç©ºï¼Œè‡ªå¢</span><br><span class="line">  id INT NOT NULL AUTO_INCREMENT,</span><br><span class="line">  # int ç±»å‹ï¼Œä¸å¯ä¸ºç©ºï¼Œé»˜è®¤å€¼ä¸º 1ï¼Œä¸ä¸ºç©º</span><br><span class="line">  col1 INT NOT NULL DEFAULT 1,</span><br><span class="line">  # å˜é•¿å­—ç¬¦ä¸²ç±»å‹ï¼Œæœ€é•¿ä¸º 45 ä¸ªå­—ç¬¦ï¼Œå¯ä»¥ä¸ºç©º</span><br><span class="line">  col2 VARCHAR(45) NULL,</span><br><span class="line">  # æ—¥æœŸç±»å‹ï¼Œå¯ä¸ºç©º</span><br><span class="line">  col3 DATE NULL,</span><br><span class="line">  # è®¾ç½®ä¸»é”®ä¸º id</span><br><span class="line">  PRIMARY KEY (&#96;id&#96;)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="åˆ é™¤"><a class="markdownIt-Anchor" href="#åˆ é™¤"></a> åˆ é™¤</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">drop table table_name;</span><br></pre></td></tr></table></figure>
<h5 id="ä¿®æ”¹"><a class="markdownIt-Anchor" href="#ä¿®æ”¹"></a> ä¿®æ”¹</h5>
<ul>
<li>ä¿®æ”¹è¡¨å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alter table old_table_name rename new_table_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹åˆ—</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åªä¿®æ”¹åˆ—çš„æ•°æ®ç±»å‹</span><br><span class="line">alter table table_name modify column column_name æ•°æ®ç±»å‹;</span><br><span class="line"></span><br><span class="line"># åŒæ—¶ä¿®æ”¹åˆ—åå’Œæ•°æ®ç±»å‹</span><br><span class="line">alter table table_name change column old_column_name new_column_name æ•°æ®ç±»å‹;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ·»åŠ åˆ—</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alter table table_name add column_name æ•°æ®ç±»å‹;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤åˆ—</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alter table table_name drop column column_name;</span><br></pre></td></tr></table></figure>
<h4 id="æ•°æ®"><a class="markdownIt-Anchor" href="#æ•°æ®"></a> æ•°æ®</h4>
<h5 id="æ’å…¥"><a class="markdownIt-Anchor" href="#æ’å…¥"></a> æ’å…¥</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ™®é€šæ’å…¥</span><br><span class="line">insert into table_name(col1, col2) values(val1, val2);</span><br><span class="line"></span><br><span class="line"># æ’å…¥æ£€ç´¢å‡ºæ¥çš„æ•°æ®</span><br><span class="line">insert into table1(col1, col2)</span><br><span class="line">select col1, col2 from table2;</span><br><span class="line"></span><br><span class="line"># å°†ä¸€ä¸ªè¡¨çš„å†…å®¹æ’å…¥åˆ°ä¸€ä¸ªæ–°è¡¨</span><br><span class="line">create table new_table as</span><br><span class="line">select * from old_table;</span><br></pre></td></tr></table></figure>
<h5 id="æ›´æ–°"><a class="markdownIt-Anchor" href="#æ›´æ–°"></a> æ›´æ–°</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">update table_name set col &#x3D; val where id &#x3D; 1;</span><br></pre></td></tr></table></figure>
<h5 id="åˆ é™¤-2"><a class="markdownIt-Anchor" href="#åˆ é™¤-2"></a> åˆ é™¤</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">delete from table_name where id &#x3D; 1;</span><br><span class="line"></span><br><span class="line"># æ¸…ç©ºè¡¨</span><br><span class="line">truncate table table_name;</span><br></pre></td></tr></table></figure>
<h4 id="æŸ¥è¯¢"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢"></a> æŸ¥è¯¢</h4>
<ul>
<li>
<p><code>distinct</code></p>
<p>åŒæ—¶ä½œç”¨äº <code>col1</code> å’Œ <code>col2</code></p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select distinct col1, col2</span><br><span class="line">from table_name;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>limit</code></li>
</ul>
<p>é™åˆ¶è¿”å›çš„è¡Œæ•°ã€‚å¯ä»¥æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºèµ·å§‹è¡Œï¼Œä» 0 å¼€å§‹ï¼›ç¬¬äºŒä¸ªå‚æ•°ä¸ºè¿”å›çš„æ€»è¡Œæ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># è¿”å›å‰ 5 è¡Œ</span><br><span class="line">select * </span><br><span class="line">from table_name</span><br><span class="line">limit 5;</span><br><span class="line"></span><br><span class="line"># è¿”å›å‰ 5 è¡Œ</span><br><span class="line">select *</span><br><span class="line">from table_name</span><br><span class="line">limit 0, 5;</span><br></pre></td></tr></table></figure>
<h5 id="where"><a class="markdownIt-Anchor" href="#where"></a> <code>where</code></h5>
<p>ç”¨ <code>where</code> å­å¥è¿›è¡Œæ•°æ®è¿‡æ»¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select *</span><br><span class="line">from table_name</span><br><span class="line">where id &#x3D; 5;</span><br></pre></td></tr></table></figure>
<p><code>where</code> å­å¥å¯ç”¨çš„æ“ä½œç¬¦ï¼š</p>
<ul>
<li><code>=</code> - ç­‰äº</li>
<li><code>&lt;</code> - å°äº</li>
<li><code>&gt;</code> - å¤§äº</li>
<li><code>&lt;&gt; or !=</code> - ä¸ç­‰äº</li>
<li><code>&lt;= or !&gt;</code> - å°äºç­‰äº</li>
<li><code>&gt;= or !&lt;</code> - å¤§äºç­‰äº</li>
<li><code>between</code></li>
<li><code>is null</code></li>
</ul>
<p><code>where</code> å­å¥ä¸­è¿˜å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä½†æ˜¯åªèƒ½ç”¨åœ¨æ–‡æœ¬åˆ—ä¸Šï¼š</p>
<ul>
<li><code>%</code> - åŒ¹é… 0 ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦</li>
<li><code>_</code> - åŒ¹é… 1 ä¸ªä»»æ„å­—ç¬¦</li>
<li><code>[]</code> - åŒ¹é…é›†åˆå†…çš„å­—ç¬¦ï¼Œå¦‚ <code>[ab]</code> è¡¨ç¤ºå¯ä»¥åŒ¹é… <code>a</code> æˆ– <code>b</code>ã€‚å¦‚æœåŠ ä¸Š <code>^</code> è¡¨ç¤ºå¦å®šï¼Œä¸åŒ¹é…é›†åˆå†…ä»»ä½•å­—ç¬¦ï¼Œå¦‚ <code>[^ab]</code> è¡¨ç¤ºå­—ç¬¦ä¸èƒ½æ—¶ <code>a</code> å’Œ <code>b</code>ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æŸ¥æ‰¾ name ä¸ä»¥ a å’Œ b å¼€å¤´çš„è®°å½•</span><br><span class="line">select * </span><br><span class="line">from table_name</span><br><span class="line">where name like &#39;[^ab]%&#39;</span><br></pre></td></tr></table></figure>
<h5 id="group-by"><a class="markdownIt-Anchor" href="#group-by"></a> <code>group by</code></h5>
<p>åˆ†ç»„è§„å®šï¼š</p>
<ul>
<li><code>group by</code> å­å¥å‡ºç°åœ¨ <code>where</code> å­å¥ä¹‹åï¼Œ<code>order by</code> å­å¥ä¹‹å‰ï¼›</li>
<li>é™¤äº†æ±‡æ€»å­—æ®µå¤–ï¼Œ<code>select</code> è¯­å¥ä¸­çš„æ¯ä¸€å­—æ®µéƒ½å¿…é¡»åœ¨ <code>group by</code> å­å¥ä¸­ç»™å‡ºï¼›</li>
<li><code>null</code> çš„è¡Œä¼šå•ç‹¬åˆ†ä¸ºä¸€ç»„ï¼›</li>
<li>å¤§å¤šæ•° <code>SQL</code> å®ç°ä¸æ”¯æŒ <code>group by</code> åˆ—å…·æœ‰å¯å˜é•¿åº¦çš„æ•°æ®ç±»å‹ã€‚</li>
</ul>
<h5 id="having"><a class="markdownIt-Anchor" href="#having"></a> <code>having</code></h5>
<p><strong><code>where</code> è¿‡æ»¤è¡Œï¼Œ<code>having</code> è¿‡æ»¤åˆ†ç»„ï¼Œè¡Œè¿‡æ»¤å…ˆäºåˆ†ç»„è¿‡æ»¤ã€‚</strong></p>
<h5 id="order-by"><a class="markdownIt-Anchor" href="#order-by"></a> <code>order by</code></h5>
<p>é»˜è®¤ä¸ºå‡åºï¼ˆ<code>asc</code>ï¼‰ï¼Œå¯ä»¥æŒ‡å®šä¸ºé™åºï¼ˆ<code>desc</code>ï¼‰ã€‚å¹¶ä¸”å¯ä»¥æŒ‰å¤šä¸ªåˆ—è¿›è¡Œæ’åºï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªåˆ—æŒ‡å®šä¸åŒçš„æ’åºæ–¹å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select *</span><br><span class="line">from table_name</span><br><span class="line">order by col1 asc, col2 desc;</span><br></pre></td></tr></table></figure>
<h5 id="concat"><a class="markdownIt-Anchor" href="#concat"></a> <code>concat</code></h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select concat(trim(col1), &#39;-&#39;, trim(col2)) as concat_col</span><br><span class="line">from table_name;</span><br></pre></td></tr></table></figure>
<h5 id="å­æŸ¥è¯¢"><a class="markdownIt-Anchor" href="#å­æŸ¥è¯¢"></a> å­æŸ¥è¯¢</h5>
<p>å¯ä»¥å°†å­æŸ¥è¯¢çš„ç»“æœä½œä¸º <code>where</code> è¯­å¥çš„è¿‡æ»¤æ¡ä»¶ï¼Œå­æŸ¥è¯¢ä¸­åªèƒ½è¿”å›ä¸€ä¸ªå­—æ®µçš„æ•°æ®ã€‚</p>
<h5 id="è”åˆæŸ¥è¯¢"><a class="markdownIt-Anchor" href="#è”åˆæŸ¥è¯¢"></a> è”åˆæŸ¥è¯¢</h5>
<p>å½“æƒ³è¦çš„æ•°æ®åœ¨å¤šä¸ªä¸åŒçš„è¡¨ä¸­ï¼Œéœ€è¦ä½¿ç”¨è”åˆæŸ¥è¯¢ï¼Œæ­¤æ—¶éœ€è¦è¿æ¥å¤šä¸ªè¡¨ã€‚</p>
<p><code>join</code> å…³é”®å­—ç”¨æ¥è¿æ¥å¤šä¸ªè¡¨ï¼Œæ¡ä»¶è¯­å¥ä½¿ç”¨ <code>on</code> è€Œä¸æ˜¯ <code>where</code>ã€‚</p>
<p>è¿æ¥å¯ä»¥æ›¿æ¢å­æŸ¥è¯¢ï¼Œå¹¶ä¸”æ•ˆç‡ä¸€èˆ¬æ¯”å­æŸ¥è¯¢æ›´å¿«ã€‚</p>
<ul>
<li><strong>è‡ªç„¶è¿æ¥ - <code>natural join</code></strong></li>
</ul>
<p><strong>è‡ªç„¶è¿æ¥æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç­‰å€¼è¿æ¥</strong>ï¼Œè¦æ±‚è¿›è¡Œè¿æ¥çš„ä¸¤ä¸ªå…³ç³»è¡¨ä¸­å¿…é¡»æœ‰ç›¸åŒçš„å±æ€§åˆ—ï¼ˆåå­—ç›¸åŒï¼‰ï¼Œæ— é¡»æ·»åŠ è¿æ¥æ¡ä»¶ï¼Œ<strong>å¹¶ä¸”åœ¨ç»“æœä¸­æ¶ˆé™¤é‡å¤çš„å±æ€§åˆ—ã€‚</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select * from table1 natural join table2;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>å†…è¿æ¥ - <code>inner join</code></strong></li>
</ul>
<p>å†…è¿æ¥åŸºæœ¬ä¸è‡ªç„¶è¿æ¥ç›¸åŒï¼Œä¸åŒä¹‹å¤„åœ¨äºè‡ªç„¶è¿æ¥æ˜¯åŒåå±æ€§åˆ—çš„è¿æ¥ï¼Œè€Œå†…è¿æ¥åˆ™ä¸è¦æ±‚ä¸¤å±æ€§åˆ—åŒåï¼Œå¯ä»¥ç”¨ <code>using</code> æˆ– <code>on</code> æ¥æŒ‡å®šè¿æ¥æ¡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select A.col1, B.vcol1</span><br><span class="line">from tablea as A inner join tableb as B</span><br><span class="line">on A.col &#x3D; B.col;</span><br><span class="line"></span><br><span class="line"># ç­‰ä»·</span><br><span class="line">select A.col1, B.vcol1</span><br><span class="line">from tablea as A, tableb as B</span><br><span class="line">where A.col &#x3D; B.col;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>è‡ªè¿æ¥</strong></li>
</ul>
<p>è‡ªè¿æ¥æ˜¯å†…è¿æ¥çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œè¿æ¥è‡ªèº«ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å­æŸ¥è¯¢ç‰ˆæœ¬</span><br><span class="line">select name</span><br><span class="line">from employee</span><br><span class="line">where department &#x3D; (</span><br><span class="line">      select department</span><br><span class="line">      from employee</span><br><span class="line">      where name &#x3D; &quot;Jim&quot;);</span><br><span class="line">      </span><br><span class="line"># è‡ªè¿æ¥ç‰ˆæœ¬</span><br><span class="line">select e1.name</span><br><span class="line">from employee as e1 inner join employee as e2</span><br><span class="line">on e1.department &#x3D; e2.department</span><br><span class="line">      and e2.name &#x3D; &quot;Jim&quot;;</span><br></pre></td></tr></table></figure>
<ul>
<li>å·¦å¤–è¿æ¥ - <code>left (outer) join</code></li>
</ul>
<p>å·¦å¤–è¿æ¥æ˜¯åœ¨ä¸¤è¡¨è¿›è¡Œè‡ªç„¶è¿æ¥ï¼Œä¿ç•™å·¦è¡¨æ‰€æœ‰è¡Œï¼Œå³è¡¨ç›¸åº”å­—æ®µå¡«å…… <code>null</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select * from table1 left join table2 on table1.col&#x3D;table2.col</span><br></pre></td></tr></table></figure>
<ul>
<li>å³å¤–è¿æ¥ - <code>left (outer) join</code></li>
</ul>
<p>å³å¤–è¿æ¥æ˜¯åœ¨ä¸¤è¡¨è¿›è¡Œè‡ªç„¶è¿æ¥ï¼Œä¿ç•™å³è¡¨æ‰€æœ‰è¡Œï¼Œå·¦è¡¨ç›¸åº”å­—æ®µå¡«å…… <code>null</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select * from table1 right join table2 on table1.col&#x3D;table2.col</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>å…¨å¤–è¿æ¥ - <code>left (outer) join</code></p>
<p><code>MySQL</code> ä¸æ”¯æŒå…¨å¤–è¿æ¥ã€‚</p>
</li>
</ul>
<h5 id="ç»„åˆæŸ¥è¯¢"><a class="markdownIt-Anchor" href="#ç»„åˆæŸ¥è¯¢"></a> ç»„åˆæŸ¥è¯¢</h5>
<p>ä½¿ç”¨ <code>union</code> æ¥ç»„åˆä¸¤ä¸ªæŸ¥è¯¢ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæŸ¥è¯¢è¿”å› <code>M</code> è¡Œï¼Œç¬¬äºŒä¸ªæŸ¥è¯¢è¿”å› <code>N</code> è¡Œï¼Œé‚£ä¹ˆç»„åˆæŸ¥è¯¢çš„ç»“æœä¸€èˆ¬ä¸º <code>M+N</code> è¡Œã€‚</p>
<p><strong>æ¯ä¸ªæŸ¥è¯¢å¿…é¡»åŒ…å«ç›¸åŒçš„åˆ—ã€è¡¨è¾¾å¼å’Œèšé›†å‡½æ•°ã€‚</strong></p>
<p>åªèƒ½åŒ…å«ä¸€ä¸ª <code>order by</code> å­å¥ï¼Œå¹¶ä¸”å¿…é¡»ä½äºè¯­å¥çš„æœ€åã€‚</p>
<h4 id="å‡½æ•°"><a class="markdownIt-Anchor" href="#å‡½æ•°"></a> å‡½æ•°</h4>
<p>æ•°å€¼è®¡ç®—</p>
<ul>
<li>
<p><code>count()</code> - è¿”å›æŸåˆ—çš„è¡Œæ•°</p>
</li>
<li>
<p><code>avg()</code> - è¿”å›æŸåˆ—çš„å¹³å‡å€¼</p>
</li>
<li>
<p><code>sum()</code> - è¿”å›æŸåˆ—å€¼ä¹‹å’Œ</p>
</li>
<li>
<p><code>max()</code> - è¿”å›æŸåˆ—æœ€å¤§å€¼</p>
</li>
<li>
<p><code>min()</code> - è¿”å›æŸåˆ—æœ€å°å€¼</p>
</li>
</ul>
<p>æ–‡æœ¬å¤„ç†</p>
<ul>
<li><code>left()</code></li>
<li><code>right()</code></li>
<li><code>ltrim()</code> - å»æ‰å­—ç¬¦ä¸²å·¦è¾¹ç©ºæ ¼</li>
<li><code>rtrim()</code> - å»æ‰å­—ç¬¦ä¸²å³è¾¹ç©ºæ ¼</li>
<li><code>lower()</code> - å°†å­—ç¬¦ä¸²è½¬ä¸ºå°å†™å­—æ¯</li>
<li><code>upper()</code> - å°†å­—ç¬¦ä¸²è½¬ä¸ºå¤§å†™å­—æ¯</li>
<li><code>length()</code> - å­—ç¬¦ä¸²é•¿åº¦</li>
</ul>
<p>æ—¥æœŸå’Œæ—¶é—´</p>
<p>æ—¥æœŸæ ¼å¼ï¼š<code>YYYY-MM-DD</code></p>
<p>æ—¶é—´æ ¼å¼ï¼š<code>HH:&lt;zero-width space&gt;MM:SS</code></p>
<ul>
<li>
<p><code>date_format()</code> - è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„æ—¥æœŸæˆ–æ—¶é—´ä¸²</p>
</li>
<li>
<p><code>now()</code> - è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´</p>
</li>
<li>
<p><code>date()</code> - è¿”å›æ—¥æœŸæ—¶é—´çš„æ—¥æœŸéƒ¨åˆ†</p>
</li>
<li>
<p><code>time()</code> - è¿”å›æ—¥æœŸæ—¶é—´çš„æ—¶é—´éƒ¨åˆ†</p>
</li>
<li>
<p><code>year()</code> - è¿”å›æ—¥æœŸçš„å¹´</p>
</li>
<li>
<p><code>month()</code> - è¿”å›æ—¥æœŸçš„æœˆ</p>
</li>
<li>
<p><code>day()</code> - è¿”å›æ—¥æœŸçš„å¤©</p>
</li>
<li>
<p><code>hour()</code> - è¿”å›æ—¶é—´çš„å°æ—¶</p>
</li>
<li>
<p><code>minute()</code> - è¿”å›æ—¶é—´çš„åˆ†é’Ÿ</p>
</li>
<li>
<p><code>second</code> - è¿”å›æ—¶é—´çš„ç§’</p>
</li>
</ul>
<h4 id="è§†å›¾"><a class="markdownIt-Anchor" href="#è§†å›¾"></a> è§†å›¾</h4>
<h4 id="å­˜å‚¨è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#å­˜å‚¨è¿‡ç¨‹"></a> å­˜å‚¨è¿‡ç¨‹</h4>
<h4 id="äº‹åŠ¡ç®¡ç†"><a class="markdownIt-Anchor" href="#äº‹åŠ¡ç®¡ç†"></a> äº‹åŠ¡ç®¡ç†</h4>
<h4 id="æƒé™ç®¡ç†"><a class="markdownIt-Anchor" href="#æƒé™ç®¡ç†"></a> æƒé™ç®¡ç†</h4>
<ul>
<li>æŸ¥è¯¢è´¦æˆ·ä¿¡æ¯</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">select user from user;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ›å»ºè´¦æˆ·</li>
</ul>
<p>æ–°åˆ›å»ºçš„è´¦æˆ·æ²¡æœ‰ä»»ä½•æƒé™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create user user_name identified by &#39;password&#39;;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹è´¦æˆ·å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rename user user_name to new_user_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤è´¦æˆ·</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">drop user user_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹æƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">show grants for user_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>æˆäºˆæƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">grant select, insert on database.table to user_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤æƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">revoke select, insert on database.table to user_name;</span><br></pre></td></tr></table></figure>
<p><code>grant</code> å’Œ <code>revoke</code> å¯åœ¨å‡ ä¸ªå±‚æ¬¡ä¸Šæ§åˆ¶è®¿é—®æƒé™ï¼š</p>
<ul>
<li>æ•´ä¸ªæœåŠ¡å™¨ - ä½¿ç”¨ <code>grant all</code> å’Œ <code>revoke all</code></li>
<li>æ•´ä¸ªæ•°æ®åº“ - ä½¿ç”¨ <code>on database.*</code></li>
<li>ç‰¹å®šçš„è¡¨ - ä½¿ç”¨ <code>on database.table</code></li>
<li>ç‰¹å®šçš„åˆ—</li>
<li>ç‰¹å®šçš„å­˜å‚¨è¿‡ç¨‹</li>
</ul>
]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
        <category>SQLè¯­æ³•</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
        <tag>SQLè¯­æ³•</tag>
        <tag>è¡¨æ“ä½œ</tag>
        <tag>è¡¨æ•°æ®æ“ä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring</title>
    <url>/archives/6c92115f.html</url>
    <content><![CDATA[<h3 id="spring-ç®€ä»‹"><a class="markdownIt-Anchor" href="#spring-ç®€ä»‹"></a> Spring ç®€ä»‹</h3>
<span id="more"></span>
<h3 id="ioc"><a class="markdownIt-Anchor" href="#ioc"></a> <code>IoC</code></h3>
<p><strong>IoC</strong> is also known as dependency injection (<strong>DI</strong>).</p>
<p>It is a process whereby objects define their dependencies (that is, the other objects they work with) only through <strong>constructor arguments</strong>, <strong>arguments to a factory method</strong>, or <strong>properties that are set on the object instance</strong> after it is constructed or returned from a factory method.</p>
<p><strong>The container then injects those dependencies when it creates the bean.</strong></p>
<p>In Spring, the objects that form the backbone of your application and that are managed by the Spring IoC container are called beans. <strong>A bean is an object that is instantiated, assembled, and managed by a Spring IoC container</strong>. Beans, and the dependencies among them, are reflected in the configuration metadata used by a container.</p>
<h3 id="aop"><a class="markdownIt-Anchor" href="#aop"></a> <code>AOP</code></h3>
<h3 id="äº‹ç‰©"><a class="markdownIt-Anchor" href="#äº‹ç‰©"></a> äº‹ç‰©</h3>
]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring</tag>
        <tag>IoC</tag>
        <tag>AOP</tag>
        <tag>äº‹ç‰©</tag>
      </tags>
  </entry>
  <entry>
    <title>Red tourism in Xiâ€™s China</title>
    <url>/archives/62818838.html</url>
    <content><![CDATA[<p>In its <mark class="label primary">heyday</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> in the 1960s and 1970s, the village of Dazhai was called a place of miracles. Millions of revolutionary <mark class="label primary">pilgrims</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> came to hear how local <mark class="label primary">peasants</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> had carved terraced grain-fields and reservoirs from its rocky hillsides, armed with little more than hand tools and love of Chairman Mao Zedong. Dazhaiâ€™s barely literate Communist Party secretary, Chen Yonggui, was <mark class="label primary">summoned</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> to Beijing and elevated to the Politburo with the rank of vice prime minister. Back then Liang Jiwen was a schoolboy, the son of a Dazhai official. He recalls <mark class="label primary">dignitaries</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> arriving each day in his corner of Shanxi province, in the dustdry Taihang mountains. He and classmates would wave flowers and sing red <mark class="label primary">hymns</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> at the roadside. â€œWe did not get much studying done,â€ he recalls.</p>
<span id="more"></span>
<p>Then came the fall. In 1980, as part of a broader purge of ultra-leftists that followed Maoâ€™s death in 1976, official Communist Party newspapers called Dazhai a <mark class="label primary">fraud</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>. Investigators charged that its miraculous grain harvests were invented. They described massive cash <mark class="label primary">subsidies</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> channelled to the supposedly self-<mark class="label primary">reliant</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> village, and thousands of soldiers sent to build its engineering marvels.</p>
<div class="note info"><p><strong>self-reliant</strong>ï¼šè‡ªç«‹çš„ï¼›è‡ªåŠ›æ›´ç”Ÿçš„ï¼›è‡ªä¸»çš„</p>
</div>
<p>Now Dazhai is trying for a third act. Local officials have drawn up plans to include their village in a China-wide official campaign to promote â€œred tourismâ€ and teach party history to the masses. They are pinning particular hopes on their former â€œpeopleâ€™s <mark class="label primary">commune</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>â€, a well-preserved complex of cave <mark class="label primary">dwellings</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> built in 1966. An <mark class="label primary">evocative</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> place, its entrance gate still decorated with Maoist slogans, it was admitted to a national register of protected sites in 2013. It is still closed to the public, but plans are <mark class="label primary">afoot</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> to buy out current residents. Among them is Jia Cunlian, a widow who has lived in a cave-home there for 30 years. She remembers Chen, the Mao-era boss, as â€œthe best of peopleâ€, who shared <mark class="label primary">exotic</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup> gifts that he had received with villagers, such as melons or raisins. Still, she prefers the present day, saying: â€œLife was hard back then.â€</p>
<p>Since the 1990s, most visitors to Dazhai for tourism have been elderly. The village has tried to <mark class="label primary">woo</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> them with <mark class="label primary">nostalgia</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup>: family-owned restaurants serving <mark class="label primary">rural</mark><sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup> dishes, including tree-bark noodles once eaten during times of <mark class="label primary">famine</mark><sup class="footnote-ref"><a href="#fn18" id="fnref18">[18]</a></sup>. But local leaders have grander ambitions now, involving what would amount to Dazhaiâ€™s political <mark class="label primary">rehabilitation</mark><sup class="footnote-ref"><a href="#fn19" id="fnref19">[19]</a></sup>. To achieve that, officials are willing to offer doses of <mark class="label primary">candour</mark><sup class="footnote-ref"><a href="#fn20" id="fnref20">[20]</a></sup>. Shi Yonghong, who heads the cultural <mark class="label primary">relics</mark><sup class="footnote-ref"><a href="#fn21" id="fnref21">[21]</a></sup> bureau of the surrounding county, Xiyang, admits that Maoâ€™s call to â€œLearn from Dazhaiâ€ led to excesses by the mid-1970s, such as when communes in other parts of China dug terraced fields out of flat plains in their anxiety to obey the chairman. Mr Shi blames officials in these places for misinterpreting the policy, adding that Dazhai never asked to be a national model. But even that <mark class="label primary">grudging</mark><sup class="footnote-ref"><a href="#fn22" id="fnref22">[22]</a></sup>  admission of long-ago problems is offset by his claims that Dazhai not only fed itself during the hungriest years of the 1960s, but â€œsold surplus harvests to the stateâ€. He offers no further details to back up that long <mark class="label primary">debunked</mark><sup class="footnote-ref"><a href="#fn23" id="fnref23">[23]</a></sup> assertion. Instead, he talks vaguely but grandly about the â€œDazhai spiritâ€, which he defines as hard work and not asking for government <mark class="label primary">handouts</mark><sup class="footnote-ref"><a href="#fn24" id="fnref24">[24]</a></sup>.</p>
<p>In an office thick with cigarette smoke, overlooking a snow-covered village square, Dazhaiâ€™s <mark class="label primary">deputy</mark><sup class="footnote-ref"><a href="#fn25" id="fnref25">[25]</a></sup> party secretary, Li Huailian, chimes in. She describes the villageâ€™s story of hardships as a way to understand what President Xi Jinping means when he tells gatherings that the good times of today did not fall from the sky. Dazhai is prosperous because its people have always been diligent and followed party orders, she declares. â€œWhere the party tells us to go, we go.â€ At first hearing, that is a rather <mark class="label primary">insipid</mark><sup class="footnote-ref"><a href="#fn26" id="fnref26">[26]</a></sup> summary of her villageâ€™s <mark class="label primary">tumultuous</mark><sup class="footnote-ref"><a href="#fn27" id="fnref27">[27]</a></sup> past. But these local officials know what they are doing. They want Dazhai to be a celebrated red-tourism site, promoted alongside revolutionary bases on the route of the Long March. To achieve that, they need to <mark class="label primary">grasp</mark><sup class="footnote-ref"><a href="#fn28" id="fnref28">[28]</a></sup> the role that history plays in the Xi era. To Mr Xi and his team, the past exists to provide reasons to admire the party, not to furnish evidence for judgments about its rule.</p>
<div class="note info"><p><strong>chime in</strong>ï¼šèµæˆï¼Œé™„å’Œï¼Œæ’å˜´è¯´é“</p>
</div>
<p><strong>Not just popes who like to claim <mark class="label primary">infallibility</mark></strong><sup class="footnote-ref"><a href="#fn29" id="fnref29">[29]</a></sup></p>
<p>Real history is dangerous stuff. Past <mark class="label primary">adulation</mark><sup class="footnote-ref"><a href="#fn30" id="fnref30">[30]</a></sup> of Dazhai and of its boss, Chenâ€”a <mark class="label primary">zealot</mark><sup class="footnote-ref"><a href="#fn31" id="fnref31">[31]</a></sup> who ordered 141 political executions and said that revolutionaries could grow grain on sandy beachesâ€”is a reminder that to Mao, party rule was a faith-based project. It often put <mark class="label primary">ideology</mark><sup class="footnote-ref"><a href="#fn32" id="fnref32">[32]</a></sup> above expertise and common sense, with horrific results. Dazhaiâ€™s <mark class="label primary">denunciation</mark><sup class="footnote-ref"><a href="#fn33" id="fnref33">[33]</a></sup> in 1980 reflected moves by Chinaâ€™s then-<mark class="label primary">paramount</mark><sup class="footnote-ref"><a href="#fn34" id="fnref34">[34]</a></sup> leader, Deng Xiaoping, to create a rational, technocratic state. Dengâ€™s gamble was that the party did not need personality <mark class="label primary">cults</mark><sup class="footnote-ref"><a href="#fn35" id="fnref35">[35]</a></sup> to maintain support. Instead, he sought a <mark class="label primary">mandate</mark><sup class="footnote-ref"><a href="#fn36" id="fnref36">[36]</a></sup> based on making China strong and prosperous. To make a case for market-based reforms that he believed vital to that project, he was <mark class="label primary">pragmatically</mark><sup class="footnote-ref"><a href="#fn37" id="fnref37">[37]</a></sup> willing to allow Maoist mistakes to be named.</p>
<p>Mr Xi favours a synthesis of these two approaches. As the party approaches its 100th anniversary in July, its leaders urge the public to contrast Chinaâ€™s economic rise and social stability with economic decline and political chaos in the West. That is a Deng-style appeal to performance <mark class="label primary">legitimacy</mark><sup class="footnote-ref"><a href="#fn38" id="fnref38">[38]</a></sup>. Yet that co-exists with boosterish talk of â€œthe brilliant achievements and valuable experience accumulated by our party â€. Maoist disasters are not mentioned. In the Xi era, when Chinese scholars dwell on past mistakes they are guilty of â€œhistorical <mark class="label primary">nihilism</mark><sup class="footnote-ref"><a href="#fn39" id="fnref39">[39]</a></sup>â€, a career-ending <mark class="label primary">offence</mark><sup class="footnote-ref"><a href="#fn40" id="fnref40">[40]</a></sup>. When foreigners remember old horrors, the charge is that they seek to <mark class="label primary">overthrow</mark><sup class="footnote-ref"><a href="#fn41" id="fnref41">[41]</a></sup> Communist rule. Last month Mr Xi gathered senior leaders to stress the importance of studying party history correctly, to pass â€œred genes and revolutionary fireâ€ to later generations.</p>
<p>Mr Xi seeks a mandate that is both pragmatic and faith-based. The common thread is absolute loyalty. By the logic of the Xi era, the Chinese are able to benefit from wise party rule today because they always trusted the party, even when it erred. Objectively, Dazhai does not deserve to be a place of pilgrimage again. Still it may happen. In China, the past is what the party needs it to be.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [ËˆheÉªdeÉª] å…¨ç››æ—¶æœŸ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [â€˜pÉªlÉ¡rÉªm] æœåœ£ <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [Ëˆpez(É™)nt] å†œæ°‘ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [â€˜sÊŒmÉ™n] å¬å”¤ï¼Œä¼ å”¤ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [â€˜dÉªÉ¡nÉª.teri] æƒè´µï¼Œæ˜¾è¦äººç‰© <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [hÉªm] 1. é¢‚æ­Œï¼Œï¼ˆå®—æ•™ï¼‰èµç¾è¯—ï¼›2. ä¸ºâ€¦å”±èµæ­Œ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [frÉ”d] éª—å­ï¼›æ¬ºè¯ˆç½ª <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [â€˜sÊŒbsÉ™di] è¡¥è´´ï¼Œæ´¥è´´ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [riËˆlaÉªÉ™rnt] ä¿¡èµ–çš„ï¼›ä¾èµ–çš„ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ [â€˜kÉ‘.mjun] å…¬ç¤¾ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [â€˜dwelÉªÅ‹] ä½å®…ï¼Œä½æ‰€ï¼Œå…¬å¯“ <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [Éªâ€™vÉ‘kÉ™tÉªv] å¼•èµ·è®°å¿†çš„ï¼Œå”¤èµ·æ„Ÿæƒ…çš„ <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [É™â€™fÊŠt] è®¡åˆ’ä¸­ <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [ÉªÉ¡â€™zÉ‘tÉªk] 1. èˆ¶æ¥å“ï¼›2. å¤–æ¥çš„ï¼Œæ¥è‡ªå¼‚å›½çš„ï¼›3. å¼‚å›½é£æƒ…çš„ <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [wu] 1. äº‰å–â€¦çš„æ”¯æŒï¼Œå¯»æ±‚â€¦çš„èµåŒï¼›2. æ±‚çˆ±ï¼Œè¿½æ±‚ï¼ˆå¼‚æ€§ï¼‰ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [nÉ‘â€™stÃ¦ldÊ’É™] æ€€æ—§ <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn17" class="footnote-item"><p>ç¾ [â€˜rÊŠrÉ™l] ä¹¡æ‘çš„ï¼Œç”°å›­çš„ <a href="#fnref17" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn18" class="footnote-item"><p>ç¾ [â€˜fÃ¦mÉªn] é¥¥è’ï¼›ä¸¥é‡ç¼ºä¹ <a href="#fnref18" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn19" class="footnote-item"><p>ç¾ [ËŒrihÉ™ËŒbÉªlÉªËˆteÊƒÉ™n] æ¢å¤ï¼›å¹³å <a href="#fnref19" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn20" class="footnote-item"><p>å¦è¯š <a href="#fnref20" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn21" class="footnote-item"><p>ç¾ [â€˜relÉªk] é—è¿¹ï¼›é—ç‰©ï¼›é—é£ï¼›é—ä¿— <a href="#fnref21" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn22" class="footnote-item"><p>ç¾ [É¡rÊŒdÊ’] æ€¨æ¨ï¼›ç§¯æ€¨ï¼›å«Œéš™ <a href="#fnref22" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn23" class="footnote-item"><p>ç¾ [diâ€™bÊŒÅ‹k] æ­éœ²ï¼Œè¯´â€¦çš„åè¯ <a href="#fnref23" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn24" class="footnote-item"><p>ç¾ [â€˜hÃ¦nd.aÊŠt] 1. è®²ä¹‰ï¼Œä¼ å•ï¼›2. æ•‘æµå“ï¼Œæ”¿åºœæ‹¨æ¬¾ <a href="#fnref24" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn25" class="footnote-item"><p>ç¾ [â€˜depjÉ™ti] å‰¯çš„ï¼Œå‰¯æ‰‹ <a href="#fnref25" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn26" class="footnote-item"><p>ç¾ [Éªnâ€™sÉªpÉªd] æ— å‘³é“çš„ï¼›æ·¡è€Œæ— å‘³çš„ï¼›æ²¡æœ‰è¶£å‘³çš„ï¼›æ¯ç‡¥ä¹å‘³çš„ <a href="#fnref26" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn27" class="footnote-item"><p>ç¾ [tuâ€™mÊŒltÊƒÊŠÉ™s] å˜ˆæ‚çš„ï¼›å–§åš£çš„ï¼›çƒ­çƒˆçš„ï¼›æ¬¢è…¾çš„ <a href="#fnref27" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn28" class="footnote-item"><p>ç¾ [É¡rÃ¦sp] 1. æŠ“ä½ï¼Œç´§æ¡ï¼›2. ç†è§£ï¼Œé¢†ä¼š <a href="#fnref28" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn29" class="footnote-item"><p>è‹± [ÉªnËŒfÃ¦lÉ™â€™bÉªlÉ™ti] ç»å¯¹æ­£ç¡®ï¼›ç»æ— é”™è¯¯ï¼›ç»å¯¹ç¡®å® <a href="#fnref29" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn30" class="footnote-item"><p>ç¾ [.Ã¦dÊ’É™â€™leÉªÊƒ(É™)n] å¥‰æ‰¿ï¼Œé˜¿è°€ï¼Œè¿‡åˆ†åœ°ç§°èµ <a href="#fnref30" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn31" class="footnote-item"><p>ç¾ [zelÉ™t] ç‹‚çƒ­è€… <a href="#fnref31" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn32" class="footnote-item"><p>ç¾ [.Éªdiâ€™É‘lÉ™dÊ’i] æ„è¯†å½¢æ€ <a href="#fnref32" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn33" class="footnote-item"><p>ç¾ [dÉª.nÊŒnsiâ€™eÉªÊƒ(É™)n] æŒ‡è´£ï¼Œå…¬å¼€è°´è´£ <a href="#fnref33" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn34" class="footnote-item"><p>ç¾ [â€˜perÉ™.maÊŠnt] 1. é¦–è¦çš„ï¼›è‡³é«˜æ— ä¸Šçš„ï¼›2. æœ‰æœ€é«˜æƒåŠ›çš„äººï¼Œå…ƒé¦– <a href="#fnref34" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn35" class="footnote-item"><p>ç¾ [kÊŒlt] å´‡æ‹œï¼›é‚ªæ•™ <a href="#fnref35" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn36" class="footnote-item"><p>ç¾ [â€˜mÃ¦n.deÉªt] æˆæƒï¼Œä»»å‘½ <a href="#fnref36" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn37" class="footnote-item"><p>å®ç”¨åœ°ï¼›åŠ¡å®åœ° <a href="#fnref37" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn38" class="footnote-item"><p>ç¾ [lÉ™â€™dÊ’ÉªtÉ™mÉ™si] åˆç†æ€§ï¼Œåˆæ³•æ€§ <a href="#fnref38" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn39" class="footnote-item"><p>ç¾ [â€˜naÉªÉ™.lÉªzÉ™m] è™šæ— ä¸»ä¹‰ï¼Œæ— æ”¿åºœä¸»ä¹‰ <a href="#fnref39" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn40" class="footnote-item"><p>è‹± [É™â€™fens] 1. è¿›æ”»ï¼›2. è¿‡é”™ï¼›3. çŠ¯ç½ªï¼Œè¿æ³•è¡Œä¸º <a href="#fnref40" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn41" class="footnote-item"><p>ç¾ [.oÊŠvÉ™râ€™Î¸roÊŠ] é¢ è¦†ï¼Œæ¨ç¿» <a href="#fnref41" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>China</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>China</tag>
      </tags>
  </entry>
  <entry>
    <title>The world this week Politics</title>
    <url>/archives/4eb6fb1.html</url>
    <content><![CDATA[<p>In Hong Kong, 47 activists were charged with violating the territoryâ€™s national-security law. As a court began hearing defendantsâ€™ <mark class="label primary">petitions</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> to be released on bail, hundreds of supporters gathered outside. The activistsâ€™ alleged crimes relate to an informal primary ballot held last year by pro-democracy politicians in order to produce strong candidates for the Legislative Council. The government saw this as a plot to gain control of the council and block its work.</p>
<span id="more"></span>
<p>Chinaâ€™s Communist Party began a <mark class="label primary">purge</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> of agencies involved in maintaining law and order, including the police, secret police, courts and the prison system. The aim is to cleanse their ranks of corruption and disloyalty to Chinaâ€™s leader, Xi Jinping.</p>
<p>Security services killed dozens of people demonstrating against the recent military <mark class="label primary">coup</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> in Myanmar. The <mark class="label primary">repression</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> of the protests has been getting steadily more violent.</p>
<p>Mushtaq Ahmed, a writer <mark class="label primary">detained</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> without trial for almost a year in Bangladesh for criticising the government online, died in a prison hospital. On the same day in neighbouring India the government published new rules obliging social-media firms and digital publishers to remove certain content at the governmentâ€™s request.</p>
<p>In El Salvador, New Ideas, a party created in 2018 by Nayib Bukele, the 39-year-old president, won a <mark class="label primary">landslide</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> in legislative elections, taking at least 56 seats in the 84-seat assembly. Mr Bukele, who has been president since 2019, has an approval rating of around 90%. Now he has even fewer checks on his power.</p>
<p>Controversial changes to energy rules in Mexico proposed by the president, AndrÃ©s Manuel LÃ³pez Obrador, became more probable. The Senate agreed to a <mark class="label primary">measure</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> that could give the state power utility priority over private firms in supplying power to the grid, even if its output is dirtier and costlier. This could <mark class="label primary">breach</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> free-trade rules.</p>
<div class="note info"><p><strong>state power utility</strong>ï¼šå›½å®¶ç”µåŠ›å…¬å¸</p>
</div>
<p>Americaâ€™s House of Representatives passed a bill that would make postal voting easier and weaken the voter-ID requirements favoured mostly by Republican state legislatures. The bill is unlikely to pass the Senate, where it would need the support of Republicans.</p>
<div class="note info"><p><strong>Senate</strong>ï¼šå‚è®®é™¢</p>
<p><strong>House of Representatives</strong>ï¼šä¼—è®®é™¢</p>
<p><strong>Republican state legislatures</strong>ï¼šå…±å’Œå…šæ´²è®®ä¼š</p>
</div>
<p>Joe Biden abandoned his attempt to appoint Neera Tanden as his budget director, because of a lack of support in the Senate. Her previous <mark class="label primary">abrasive</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> tweets about senators pondering her nomination probably did not help.</p>
<p>Andrew Cuomo, the governor of New York, said he would not resign, after three women accused him of behaving inappropriately. This comes on top of criticism of Mr Cuomoâ€™s lack of transparency over covid-19 deaths in the stateâ€™s nursing homes.</p>
<p>America placed seven Russian officials, including Russiaâ€™s top spy, under <mark class="label primary">sanctions</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>for their alleged part in the poisoning last year of Alexei Navalny, the countryâ€™s leading opposition figure.</p>
<p>Nicolas Sarkozy, a former president of France, was <mark class="label primary">convicted</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> of corruption and sentenced to three years in prison, two of them suspended. He immediately appealed. This is the first time a French president has been handed an irreducible jail term (Jacques Chirac got a suspended prison sentence for misusing public funds as mayor of Paris).</p>
<p>Hungaryâ€™s prime minister, Viktor Orban, withdrew his Fidesz party from the European Peopleâ€™s Party, the centre-right and largest grouping in the European <mark class="label primary">Parliament</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup>. This came as the EPP agreed to rules that would make it much easier to <mark class="label primary">expel</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> a delegation from a country, like Hungary, that violates the rule of law.</p>
<div class="note info"><p><strong>Hungary</strong>ï¼šåŒˆç‰™åˆ©</p>
</div>
<p>Scotlandâ€™s first minister, Nicola Sturgeon, faced tough questions from a parliamentary committee at Holyrood about her mishandling of allegations of sexual <mark class="label primary">harassment</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup> levelled at Alex Salmond, her predecessor. A <mark class="label primary">jury</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> found Mr Salmond not guilty of all charges a year ago.</p>
<p>The International Criminal Courtâ€™s chief <mark class="label primary">prosecutor</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> opened an investigation into alleged war crimes in the Palestinian territories since June 2014. After a <mark class="label primary">preliminary</mark><sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup> examination she said charges could be filed against both Israelis and Palestinians.</p>
<div class="note info"><p><strong>Palestine</strong>ï¼šå·´å‹’æ–¯å¦</p>
<p><strong>Palestinian</strong>ï¼šå·´å‹’æ–¯å¦äººï¼Œå·´å‹’æ–¯å¦çš„</p>
<p><strong>Israeli</strong>ï¼šçŠ¹å¤ªäººï¼›ä»¥è‰²åˆ—çš„ï¼Œä»¥è‰²åˆ—äººçš„</p>
</div>
<p>Israelâ€™s prime minister, Binyamin Netanyahu, said Iran was behind an explosion that damaged an Israeli-owned commercial vessel in the Gulf of Oman. Days later one of his ministers linked Iran to an oil spill offÂ Israelâ€™s coast that has caused grave environmental damage.</p>
<mark class="label primary">Amnesty</mark>International accused government forces in Mozambique, <mark class="label primary">mercenaries</mark> working with them and the <mark class="label primary">jihadists</mark> they are battling of committing war crimes. A report by the human-rights group said the warring parties have <mark class="label primary">indiscriminately</mark> killed hundreds of civilians.
<div class="note info"><p>è¿™ä¸¤ä¸ªå•è¯çš„æ³¨è„šä¸çŸ¥é“ä¸ºä»€ä¹ˆè§£æå¤±è´¥ï¼Œåªèƒ½ç”¨æç¤ºã€‚</p>
<p><strong>amnesty</strong></p>
<p>éŸ³æ ‡ï¼šç¾ [â€˜Ã¦mnÉ™sti]</p>
<p>é‡Šä¹‰ï¼šç‰¹èµ¦</p>
<p><strong>mercenary</strong></p>
<p>éŸ³æ ‡ï¼šç¾ ['mÉœrs(É™)n.eri]</p>
<p>é‡Šä¹‰ï¼š1. é›‡ä½£å…µï¼Œé›‡ä½£å†›ï¼›2. åªä¸ºé‡‘é’±çš„ï¼Œå”¯åˆ©æ˜¯å›¾çš„</p>
<p><strong>jihadist</strong>ï¼šåœ£æˆ˜å£«</p>
<p><strong>indiscriminate</strong>ï¼š</p>
<p>éŸ³æ ‡ï¼šè‹± [ËŒÉªndÉªâ€™skrÉªmÉªnÉ™tlÉª]</p>
<p>é‡Šä¹‰ï¼šä¸åŠ åŒºåˆ«åœ°ï¼Œä¸åŠ é€‰æ‹©åœ°ï¼Œæ— å·®åˆ«åœ°</p>
</div>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [pÉ™â€™tÉªÊƒ(É™)n] è¯·æ±‚ï¼Œè¯·æ„¿ï¼Œç”³è¯· <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [pÉœrdÊ’] æ¸…é™¤ <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [ku] æ”¿å˜ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [rÉªâ€™preÊƒ(É™)n] æŠ‘åˆ¶ï¼Œé•‡å‹ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [dÉªâ€™teÉªn] æ‹˜ç•™ï¼Œæ‰£æŠ¼ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [â€˜lÃ¦nd.slaÉªd] 1. æ»‘å¡ï¼›2. ä¸€æ–¹å ç»å¯¹ä¼˜åŠ¿çš„é€‰ä¸¾ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [â€˜meÊ’É™r] 1. æµ‹é‡ï¼Œè¡¡é‡ï¼›2. æªæ–½ <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [britÊƒ] è¿åï¼Œè¿èƒŒ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [É™â€™breÉªsÉªv] 1. æœ‰ç ”ç£¨ä½œç”¨çš„ï¼›2. ç”Ÿç¡¬ç²—æš´çš„ï¼Œä¼¤äººæ„Ÿæƒ…çš„ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ ['sÃ¦Å‹kÊƒ(É™)n] 1. åˆ¶è£ï¼›2. æ‰¹å‡†ï¼Œè®¸å¯ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [kÉ™nâ€™vÉªkt] å®šç½ª <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [â€˜pÉ‘rlÉ™mÉ™nt] è®®ä¼šï¼Œå›½ä¼š <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [Éªkâ€™spel] èµ¶èµ°ï¼Œé©±é€å‡ºå¢ƒ <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [hÉ™â€™rÃ¦smÉ™nt] éªšæ‰° <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [â€˜dÊ’ÊŠri] é™ªå®¡å›¢ï¼Œè£åˆ¤å§”å‘˜ä¼š <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [â€˜prÉ‘sÉª.kjutÉ™r] æ£€å¯Ÿå®˜ï¼Œå…¬è¯‰äººï¼ŒåŸå‘Šå¾‹å¸ˆ <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn17" class="footnote-item"><p>ç¾ [prÉªâ€™lÉªmÉ™.neri] é¢„å¤‡çš„ï¼Œåˆæ­¥çš„ <a href="#fnref17" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>The world this week</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Politics</tag>
      </tags>
  </entry>
  <entry>
    <title>The world this week Business</title>
    <url>/archives/2b46cafc.html</url>
    <content><![CDATA[<p>The American Senate began debate on Joe Bidenâ€™s $1.9trn stimulus bill, after it passed the House of Representatives. Mr Biden will need the support of all 50 Democratic senators if it is to succeed. In one setback, the Senateâ€™s parliamentarian said that a measure to raise the minimum wage to $15 an hour could not be included in the legislation under the procedure by which the Democrats have introduced the bill.</p>
<span id="more"></span>
<p><strong>Spend now, pay later</strong></p>
<p>In Britain the governmentâ€™s budget provided yet more spending on workers and businesses to <mark class="label primary">cushion</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> the blow of the pandemic. The <mark class="label primary">furlough</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> scheme, which pays staff wages and has been in place for a year, was extended to September. Fiscal support for the pandemic now totals Â£407bn ($570bn). To pay for all this the government set out tax increases, including a rise in corporation tax from 19% to 25% in 2023. Before that there will be a two-year tax break for companies intended to <mark class="label primary">spur</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> investment.</p>
<p>Bond markets were quieter, following a <mark class="label primary">rout</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> in prices sparked by fears of rising inflation in America. The yield on the ten-year US Treasury bond fell back to 1.46%, having risen above 1.6%. It started the year well below 1%.</p>
<p>Indiaâ€™s economy pulled out of recession in the last three months of 2020, but only just. GDP expanded by 0.4% in the quarter, year on year. A huge stimulus package helped Brazil limit the pandemicâ€™s damage to its GDP, which shrank by 4.1% last year, a better performance than economies of similar size.</p>
<div class="note info"><p><strong>Brazil</strong>ï¼šå·´è¥¿</p>
</div>
<p>February was a record month for the value of SPACS, shell companies that list on a stock exchange with the intent of merging with an existing company, and so avoid the rigours of an IPO. SPACS struck 50 merger deals last month, totalling almost $109bn.</p>
<p>Rio Tintoâ€™s chairman decided to step down within a year because of the mining companyâ€™s <mark class="label primary">demolition</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> of a sacred <mark class="label primary">Aboriginal</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> cave in Australia in May 2020. Australian pension funds had pressed Rioâ€™s board to hold senior executives to account for the destruction.</p>
<div class="note info"><p><strong>step down</strong>ï¼šè¾èŒï¼Œä¸‹å°</p>
</div>
<p>Another week and another carmaker announced an ambitious electrification strategy, as Volvo said it would phase out all petrol-powered cars, including hybrids, by 2030, and sell only fully electric ones. It also plans to disrupt the established way of selling cars by <mark class="label primary">ditching</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> dealerships and making its new cars available only online.</p>
<div class="note info"><p><strong>phase out</strong>ï¼šé€æ­¥æ·˜æ±°ï¼Œé€æ­¥å–æ¶ˆï¼Œé€æ­¥åœæ­¢</p>
</div>
<p>Las Vegas Sands, founded by the late Sheldon Adelson, reached an agreement to sell the Venetian hotel in Las Vegas to private-equity and property investors for more than $6bn. The investors are<br>
taking a <mark class="label primary">punt</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> that Sin City will <mark class="label primary">rebound</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> when covid-19 restrictions are eased. The deal <mark class="label primary">underpins</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>Las Vegas Sandsâ€™ focus on its <mark class="label primary">casinos</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> in Macau and Singapore, the backbone of its business.</p>
<p>Both Lufthansa and International Airlines Group, the owner of British Airways, reported big annual losses. Looking for ways to save cash, BA has reached an agreement to defer Â£450m ($628m) in pension deficit contributions.</p>
<p>Covid-related restrictions brought about a 6% drop in energy-related carbon-dioxide emissions last year, according to the International Energy Agency. But as demand picked up, so did emissions, which were 2% higher in December 2020 than in December 2019. With its economy rebounding, Chinaâ€™s emissions rose over the year, by 0.8%; in America they fell by 10%. Globally, the decline in road activity accounted for 50% of the fall in demand for oil, and the <mark class="label primary">slump</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> in aviation for 35%.</p>
<p>There may be a new president in the White House, but Amazon still finds itself caught in political crosshairs. Joe Biden warned the retail giant this week not to interfere with a vote by workers at a warehouse in Alabama on whether to unionise, a first for all the employees at an Amazon facility. Meanwhile, Amazon was forced to change the recent redesign of its app logo, because the Twitterati thought it resembled Hitler.</p>
<div class="note info"><p><strong>Twitterati</strong>ï¼šç½‘ç»œè¾¾äºº</p>
</div>
<p>Birkenstock was sold to a private-equity firm backed by lvmh in a deal worth â‚¬4bn ($4.8bn). Associated with hippies in the 1970s until they became de rigueur for hipsters in the 1990s, Birkenstock sandals<sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> trace their history back to Germany in 1774; the current design dates from the 1960s. The Birkenstock family will no longer be sole owners, but they will retain a minority <mark class="label primary">stake</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup>.</p>
<p><strong>A one-way ticket?</strong></p>
<p>Maezawa Yusaku, a Japanese <mark class="label primary">tycoon</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup>, invited applications for eight places on his planned trip around the Moon, pencilled in for 2023. Meanwhile SpaceX, the firm that will fly Mr Maezawa and his companions, was testing a prototype version of the rocket he hopes to use. The machine managed to return to its landing pad after flying 10km into the air, but blew up a few minutes later.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ ['kÊŠÊƒ(É™)n] 1. åå«ï¼Œé å«ï¼›2. ç¼“å’Œï¼Œç¼“å†²ï¼ˆæ‰“å‡»ï¼‰ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [â€˜fÉœrloÊŠ] ï¼ˆå°¤æŒ‡åœ¨å›½å¤–æœå½¹å£«å…µçš„ï¼‰ä¼‘å‡ï¼ˆè®¸å¯) <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [spÉœr] åˆºæ¿€ï¼Œæ¿€åŠ±ï¼Œä¿ƒè¿› <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [raÊŠt] æºƒè´¥ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [.demÉ™â€™lÉªÊƒ(É™)n] 1. ç ´åï¼Œæ‹†é™¤ï¼›2. åºŸå¢Ÿ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [ËŒÃ¦bÉ™ËˆrÉªdÊ’É™n(É™)l] 1. åœŸè‘—ï¼ŒåŸä½æ°‘ï¼›2. åœŸè‘—çš„ï¼ŒåŸå§‹çš„ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [dÉªtÊƒ] æ‘†è„±ï¼ŒæŠ›å¼ƒ <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [pÊŒnt] èµŒåšï¼Œæ‰“èµŒ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [rÉªâ€™baÊŠnd] 1. ç¯®æ¿çƒï¼›2. å¤å…´ï¼Œå¤è‹ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ [.ÊŒndÉ™râ€™pÉªn] å·©å›ºï¼Œæ”¯æ’‘ï¼ŒåŠ å¼º <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [kÉ™â€™sinoÊŠ] èµŒåœº <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [slÊŒmp] æš´è·Œï¼Œé”å‡ <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ ['sÃ¦nd(É™)l] å‡‰é‹ <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [steÉªk] è‚¡ä»½ <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [taÉªËˆkuËn] å¤§äº¨ï¼Œä¼ä¸šå·¨å¤´ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>The world this week</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Business</tag>
      </tags>
  </entry>
  <entry>
    <title>Bouncing back</title>
    <url>/archives/214164ed.html</url>
    <content><![CDATA[<center><b>How to make a social safety net for the post-covid world</b></center>
<p>After the Depression and the second world war, voters and governments in rich countries recast the relationship between the state and its citizens. Now the pandemic has seen the old rules on social spending <mark class="label primary">ripped</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> up. More than three-quarters of Americans support President Joe Bidenâ€™s $1.9trn stimulus bill, which is due in the Senate and includes $1,400 cheques for most adults. And in the budget on March 3rd Britain extended a scheme to pay the wages of furloughed workers until September, even as public debt hit its highest level since 1945 (see leader). Such <mark class="label primary">boldness</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> brings dangers: governments could stretch the public finances to breaking-point, <mark class="label primary">distort</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> incentives and create <mark class="label primary">sclerotic</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> societies. But they also have a chance to create new social-welfare policies that are affordable and which help workers thrive in an economy facing technological <mark class="label primary">disruption</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>. They must seize it.</p>
<span id="more"></span>
<p>The past year has seen a wild experiment in social spending. The world launched at least 1,600 new social-protection programmes in 2020 (see Briefing). Rich countries have provided 5.8% of GDP on average to help record numbers of workers. Government debts are piling up , but so far low interest rates mean that they are cheap to service. The publicâ€™s mood had already been shifting. Britons used to grumble that <mark class="label primary">layabouts</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> <mark class="label primary">sponged</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> offÂ the welfare state; now they are more likely to say help is too <mark class="label primary">stingy</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>. Last year over two-thirds of Europeans said they supported a universal basic income (UBI), an unconditional recurring payment to all adults. Affluent professionals have had their gaze drawn to the working conditions of those who deliver food and look after the sick. The struggles of women who have dropped out of the workforce to care for children and the elderly have become impossible to ignore.</p>
<div class="note info"><p><strong>sponge off</strong>ï¼šä¾èµ–â€¦ç”Ÿæ´»</p>
</div>
<p>The social safety net in many rich countries was <mark class="label primary">creaking</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> before covid-19 struck. Modelled on the ideas of Ottovon Bismarck and William Beveridge, it had often failed to cushion workers from globalisation and technological and social change. In 1999-2019 the number of Americans aged 25-54 outside the labour force grew by 25%, or 4.7m, over six times more than the number who received help from the main assistance programme for <mark class="label primary">displaced</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup> workers. As health-care and pension costs soared in recent years, governments cut back support for working-age people. Between 2014 and 2018 Britainâ€™s state-pension bill grew in real terms by Â£4bn ($5.8bn), even as the rest of its welfare budget shrank by Â£ 16.5bn. A <mark class="label primary">dwindling</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> share of middle-income jobs and the growth of the gig economy fuelled fears that labour markets were changing faster than flat-footed governments could.</p>
<div class="note info"><p><strong>labour force</strong>ï¼šåŠ³åŠ¨åŠ›</p>
<p><strong>gig economy</strong>ï¼šé›¶å·¥ç»æµ</p>
<p><strong>flat-footed</strong>ï¼šæªæ‰‹ä¸åŠçš„</p>
</div>
<p>With the public and some economists cheering on, it is <mark class="label primary">tempting</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> for politicians to <mark class="label primary">stoke</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> the economy with more ad hoc spending, or put in place vast schemes such as UBI. Instead they need to take a measured, longterm view. The safety net must be affordable. Tight budgets, not milk and honey, will define the 2020s. The annual deficit of big advanced economies was 4% of their combined GDP even before the pandemicâ€”and much ageing is still to come. Already bond yields are rising again (see Finance section). Social spending must flow quickly and automatically to those who need itâ€”not, as in America, only during crises when a panicked government passes emergency legislation. And governments need to find mechanisms that cushion people more effectively against income shocks and joblessness without discouraging work or crushing economic dynamism.</p>
<p>The first step towards satisfying these goals is to use technology to make ancient bureaucracies more efficient. Postal cheques, 1980s mainframe computers and <mark class="label primary">shoddy</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup> data need to be relegated to the past. In the pandemic many governments temporarily short-circuited their existing systems because they were too slow. In Estonia and Singapore digital-identification systems and a <mark class="label primary">disdain</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> for form-filling became an asset in the crisis. More countries need to copy them and also to ensure universal access to the internet and bank accounts. The call for efficient administration may sound like tinkering but one in five poor Americans eligible for wage topups fails to claim them. <mark class="label primary">Nimble</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> digital-payment systems will reduce the need for costly universalism as a fail-safe, and allow better targeting and quicker response times. Digital systems also permit the emergency option of making temporary cash payments to all households.</p>
<div class="note info"><p><strong>wage topup</strong>ï¼šå·¥èµ„è¡¥è´´</p>
<p><strong>fail-safe</strong>ï¼šå¤±æ•ˆä¿æŠ¤ï¼›äº‹æ•…ä¿é™©</p>
</div>
<p>That is the easy part. Balancing generosity and dynamism is harder. Part of the solution is to top up the wages of low-paid workers. AngloSax on countries have done this well since reforms in the 1990s and 2000s. But wage topups are of little use to the jobless and are often <mark class="label primary">scant</mark><sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup> compensation for people who lose good jobs to forces beyond their control. <mark class="label primary">Paltry</mark><sup class="footnote-ref"><a href="#fn18" id="fnref18">[18]</a></sup> support for the unemployed in Britain and America preserves incentives to work but at high human cost. The sparsity of social insu ance has <mark class="label primary">undermined</mark><sup class="footnote-ref"><a href="#fn19" id="fnref19">[19]</a></sup> political support for creative destruction, the <mark class="label primary">catalyst</mark><sup class="footnote-ref"><a href="#fn20" id="fnref20">[20]</a></sup> for rising living standards. Continental Europe tends to <mark class="label primary">underwrite</mark><sup class="footnote-ref"><a href="#fn21" id="fnref21">[21]</a></sup> traditional workersâ€™ incomes more generously. But the distortion of incentives leads to higher unemployment and divisions between <mark class="label primary">coddled</mark><sup class="footnote-ref"><a href="#fn22" id="fnref22">[22]</a></sup> insiders and a <mark class="label primary">precariat</mark><sup class="footnote-ref"><a href="#fn23" id="fnref23">[23]</a></sup>. Both sides of the Atlantic lack a permanent safety net that insures gig workers and the self-employed.</p>
<p>There is one country that combines labour-market flexibility with generosity: Denmark, which spends large sumsâ€”1.9% of GDP in 2018â€”on retraining and on advising the jobless. These interventions stop the unemployed from falling into dependency. The inadequacies of policies elsewhere are often glaring . Britainâ€™s efforts have <mark class="label primary">flopped</mark><sup class="footnote-ref"><a href="#fn24" id="fnref24">[24]</a></sup>. Americaâ€™s comparable spending is less than a 20th as large as Denmarkâ€™s, even though the few lucky beneficiaries of its â€œtrade-adjustment assistanceâ€ earn $50,000 more in wages, on average, over a decade.</p>
<p><strong>Bungee economics</strong></p>
<p>For years social spending has favoured the elderly and an outdated safety net. It should be rebuilt around active labour-market policies that use technology to help everyone from shop-workers who are victims of disruption to mothers whose skills have <mark class="label primary">atrophied</mark><sup class="footnote-ref"><a href="#fn25" id="fnref25">[25]</a></sup> and those whose jobs are replaced by machines. Governments cannot eliminate risk, but they can help ensure that if calamity strikes, people bounce back.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [rÉªp] ï¼ˆçªç„¶æˆ–çŒ›çƒˆåœ°ï¼‰æ’•ç ´ï¼Œæ’•è£‚ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [â€˜boÊŠldnÉªs] 1. é­„åŠ›ï¼›2. å¤§èƒ†ï¼Œå†’å¤± <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [dÉªâ€™stÉ”rt] æ‰­æ›²ï¼Œä½¿å˜å½¢ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [sklÉ™â€™rÉ‘tÉªk] ç¡¬çš„ï¼Œç¡¬åŒ–çš„ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [dÉªsâ€™rÊŒpÊƒÉ™n] ä¸­æ–­ï¼›ç ´åï¼›ç´Šä¹±ï¼Œæ··ä¹±ï¼›æ•…éšœï¼Œå¤±å¸¸ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [â€˜leÉªÉ™.baÊŠt] æ‡’æ±‰ï¼Œæ¸¸æ‰‹å¥½é—²çš„äºº <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [spÊŒndÊ’] 1. æµ·ç»µï¼›2. ç”¨æµ·ç»µæ“¦æ‹­ <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [â€˜stÉªndÊ’i] å°æ°”çš„ï¼Œåå•¬çš„ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [krik] å±å±ä½œå“ï¼Œè¿è½¬ä¸çµ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ [dÉªsâ€™pleÉªs] å–ä»£ï¼Œç½®æ¢ï¼›æµç¦»å¤±æ‰€ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ ['dwÉªnd(É™)l] ç¼©å°ï¼Œé€æ¸å‡å°‘ <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [â€˜temptÉªÅ‹] å¸å¼•äººçš„ï¼Œè¯±äººçš„ <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [stoÊŠk] 1. ç»™â€¦æ·»åŠ ï¼ˆç‡ƒæ–™ï¼‰ï¼›2. ç…½åŠ¨ï¼Œåˆºæ¿€ <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [â€˜ÊƒÉ‘di] åŠ£è´¨çš„ï¼Œåšå·¥ç²—ç³™çš„ <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [dÉªsâ€™deÉªn] è”‘è§†ï¼Œé„™è§†ï¼Œä¸å±‘ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [ËˆnÉªmb(É™)l] æ•æ·çš„ï¼Œçµæ´»çš„ <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn17" class="footnote-item"><p>ç¾ [skÃ¦nt] ä¸€ä¸ç‚¹çš„ï¼Œå¾®å°çš„ï¼Œä¸è¶³çš„ <a href="#fnref17" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn18" class="footnote-item"><p>ç¾ [â€˜pÉ”ltri] å¯å¿½ç•¥ä¸è®¡çš„ï¼Œå¾®ä¸è¶³é“çš„ <a href="#fnref18" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn19" class="footnote-item"><p>ç¾ [.ÊŒndÉ™râ€™maÉªn] é€æ¸å‰Šå¼±ï¼ˆä¿¡å¿ƒã€æƒå¨ç­‰ï¼‰ï¼›ä½¿é€æ­¥å‡å°‘æ•ˆåŠ›ï¼›ä»æ ¹åŸºå¤„ç ´åï¼›æŒ–â€¦çš„å¢™è„š <a href="#fnref19" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn20" class="footnote-item"><p>ç¾ ['kÃ¦t(É™)lÉªst] å‚¬åŒ–å‰‚ï¼Œå¼•å‘å˜åŒ–çš„å› ç´  <a href="#fnref20" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn21" class="footnote-item"><p>ç¾ [.ÊŒndÉ™râ€™raÉªt] æ‰¿æ‹…ç»æµè´£ä»»ï¼ˆåŒ…æ‹¬æ”¯ä»˜ç‰¹åˆ«è´¹ç”¨æˆ–æŸå¤±ï¼‰ï¼›æ‰¿æ‹…ä¿é™©è´£ä»»ï¼›æ‰¿ä¿ï¼›åŒ…é”€ <a href="#fnref21" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn22" class="footnote-item"><p>ç¾ ['kÉ‘d(É™)l] å¨‡æƒ¯ï¼Œæººçˆ± <a href="#fnref22" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn23" class="footnote-item"><p>ä¸ç¨³å®šæ— èµ„äº§è€…ï¼Œæœä¸ä¿å¤•è€… <a href="#fnref23" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn24" class="footnote-item"><p>ç¾ [flÉ‘p] å®Œå…¨å¤±è´¥ <a href="#fnref24" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn25" class="footnote-item"><p>ç¾ [â€˜Ã¦trÉ™fi] èç¼©ï¼Œè¡°é€€ï¼Œé€€åŒ– <a href="#fnref25" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>Leaders</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Leaders</tag>
      </tags>
  </entry>
  <entry>
    <title>St Augustineâ€™s economics</title>
    <url>/archives/54889c6e.html</url>
    <content><![CDATA[<center><b>The <mark class="label primary">chancellor</mark> wants to <mark class="label primary">rein</mark> in government spending, but not yet</b></center>
<div class="note info"><p><strong>chancellor</strong>ï¼šæ€»ç†ï¼Œå¤§è‡£ï¼›å¤§å­¦æ ¡é•¿</p>
<p><strong>rein</strong>ï¼šæ§åˆ¶</p>
</div>
<p>Britain had a particularly bad <mark class="label primary">bout</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> of covid-19 and took an especially large economic hit as a result. In response the government provided more fiÂscal stimulus than almost any other in the world, paying millions of peopleâ€™s wages and bailing out businesses to the tune of 16% of GDP. As Britain slowly lifts its lockdown the conversation has turned to balancing the books, and ahead of the budget on March 3rd the Treasury briefed that fiÂscal <mark class="label primary">austerity</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> was in store. Yet Rishi Sunak, the chancellor of the <mark class="label primary">exchequer</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>, will wait to turn the screws. He delivered a surprisingly generous budget, and has postponed tax rises. Like a fiscal St Augustine, he wants <mark class="label primary">continence</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>â€”but not yet.</p>
<span id="more"></span>
<p>The budget represents the synthesis of two opposing forces. On the one hand Mr Sunak wants to <mark class="label primary">placate</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> a range of hawkish constituencies, such as Thatcherite <mark class="label primary">backbench</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> Tory MPS who would rather the government keep taxes low and bond traders who in recent weeks have sold their investments in <mark class="label primary">sovereign</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> debt. On the other hand he is rightly concerned not to repeat the mistake of his predecessor-but-two: after the fiÂnancial crisis in 2007-09 George Osborne cut spending and raised taxes too soon, thereby delaying the recovery.</p>
<p>Policies in this budget are designed to help Britain out of its deep economic hole (see Britain section). The extension of the furlough scheme from April to September will put money in peopleâ€™s pockets, helping power a recovery in household spending. A highly unusual proposal to allow firms to write offÂ 130% of investment expenses against their tax bills is designed to super-charge Britainâ€™s <mark class="label primary">perennially</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> low rate of business investment.</p>
<p>At the same time, the budget has blind spots. Extending the furlough is better than nothing, but it would have been wiser to focus resources on boosting working age welfare, currently at its least generous level ever. This would have helped workers move from dying sectors to up-and-coming ones without seeing a sharp drop in their take-home income. And a government that likes to <mark class="label primary">trumpet</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> its green credentials should not be buying offÂ voters by freezing taxes on fuel.</p>
<div class="note info"><p><strong>take-home income</strong>ï¼šå®å¾—å·¥èµ„ï¼›ç¨åå‡€æ”¶å…¥</p>
</div>
<p>A bigger difficulty is that there is no credible strategy for righting the fiscal ship. True, Mr Sunak promised to raise corporation tax in 2023 from 19% to 25%. Politically that is <mark class="label primary">astute</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>. It puts the opposition Labour Party into a tricky position, forcing it to decide whether it wants to support the rise (and thus implicitly back austerity) or oppose it (and thus appear to be taking the side of Britainâ€™s corporate fat cats).</p>
<p>In economic terms, however, Mr Sunak is being <mark class="label primary">evasive</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup>. The yield from even large rises in corporation tax is low. Moreover, will he actually impose such a tax rise just when the 130% investment write-offÂ ends and when an election is likely to be just around the corner? It is more probable that the chancellor hopes the coming investment boom is so large that he can cancel most of the tax increase and that he will be able to pass a smaller rise as, in effect, a â€œcutâ€.</p>
<p>At some point, however, politics will catch up with him. That is in part because of Britainâ€™s rapidly ageing population, and in part because the government has bizarrely made no provision whatsoever for virus-related costs beyond next year. Britain is on an <mark class="label primary">inexorable</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> trend towards higher budget defiÂcits. It is hard to find much waste in the public sector, which limits the scope to cut spending. The chancellor will have to fall back on higher taxes. He will have to consider slaying sacred Tory cows, including a <mark class="label primary">pledge</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> not to increase income tax. He should consider reform of property and value-added taxes. Hawkish <mark class="label primary">rhetoric</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup> is all very well, but eventually Mr Sunak will have to follow St Augustine onto the path of fiscal virtue.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [baÊŠt] ä¸€æ¬¡ï¼Œä¸€åœºï¼Œä¸€å› <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [É”â€™sterÉ™ti] èŠ‚ä¿­ï¼Œç®€æœ´ï¼Œæœ´ç´ ï¼›ï¼ˆç»æµçš„ï¼‰ç´§ç¼© <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [Éªksâ€™tÊƒekÉ™Â®] å›½åº“ï¼Œï¼ˆè‹±å›½ï¼‰è´¢æ”¿éƒ¨ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [â€˜kÉ’ntÉªnÉ™ns] èŠ‚åˆ¶ï¼Œå…‹åˆ¶ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [â€˜pleÉªkeÉªt] å®‰æŠšï¼Œå¹³æ¯ï¼ˆæ€’æ°”ï¼‰ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [â€˜bÃ¦k.bentÊƒ] æ™®é€šè®®å‘˜å¸­ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [â€˜sÉ‘vrÉ™n] å›ä¸»ï¼Œå…ƒé¦–ï¼Œæœ€é«˜ç»Ÿæ²»è€… <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>è‹± [pÉ™â€™reniÉ™li] ç»ˆå¹´åœ°ï¼Œå¸¸å¹´åœ° <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [â€˜trÊŒmpÉ™t] 1. å–‡å­ï¼Œå°å·ï¼›2. å®£æ‰¬ï¼Œå¹å˜˜ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ [É™â€™stut] ç²¾æ˜çš„ï¼Œç‹¡çŒ¾çš„ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [iËˆveÉªsiv] å›é¿çš„ï¼Œæ¨è¯¿çš„ï¼Œé—ªçƒå…¶è¯çš„ï¼Œå«ç³Šçš„ <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [Éªnâ€™eksÉ™rÉ™b(É™)l] ä¸å¯é˜»æŒ¡çš„ï¼›æ— æ³•æ”¹å˜çš„ <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [pledÊ’] èª“è¨€ï¼Œä¿è¯ <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [â€˜retÉ™rÉªk] ä¿®è¾ï¼›èŠ±è¨€å·§è¯­ <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>Leaders</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Leaders</tag>
      </tags>
  </entry>
  <entry>
    <title>Itâ€™s complicated</title>
    <url>/archives/386aba8.html</url>
    <content><![CDATA[<center><b>What America should do in the Middle East</b></center>
<p>Joe biden has made no secret of his frustration with Saudi Arabia. A â€œ<mark class="label primary">pariah</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>â€ with â€œvery little social <mark class="label primary">redeeming</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> valueâ€, he called its government in 2019. One of his first acts as president was to end American support for the Saudiled war in Yemen. Last week he released an intelligence report that blamed the kingdomâ€™s crown prince, Muhammad bin Salman, for the murder of a journalist in 2018. But at that point Mr Bidenâ€™s ideals collided with Americaâ€™s national interest. The prince may be a brute, but he is also in charge of an important American ally. In the end Mr Biden decided that the cost of punishing him would have been too high.</p>
<span id="more"></span>
<div class="note info"><p><strong>make no secret of</strong>ï¼šæ¯«ä¸æ©é¥°</p>
</div>
<p>This is all part of a larger cost-benefit analysis taking place in the White House. Mr Biden has signalled that he wants to make the Middle East less of a priority. He has good reason to pull back. America has thousands of soldiers spread across Arab countries, yet its interventions have produced <mark class="label primary">dismal</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> results. Many Americans argue that their country should instead focus on countering Chinaâ€™s growing global influence. The question facing the Biden administration is how to lighten Americaâ€™s burden in the Middle East while still protecting its vital interests there. That will not be easy.</p>
<p>It helps that those interests are not what they were. For decades America focused on the flow of Gulf oil and the survival of Israel. Last year America was a net exporter of both oil and natural gas. And Israel, the best-armed country in the region, now has formal ties with many of its Arab neighbours.</p>
<p>Yet vital interests remain. Terrorist groups that find havens in Iraq, Syria or Yemen may end up striking the West. If the government in Iran seeks a bomb it risks setting offÂ an arms race that would blow apart the global non-<mark class="label primary">proliferation</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> <mark class="label primary">regime</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> and permanently put the Middle East on a nuclear knife-edge.</p>
<p>In the past America has sought to impose magical solutions. George W. Bush attempted to <mark class="label primary">decree</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> a democracy in Iraq. Donald Trump <mark class="label primary">wielded</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> sanctions to force <mark class="label primary">capitulation</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> or a change in regime in Iran. As these approaches failed, American policy swung between interest and <mark class="label primary">apathy</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>, and war and <mark class="label primary">retreat</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>.</p>
<p>Mr Biden should instead try to bring stability by getting the region to take responsibility for itself and discouraging leaders from being so dependent on armed force. Americaâ€™s big arms sales to the regionâ€™s <mark class="label primary">despots</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> are a source of trouble. And they do little to help the regionâ€™s people, who suffer from poor government and abusive regimes , which in turn foster extremism. RAND, a think-tank, recently noted that America spends <mark class="label primary">roughly</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> as much on Egyptâ€™s armed forces as it does on aid to the entire region. Mr Biden should cancel the blank cheque for mischief-making and repression.</p>
<p>The second leg to this strategy is to enhance the Middle Eastâ€™s capacity for diplomacy. The deals known as the Abraham Accords, which the Trump administration helped <mark class="label primary">broker</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> between Israel and several Arab states, are a tentative start towards upgrading the regionâ€™s diplomatic machinery. Mr Biden should encourage more such talking. Saudi Arabia and the United Arab Emirates were shocked when Mr Trump failed to come to their defence after attacks by Iran and its proxies. Iran is suffering under American sanctions. Their anxiety gives Mr Biden leverage in asserting that lowering tensions is in everyoneâ€™s interest.</p>
<p>Encouraging diplomacy does not mean withdrawing all American troops. They have helped suppress Islamic State and al-Qaeda, which are still active. And soft power tends to be more effective when hard power <mark class="label primary">lurks</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup> in the background. For example, the air strike on an Iranian-backed <mark class="label primary">militia</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> in Syria last month was <mark class="label primary">retaliation</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> for an attack on Americans in Iraqâ€”and a signal to the government in Tehran that Mr Biden would not roll over in negotiations to revive the Iran nuclear deal. Talking is not easy but, if America wants to focus less on a troubled part of the world, it is the only way ahead.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [pÉ™â€™raÉªÉ™] è¢«ç¤¾ä¼šé—å¼ƒè€…ï¼Œè´±æ°‘ï¼Œå¼ƒæ°‘ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [rÉªâ€™dim] èµå›ï¼›æ•‘èµï¼›å…‘æ¢ï¼›å…‘ç° <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [â€˜dÉªzmÉ™l] é˜´éƒçš„ï¼Œå‡„å‡‰çš„ï¼Œæƒ¨æ·¡çš„ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [prÉ™ËŒlÉªfÉ™ËˆreÉªÊƒ(É™)n] å¢æ®–ï¼Œæ‰©æ•£ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [reÉªâ€™Ê’im] æ”¿æƒï¼Œåˆ¶åº¦ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [dÉªâ€™kri] åˆ¤å†³ï¼Œé¢å¸ƒï¼Œè£å®š <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [wiËld] è¡Œä½¿ï¼Œè¿ç”¨ï¼ŒæŒ¥èˆ <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [kÉ™ËŒpÉªtÊƒÉ™ËˆleÊƒÉ™n] æŠ•é™ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [â€˜Ã¦pÉ™Î¸i] å†·æ¼ ï¼Œå†·æ·¡ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ [rÉªâ€™trit] æ’¤é€€ï¼›é€€å´ï¼Œé€€ç¼© <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [â€˜de.spÉ‘t] æš´å›ï¼Œç‹¬è£è€…ï¼Œä¸“åˆ¶ç»Ÿæ²»è€… <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [â€˜rÊŒfli] å¤§è‡´ï¼Œå·®ä¸å¤šï¼›ç²—æš´åœ° <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [â€˜broÊŠkÉ™r] ç»çºªäººï¼Œç»æµå•†ï¼›åå•† <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [lÉœrk] æ½œä¼ï¼ŒåŸ‹è—ï¼›è¯¡è®¡ï¼ŒèŠ±æ‹› <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [mÉ™â€™lÉªÊƒÉ™] æ°‘å…µç»„ç»‡ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [rÉª.tÃ¦liâ€™eÉªÊƒ(É™)n] æŠ¥å¤ï¼Œåå‡» <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>Leaders</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Leaders</tag>
      </tags>
  </entry>
  <entry>
    <title>The darkest corners</title>
    <url>/archives/bef6e425.html</url>
    <content><![CDATA[<center><b>A clear-out of the security agencies shows the opacity of power in China</b></center>
<p>Purges have grown more common since Xi Jinping took over as Chinaâ€™s leader in 2012. To <mark class="label primary">curb</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> <mark class="label primary">graft</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> and <mark class="label primary">snuff</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> out any opposition to his rule , Mr Xi has been hunting in every corner of the countryâ€™s vast bureaucracy. Hundreds of thousands of offiÂcials have been punished. Thousands, many of them high-ranking, have been sent to prison. Remarkably, however, some people do not appear to have got the message. A new campaign has just been launched within the domestic security services (see China section). Weeding out the disloyal is its primary goal.</p>
<span id="more"></span>
<div class="note info"><p><strong>Weeding out</strong>ï¼šæ·˜æ±°ï¼Œæ¸…é™¤</p>
</div>
<p>Can there still be serious opposition to Mr Xi? There is certainly little sign of it on the streets. Many ordinary citizens express content with his rule. Under him, China has become far more influential globally. The economy has kept on growing at a healthy rate (and surprisingly well despite the pandemic). His anti-corruption efforts are popular. Neither is there any obvious sign of discontent within the Communist Party elite. It seems likely that many bitterly <mark class="label primary">resent</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> the anti-graft inspectors, and that some senior officials even <mark class="label primary">gnash</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> their teeth. But those with <mark class="label primary">misgivings</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> about Mr Xi know they must keep their mouths shut and their heads down.</p>
<p>A lesson from this latest purge, however, is that the outside world only dimly understands Mr Xiâ€™s political world. One stated aim of the campaign is to remove the â€œ<mark class="label primary">pernicious</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> influenceâ€ of Zhou Yongkang, who was Chinaâ€™s security overlord just before Mr Xi took power. Mr Zhou was jailed in 2015 for corruption and leaking state secrets. Officials also accused him of â€œpolitical plottingâ€â€”shorthand, many observers believe, for scheming against Mr Xi. That his name is still being in voked years later hints at tensions, but it is hard for outsiders to judge how serious they are. The agencies being targeted in the new campaign occupy the darkest corners of an opaque political system: the police, the secret police, the <mark class="label primary">judiciary</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> and the prison service. In the months leading up to the purge several powerful figures within this apparatus were <mark class="label primary">toppled</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>. One was the chief of police in Shanghai, who has been accused of forming â€œ<mark class="label primary">factions</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>â€. All detail of what that may mean is a closely guarded secret.</p>
<p>Despite this, the new purge contains clear messages. One is Mr Xiâ€™s appetite for power. The campaign will wrap up in time for a big political event late in 2022: the five-yearly party congress. He looks sure to use this to extend his rule for another five years, in <mark class="label primary">defiance</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> of the convention that general secretaries step down after a decade. Tightening control over the security forces will help crush any opposition to his innovation.</p>
<div class="note info"><p><strong>wrap up</strong>ï¼šå®Œæˆï¼Œç»“æŸ</p>
<p>**step down **ï¼šè¾èŒï¼Œä¸‹å°</p>
</div>
<p>That raises the other, still bigger, reason to pay attention. For all the seeming <mark class="label primary">relentlessness</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> of the rise of China under an increasingly <mark class="label primary">adamantine</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> <mark class="label primary">authoritarianism</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup>, politics can pack surprises that suddenly change the countryâ€™s <mark class="label primary">trajectory</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup>. Consider the arrest of Mao Zedongâ€™s widow and others in the â€œGang of Fourâ€ in 1976, the struggle that brought Deng Xiaoping to power two years later, the regime-threatening splits within the party that emerged during the Tiananmen Square <mark class="label primary">protests</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> of 1989 and the political bloodletting that eliminated Mr Xiâ€™s rivals in the lead-up to his own anointment. You cannot rule out more such <mark class="label primary">disruptive</mark><sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup> shocks.</p>
<p>In the build-up to next yearâ€™s congress, the <mark class="label primary">murky</mark><sup class="footnote-ref"><a href="#fn18" id="fnref18">[18]</a></sup> waters of Chinese politics will deserve even closer <mark class="label primary">scrutiny</mark><sup class="footnote-ref"><a href="#fn19" id="fnref19">[19]</a></sup>. That is in part because Mr Xi <mark class="label primary">defies</mark><sup class="footnote-ref"><a href="#fn20" id="fnref20">[20]</a></sup> norms. As well as rejecting the modern principle that Chinaâ€™s leader gets only ten years at the top, he has seized more levers of power than any ruler since Mao. It is also because, under Mr Xi, the regime has become even more secretive. Alas, such secrecy makes for a government less accountable to citizens and more likely to catch the world unaware.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [kÉœrb] æŠ‘åˆ¶ï¼Œéåˆ¶ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [É¡rÃ¦ft] è´ªæ±¡ <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [snÊŒf] æç­ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [rÉªâ€™zent] æ„¤æ¨ï¼Œæ†æ¶ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [nÃ¦Êƒ] å’¬ç‰™åˆ‡é½¿ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [mÉªsâ€™É¡ÉªvÉªÅ‹] ç–‘è™‘ï¼Œé¡¾å¿Œï¼Œä¸å®‰ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [pÉ™râ€™nÉªÊƒÉ™s] æœ‰å®³çš„ï¼Œæ¶æ€§çš„ <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [dÊ’uâ€™dÉªÊƒÉ™ri] å¸æ³•æœºå…³ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ ['tÉ‘p(É™)l] æ¨ç¿»ï¼Œé¢ è¦† <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ ['fÃ¦kÊƒ(É™)n] æ´¾åˆ«ï¼Œå…šæ´¾ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [dÉªâ€™faÉªÉ™ns] åæŠ—ï¼Œè¿æŠ—ï¼ŒæŒ‘æˆ˜ï¼Œæ‹’ç»æœä» <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [rÉªâ€™lentlÉ™s] æ— æƒ…ï¼Œæ®‹é…· <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [ËŒÃ¦dÉ™â€™mÃ¦ntaÉªn] åšéŸ§çš„ï¼Œåšå®šä¸ç§»çš„ <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [É”.Î¸É”rÉªâ€™teriÉ™.nÉªzÉ™m] ç‹¬è£ä¸»ä¹‰ <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [trÉ™â€™dÊ’ektÉ™ri] è½¨è¿¹ï¼Œè½¨é“ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [â€˜proÊŠ.test] æŠ—è®®ï¼Œåå¯¹ <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn17" class="footnote-item"><p>ç¾ [dÉªsâ€™rÊŒptÉªv] ç ´åæ€§çš„ï¼Œé¢ è¦†æ€§çš„ï¼Œå¼•èµ·æ··ä¹±çš„ <a href="#fnref17" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn18" class="footnote-item"><p>ç¾ [â€˜mÉœrki] æµ‘æµŠçš„ï¼Œé˜´æš—çš„ <a href="#fnref18" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn19" class="footnote-item"><p>ç¾ ['skrut(É™)ni] ä»”ç»†æ£€æŸ¥ï¼›è®¤çœŸå½»åº•çš„å®¡æŸ¥ <a href="#fnref19" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn20" class="footnote-item"><p>ç¾ [dÉªâ€™faÉª] è”‘è§†ï¼Œä¸é¡¾ï¼Œå…¬ç„¶åæŠ— <a href="#fnref20" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>Leaders</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Leaders</tag>
      </tags>
  </entry>
  <entry>
    <title>The lessons of Fukushima</title>
    <url>/archives/5188b436.html</url>
    <content><![CDATA[<center><b>Nuclear power must be well run, not ditched</b></center>
<p>It has been ten years since a <mark class="label primary">tsunami</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> laid waste the Pacific coast of northern Honshu, Japanâ€™s most populous island. The tsunami and the undersea earthquake which triggered it, the largest ever recorded in the region, killed nearly 20,000 people, destroyed over 100,000 homes and threw the lives of tens of millions into <mark class="label primary">turmoil</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>. The direct economic cost, estimated at over $200bn, was larger than that of any other natural disaster the world has seen. And yet for many around the world the event is remembered for just one thing: the <mark class="label primary">ensuing</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> crisis at the Fukushima Daiichi nuclear power plant (see Asia section).</p>
<span id="more"></span>
<div class="note info"><p><strong>Honshu</strong>ï¼šæœ¬å·å²›</p>
<p><strong>Fukushima</strong>ï¼šç¦å²›</p>
</div>
<p>The earthquake cut the plant off from outside sources of electricity. The tsunami easily topped the plantâ€™s sea walls, flooding the underground bunkers containing its emergency generatorsâ€”a foreseeable risk Japanâ€™s neutered regulators had failed to foresee. Because there was no way to cool the reactor cores, the nuclear fuel within them began to melt; amid fire, explosion and alarming amounts of radiation, a <mark class="label primary">puddle</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> from hell began eating into the plantâ€™s concrete foundations.</p>
<p>The world looked on <mark class="label primary">aghast</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>. In Shanghai and San Francisco <mark class="label primary">iodine</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> tablets and iodised salt jumped offÂ the shelves as people looked for <mark class="label primary">prophylaxis</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> of which they had no need. In Germany the chancellor, Angela Merkel, who had long stood with business leaders against the countryâ€™s powerful anti-nuclear movement, ordered its reactors phased out. In China the worldâ€™s largest new nuclear-plant programme was put on hold. Talk of a â€œnuclear <mark class="label primary">renaissance</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>â€ to fiÂght climate change fell silent.</p>
<div class="note info"><p><strong>phase out</strong>ï¼šæ·˜æ±°</p>
<p><strong>put on hold</strong>ï¼šæš‚åœ</p>
</div>
<p>The reaction, though understandable, was wrong. Nuclear power has a lot of drawbacks. Its large, slowly built plants are expensive both in absolute terms and in terms of the electricity they produce. Its very small but real risk of catastrophic failure requires a high level of regulation, and it has a disturbing history of regulatory capture, amply demonstrated in Japan. It produces extremely long-lived and toxic waste. And it is associated with the proliferation of nuclear weapons. Most of the countries outside Europe that use nuclear power have some history of attempting to develop a bomb. All these factors contribute to an <mark class="label primary">unease</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> with the technology felt, to greater or lesser extent, by people all around the world.</p>
<p>Against all that, though, two things must be remembered. One is that well-regulated nuclear power is safe. With the terrible Soviet-era exception of Chernobyl, nuclear disasters come without large death <mark class="label primary">tolls</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>. It was the tsunami, not radiation, that claimed nearly all those lives in Fukushima. The other is that the climate is in crisis, and nuclear plants can supply some of the vast amounts of emissions-free electricity the world needs if it is to cope. Solar and wind power are now much cheaper, but they are <mark class="label primary">intermittent</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup>. Providing a reliable grid is a lot easier if some of its generating capacity can be assumed to be a vailable all the time. Nuclear provides such capacity with no ongoing emissions, and it is doing so safely and at scale around the world.</p>
<div class="note info"><p><strong>at scale</strong>ï¼šå¤§è§„æ¨¡</p>
</div>
<p>Despite this, safe and productive nuclear plants are being closed across the rich world. Those closures and the retirement of older sites mean that advanced economies could lose two-thirds of their nuclear capacity by 2040, according to the International Energy Agency. If new fossil-fuel infrastructure fills the gap, it will last for decades. If renewables do so, the opportunity cost will be measured in gigatonnes of carbon. Renewables replacing nuclear capacity would almost always be better deployed to replace fossil-fuel capacity.</p>
<p>Sometimes the closure of nuclear plants is largely a matter of economics. In places where emitting carbon dioxide comes with no price, such as America, the benefits of being emissions-free are hidden from the market. That hurts nuclear, and it should be rectified. When closure is political, the <mark class="label primary">onus</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> is on Green politicians, in particular, to change their tune. To <mark class="label primary">hasten</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> the decline of nuclear power is <mark class="label primary">wilfully</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup> to <mark class="label primary">hobble</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> the world in the greatest environmental struggle of all.</p>
<p>The argument for keeping existing nuclear plants open has been strengthened, in some places, by one of the responses to Fukushima: greater independence for nuclear regulators. Britain granted new freedom to its regulator after 2011. So did Japan. Though grander hopes for reform after the tsunami bore little fruit, Japan did largely take the regulatorsâ€™ hand from the power companiesâ€™ glove. Its new supervisor has made reopening <mark class="label primary">mothballed</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> nuclear power plants harder than the government would like, but that is as it should be. In Japan more than anywhere, nuclear needs to earn back trust to be useful.</p>
<p>This points to nuclearâ€™s greatest weakness. In democracies it is expensive, owing to regulation and public antipathy, which makes new nuclear power a hard sell. The technology is thus increasingly the preserve of <mark class="label primary">autocracies</mark><sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup>â€”precisely the systems where good regulation is least likely. Having paused after Fukushima, Chinaâ€™s nuclear plans accelerated as part of an effort to reduce reliance on coal. China produced four times as much nuclear energy in 2019 as it did in 2011; it has 16 reactors under construction and another 39 planned. Countries wanting new nuclear plants now look to China and Russia as suppliers.</p>
<p>There is a strong case for democracies seeking to replace ageing nuclear plants with non-intermittent<br>
equivalents to join the importers. If Chinese reactors are designed in the knowledge that they will have to meet with the approval of independent regulators the world will be a safer place. At the same time, in boosting energy R&amp;D to tackle the climate crisis, Western governments should be sure to give nuclear its fair share. There are real attractions to some new approaches, notably smaller reactors with lower unit costs: in <mark class="label primary">platoons</mark><sup class="footnote-ref"><a href="#fn18" id="fnref18">[18]</a></sup> they can replace old plants; singly they can add incremental capacity where needed. They might perhaps be used to <mark class="label primary">retrofit</mark><sup class="footnote-ref"><a href="#fn19" id="fnref19">[19]</a></sup> old fossil-fuel plants.</p>
<p><strong>Itâ€™s critical</strong></p>
<p>Nuclear power has drawbacks the size of a tsunami. But with Chinese plants being built today that will not be <mark class="label primary">decommissioned</mark><sup class="footnote-ref"><a href="#fn20" id="fnref20">[20]</a></sup> until the 22nd century, it cannot simply be wished away. What is more, it has a vital role to play in the fight for a stable climate. The lesson of Fukushima is not to <mark class="label primary">eschew</mark><sup class="footnote-ref"><a href="#fn21" id="fnref21">[21]</a></sup> nuclear power, it is to use it wisely.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [tsuËˆnÉ‘mi] æµ·å•¸ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [â€˜tÉœr.mÉ”Éªl] åŠ¨ä¹±ï¼ŒåŠ¨è¡ <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [Éªnâ€™su] æ¥ç€å‘ç”Ÿï¼Œå› è€Œäº§ç”Ÿï¼Œæ¥è¸µè€Œæ¥ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ ['pÊŒd(É™)l] æ°´æ´¼ï¼Œæ³¥æ½­ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [É™â€™É¡Ã¦st] æƒŠéª‡çš„ï¼ŒåƒæƒŠçš„ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [â€˜aÉªÉ™.daÉªn] ç¢˜ï¼Œå«ç¢˜ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [.prÉ‘fÉ™â€™lÃ¦ksÉªs] é¢„é˜² <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [rÉªâ€™neÉªsÉ™ns] æ–‡è‰ºå¤å…´ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [ÊŒnâ€™iz] ä¸å®‰ï¼Œå¿§è™‘ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ [toÊŠl] ä¼¤äº¡äººæ•° <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [.ÉªntÉ™râ€™mÉªt(É™)nt] æ–­æ–­ç»­ç»­çš„ï¼Œé—´æ­‡æ€§çš„ <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [â€˜oÊŠnÉ™s] è´£ä»»ï¼Œä¹‰åŠ¡ <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ ['heÉªs(É™)n] ä¿ƒè¿›ï¼Œä½¿åŠ å¿« <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [â€˜wÉªlfÉ™l] æ•…æ„çš„ï¼Œæˆå¿ƒçš„ <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ ['hÉ‘b(É™)l] è¹’è·šï¼Œè·›è¡Œï¼›é˜»ç¢ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [â€˜mÉ”Î¸.bÉ”l] åå¤‡çš„ï¼Œé—²ç½®çš„ <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn17" class="footnote-item"><p>ç¾ [É”â€™tÉ‘krÉ™si] ç‹¬è£æ”¿æ²»ï¼Œä¸“åˆ¶å›½å®¶ <a href="#fnref17" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn18" class="footnote-item"><p>ç¾ [plÉ™â€™tun] æ’ <a href="#fnref18" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn19" class="footnote-item"><p>ç¾ [ËˆrÉ›troÊŠËŒfit] æ”¹è¿›ï¼Œæ›´æ–° <a href="#fnref19" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn20" class="footnote-item"><p>ç¾ [.dikÉ™â€™mÉªÊƒ(É™)n] æ­£å¼åœæ­¢ä½¿ç”¨ï¼Œé€€å½¹ <a href="#fnref20" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn21" class="footnote-item"><p>ç¾ [esâ€™tÊƒu] é¿å…ï¼Œæˆ’ç» <a href="#fnref21" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>Leaders</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Leaders</tag>
      </tags>
  </entry>
  <entry>
    <title>Scraping the bones</title>
    <url>/archives/6d0cb3b7.html</url>
    <content><![CDATA[<center><b>Chinaâ€™s law-enforcement agencies are undergoing their biggest purge in more
than two decades. The aim is to root out the corrupt and politically disloyal</b></center>
<p>For many members of Chinaâ€™s 3m-strong domestic-security forces, these must be worrying times. On February 27th the Communist Party declared the start of a long-expected purge of their ranks. It will involve, say officials, â€œturning the knife-blade inwardâ€ to <mark class="label primary">gouge</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> out those <mark class="label primary">deemed</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> corrupt or insufficiently loyal to the party and its leader, Xi Jinping. More than eight years into Mr Xiâ€™s iron rule, the party appears to wonder whether a vital <mark class="label primary">bulwark</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> of its power is entirely trustworthy.</p>
<span id="more"></span>
<p>State-controlled media have described it as the biggest such campaign since the late 1990s within the domestic-security system, which includes the police, the secret police, the judiciary and prisons. It is due to last for about a year. The aim is to ensure that these agencies are â€œabsolutely loyal, absolutely pure and absolutely reliableâ€. Officials say the campaign will be like the â€œYanâ€™an Rectificationâ€ of the early 1940s. That was when Maoâ€”then the leader of a communist <mark class="label primary">insurgency</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>â€”staged a<br>
sweeping and brutal purge of the partyâ€™s ranks to consolidate his control. Such language suggests that many heads will roll as the party attempts to clear the â€œdense <mark class="label primary">miasma</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>â€ surrounding the security apparatus, cure it of â€œ<mark class="label primary">chronic</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> illnessâ€ and ensure it remains â€œsurnamed Partyâ€ (meaning as loyal to the party as if to a family member).</p>
<p>It is remarkable that such a campaign is deemed necessary. After he took over as Chinaâ€™s leader in 2012 Mr Xi launched the countryâ€™s toughest battle against corruption in decades. Hundreds of thousands of officials were punished, including powerful people with security backgrounds. One of them was Zhou Yongkang, a former member of the Politburo Standing Committee. Before Mr Xi assumed power, Mr Zhou had overseen the entire law-enforcement apparatus. In 2015 he was sentenced to life in prisonâ€”<mark class="label primary">ostensibly</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> for graft and leaking state secrets. Officials later allegedâ€”without giving detailsâ€”that he had engaged in â€œpolitical plottingâ€, too. It is widely believed that he was an opponent of Mr Xi. But on February 3rd party investigators said the police had failed to eliminate Mr Zhouâ€™s â€œpernicious influenceâ€ within the force and had not followed the party line â€œsatisfactorily enoughâ€.</p>
<div class="note info"><p><strong>Politburo Standing Committee</strong> ï¼šæ”¿æ²»å±€å¸¸å§”</p>
</div>
<p>Several hig-hranking security officials have been <mark class="label primary">snared</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> by the partyâ€™s anti-corruption agency in the past few months. The most <mark class="label primary">prominent</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> is Gong Daoan, then Shanghaiâ€™s police chief and one of the cityâ€™s deputy mayors. Last August he became the third policeman with a rank equivalent to that of a vice-minister to be placed under investigation since the start of 2020. The following month Mr Gong was stripped of his posts. On March 1st the government announced that he had been arrested and his case referred to prosecutors.</p>
<p>The charges against Mr Gong include abuse of his positions to promote his and othersâ€™ business interests, corruption related to the approval of appointments, misuse of his official car and frequent attendance of banquets that raised questions about his <mark class="label primary">impartiality</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>. But Mr Gongâ€™s alleged political offences are listed first: forming factions within the party and â€œcompletely lacking the four awarenessesâ€, ie, of the need for loyalty to the party and to Mr Xi, and for <mark class="label primary">compliance</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> with their orders and total <mark class="label primary">adherence</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> to the partyâ€™s line. Such accusations will probably be levelled at more police chiefs during the upcoming Chinaâ€™s law-enforcement agencies are undergoing their biggest purge in more than two decades. The aim is to root out the corrupt and politically disloyal purge. The loyalty of the security agencies â€œdirectly affects the partyâ€™s position at the <mark class="label primary">helm</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> of state and the continuance of political stabilityâ€, said an official report on a meeting of party bosses that kicked offÂ the nationwide campaign.</p>
<p>Its launch was <mark class="label primary">heralded</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup> in July with trial runs in a handful of local police forces, courts and prosecutorsâ€™ offices, as well as in two prisons and one local state-security bureau (home to the <mark class="label primary">dissident</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> and spy-hunting secret police). In charge of this experimental phase was Chen Yixin, a senior security official who appears to be a trouble-shooter for Mr Xiâ€”in February last year, in the early days of the covid-19 pandemic, he was sent to Wuhan to help <mark class="label primary">supervise</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> efforts to crush and contain the central cityâ€™s massive outbreak of the disease. Mr Chen said â€œeducation and rectifiÂcationâ€ of the security forces was a task of â€œurgency and extreme importanceâ€. He described the campaign as â€œscraping the bones to remove the poison, and draining away the <mark class="label primary">filth</mark><sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup> to bring in fresh waterâ€. Police at the time were reaching the end of a three-year campaign against criminal gangs and their â€œprotective umbrellasâ€ within the government. That effort resulted in the smashing of more than 14,700 criminal groups. But apparently it did not succeed in purifying the police.</p>
<p>Assuming the campaign will follow the pattern of last yearâ€™s experiments, participants can expect to spend a month studying the kind of behaviour that is expected of them. They will then perform â€œself-examinationâ€ and be required to admit to any wrong-doing. These <mark class="label primary">confessions</mark><sup class="footnote-ref"><a href="#fn18" id="fnref18">[18]</a></sup> will be compared with other submissions, including complaints from members of the public. High-level teams will be dispatched from Beijing to ensure the job is done properly. Among the 16,000 people who were involved in the trial phase, more than 2,200 were <mark class="label primary">disciplined</mark><sup class="footnote-ref"><a href="#fn19" id="fnref19">[19]</a></sup>, including 39 who were formally charged. If punishments are meted out at the same rate nationally, then the â€œoverall <mark class="label primary">reckoning</mark><sup class="footnote-ref"><a href="#fn20" id="fnref20">[20]</a></sup>â€, as one newspaper described the purge, may result in thousands being jailed and hundreds of thousands punished in other ways.</p>
<p>The campaign may benefit Mr Xi. Late next year he will <mark class="label primary">preside</mark><sup class="footnote-ref"><a href="#fn21" id="fnref21">[21]</a></sup> over a five-yearly party congress, which will mark a critical juncture of his leadership. Normally he would be expected to step down at this event, having served as general secretary for a decade. But he shows no intention of doing so. There have been few obvious signs of opposition to granting him another five-year term. The contrast between Chinaâ€™s successful control of the coronavirus and the Westâ€™s <mark class="label primary">fumbling</mark><sup class="footnote-ref"><a href="#fn22" id="fnref22">[22]</a></sup> response may have further strengthened his hand. But by tightening his grip on the security forces he can be even more certain that no one will dare to oppose him.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [É¡aÊŠdÊ’] å‡¿ï¼›æ•²ç«¹æ ï¼Œæ¼«å¤©è¦ä»· <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>è‹± [diËm] è®¤ä¸ºï¼Œç›¸ä¿¡ <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [â€˜bÊŠlwÉ™rk] å ¡å’ï¼Œå£å’ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [Éªnâ€™sÉœrdÊ’É™nsi] å›ä¹±ï¼Œé€ å <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [miâ€™Ã¦zmÉ™] ç˜´æ°”ï¼Œæ±¡æµŠçš„ç©ºæ°” <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [â€˜krÉ‘nÉªk] é•¿æœŸçš„ï¼Œæ…¢æ€§çš„ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [É‘â€™stensÉ™bli] è¡¨é¢ä¸Š <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [sner] åœˆå¥—ï¼Œé™·é˜±ï¼›è®¾é™·é˜±æ•æ‰ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [â€˜prÉ‘mÉªnÉ™nt] è‘—åçš„ï¼Œæ°å‡ºçš„ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ [ ËŒÉªmpÉ‘rÊƒÉªËˆÃ¦lÉ™tÉª] å…¬å¹³ï¼Œå…¬æ­£ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [kÉ™mâ€™plaÉªÉ™ns] éµä»ï¼Œæœä» <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [É™dâ€™hÉªrÉ™ns] éµå®ˆï¼ŒåšæŒ <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [helm] æŒèˆµï¼ŒæŒæ¡ <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [â€˜herÉ™ld] é€šå‘Š <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [â€˜dÉªsÉªdÉ™nt] æŒä¸åŒæ”¿è§è€… <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [â€˜supÉ™r.vaÉªz] ç›‘ç£ï¼Œä¸»ç®¡ï¼ŒæŒ‡å¯¼ <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn17" class="footnote-item"><p>ç¾ [fÉªlÎ¸] æ±¡ç§½ï¼Œæ±¡å¢ï¼›ä¸‹æµè¨€è¾ï¼›æ·«ç§½ä¹¦åˆŠ <a href="#fnref17" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn18" class="footnote-item"><p>ç¾ [kÉ™nâ€™feÊƒ(É™)n] å¦ç™½ï¼Œè®¤ç½ª <a href="#fnref18" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn19" class="footnote-item"><p>ç¾ [â€˜dÉªsÉ™plÉªn] çºªå¾‹ï¼›å¤„ç½š <a href="#fnref19" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn20" class="footnote-item"><p>ç¾ [â€˜rekÉ™n] ä¼°è®¡ï¼Œä¼°ç®— <a href="#fnref20" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn21" class="footnote-item"><p>ç¾ [.priâ€™zaÉªd] ä¸»æŒï¼ˆä¼šè®®ã€ä»ªå¼ç­‰ï¼‰ï¼›æ‹…ä»»ï¼ˆä¼šè®®ï¼‰ä¸»å¸­ <a href="#fnref21" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn22" class="footnote-item"><p>ç¾ ['fÊŒmb(É™)l] æ‘¸ç´¢ï¼Œç¬¨æ‹™çš„ <a href="#fnref22" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>China</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>China</tag>
      </tags>
  </entry>
  <entry>
    <title>The law kicks in</title>
    <url>/archives/40ddc300.html</url>
    <content><![CDATA[<center><b>The territory will soon find out how its
new security law works in court</b></center>
<p>Since china imposed a <mark class="label primary">draconian</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> security law on Hong Kong last year, protests in the cityâ€”already <mark class="label primary">dampened</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> by pandemic-related controlsâ€”have been rare. But on March 1st hundreds of people gathered outside a court to demonstrate against the largest case so far related to the security bill. They held banners calling for the release of â€œpolitical prisonersâ€ and chanted slogans that were popular during the unrest that <mark class="label primary">engulfed</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> the territory in 2019. Students at a primary school nearby stood outside their classrooms, shouting in solidarity. It was a rare act of defiance in a city that, to many residents, feels crushed.</p>
<span id="more"></span>
<p>A day earlier, 47 people had been charged for alleged <mark class="label primary">misdeeds</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup> as part of the case. They included some of Hong Kongâ€™s best-known pro-democracy activists, such as Leung Kwokhung, a <mark class="label primary">veteran</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> campaigner commonly known as â€œLong Hairâ€; Lester Shum, a politician; Benny Tai, an academic, and Joshua Wong, whose then-teenage face became <mark class="label primary">emblematic</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> of the â€œUmbrella Movementâ€ of 2014 (he is already in prison for a protest-related offÂence). They have been accused of crimes such as conspiracy to commit <mark class="label primary">subversion</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> by plotting to overthrow Hong Kongâ€™s government.</p>
<p>The case relates to an informal primary ballot that was held last year to select pro-democracy<br>
candidates for elections to the Legislative Council. This sensible-sounding effort was seen by the government as an attempt to gain control of the council and paralyse its work. (The elections were<br>
due to be held in September but were postponed for a year, <mark class="label primary">purportedly</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> because of the pandemic.) If convicted, the defendants face sentences of up to life in prison.</p>
<p>The proceedings that began on March 1st relate to applications for bailâ€”the trial itself may not begin for several more weeks. Under the security law, there is a presumption that bail will be denied, so even this stage has involved <mark class="label primary">protracted</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> debate in court and a <mark class="label primary">gruelling</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup> <mark class="label primary">ordeal</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup> for the defendants. They have had to endure sessions lasting many hours that have eaten into normal times for meals and sleep. The physical toll has been evidentâ€”several of them have received hospital treatment. The prosecution argues that defendants could pose a threat to national security if given bail. Soon after The Economist went to press, the court was expected to <mark class="label primary">rule</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> on whether to <mark class="label primary">remand</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> them in <mark class="label primary">custody</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup>.</p>
<p>No national-security trial has yet been concluded. So this one will be watched for signs of how the new lawâ€”which has the <mark class="label primary">hallmarks</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> of Chinese mainland-style legislation, with its vaguely defined political termsâ€”works in a judicial system steeped in British legal tradition. Dominic Raab, Britainâ€™s foreign minister, has described the case as â€œdeeply disturbingâ€. America and the European Union have called for the release of the 47 activists. On March 2nd Hong Kongâ€™s Department of Justice said that prosecutorsâ€™ decisions had been made â€œwithout political consider ationsâ€ and no one should interfere in them. But a few days before the 47 were charged, Xia Baolong, a central-government official who oversees Hong Kong affairs, had said that â€œanti-China elementsâ€ should be â€œseverely punished under the lawâ€. He had named two members of the group: Mr Wong and Mr Tai. The Communist Party may be an exception to Hong Kongâ€™s rule.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [drÉ™â€™koÊŠniÉ™n] ä¸¥é…·çš„ï¼Œæ®‹å¿çš„ï¼Œè‹›åˆ»çš„ <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [â€˜dÃ¦mpÉ™n] æŠ‘åˆ¶ <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [Éªnâ€™É¡ÊŒlf] æŠŠâ€¦å·å…¥æ—‹æ¶¡ï¼›åæ²¡ <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [mÉªsâ€™did] ç½ªè¡Œ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ ['vet(É™)rÉ™n] è€å…µï¼Œé€€ä¼å†›äººï¼›å¯Œæœ‰ç»éªŒçš„ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [.emblÉ™â€™mÃ¦tÉªk] æ ‡å¿—çš„ï¼Œè±¡å¾æ€§çš„ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [sÉ™bâ€™vÉœrÊ’(É™)n] é¢ è¦†ï¼Œç ´å <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>æ®ç§° <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ [prÉ™ËˆtrÃ¦ktÉ™d] æ‹–æ²“çš„ï¼Œæ—·æ—¥æŒä¹…çš„ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>ç¾ ['É¡ru(É™)lÉªÅ‹] ä½¿äººç­‹ç–²åŠ›å°½çš„ï¼›æŠ˜ç£¨äººçš„ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [É”râ€™dil] æŠ˜ç£¨ï¼Œç…ç†¬ <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ [rul] ç»Ÿæ²»ï¼›æ§åˆ¶ï¼›æ”¯é…ï¼›è£å®š <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [rÉªâ€™mÃ¦nd] è¿˜æŠ¼(è¢«å‘Šã€å«Œç–‘çŠ¯) <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [ËˆkÊŒstÉ™di] æ‹˜ç•™ï¼Œç›‘ç¦ <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ [â€˜hÉ”l.mÉ‘rk] ç‰¹ç‚¹ï¼Œç‰¹å¾ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>China</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>China</tag>
      </tags>
  </entry>
  <entry>
    <title>Racing ahead</title>
    <url>/archives/5ee67121.html</url>
    <content><![CDATA[<center><b>One firm. One year. One billion shots or more. Can Indiaâ€™s Serum Institute do it?</b></center>
<p>On march 5th 2020 Mumbaiâ€™s horse-racing season <mark class="label primary">culminated</mark><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> with the Poonawalla Breedersâ€™ Multimillion, a day-long <mark class="label primary">extravaganza</mark><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> dominated by Indiaâ€™s first family of the sport, the Poonawallas. <mark class="label primary">Triumphs</mark><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup> at the track were accompanied by news reports on the Bollywood life-styles of Adar Poonawalla and his wife, Natasha, whom Elle magazine described as â€œIndiaâ€™s first lady of <mark class="label primary">fabulousness</mark><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>â€. Only <mark class="label primary">cursory</mark><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup> attention spilled over to the coupleâ€™s day job running Serum Institute of India, the press-shy vaccine-maker at the root of the family fortune.</p>
<span id="more"></span>
<div class="note info"><p><strong>Mumbai</strong>ï¼šå­Ÿä¹°</p>
</div>
<p>A year on it is the company, not its <mark class="label primary">flamboyant</mark><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> owners, that is making headlines. As the covid-19 vaccination drive encounters production <mark class="label primary">glitches</mark><sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup> in Europe, hits distribution <mark class="label primary">snags</mark><sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup> in America and faces a geopolitical <mark class="label primary">scramble</mark><sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup> for supply everywhere, Serum Institute has emerged as the one firm apparently able to ramp up production fast and export the doses without <mark class="label primary">courting</mark><sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup> <mark class="label primary">controversy</mark><sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup>. By the end of the year, Mr Poonawalla says, it will add 1.5bn covid-19 shots to 1.3bn-1.5bn doses against diseases from <mark class="label primary">measles</mark><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup> to <mark class="label primary">tuberculosis</mark><sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup> that it already produces annually. On February 23rd it dispatched the first mass shipment, of 70m shots of the Oxford-AstraZeneca vaccine, to India and two dozen other poor countries in the COVAX vaccine-sharing programme. On March 1st Canada said it will procure 500,000 doses from the company. The relatively small family concern, which entered last year with annual revenues of $735m and a workforce of 6,000, is becoming mission-critical to the global fight against the coronavirus.</p>
<div class="note info"><p><strong>ramp up</strong>ï¼šå¢åŠ ï¼Œæé«˜</p>
<p><strong>Oxford-AstraZeneca</strong>ï¼šç‰›æ´¥é˜¿æ–¯åˆ©åº·</p>
</div>
<p>Mr Poonawallaâ€™s plans are ambitious, to put it <mark class="label primary">mildly</mark><sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup>. He wants to raise monthly production of the Oxford vaccine from the current 60m-70m to 100m by April. That month the company will start churning out 40m-50m of a shot developed by Novavax, an American biotechnology firm, to build up a â€œlarge stockâ€ as it undergoes accelerated review by a number of global regulators. By late summer Serum Institute expects to be making another vaccine, by SpyBiotech, a British startup. In early 2022 it hopes to be producing a one-dose <mark class="label primary">nasal</mark><sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup> vaccine being developed by Codagenix, another American biotech firm.</p>
<div class="note info"><p><strong>churning out</strong>ï¼šå¤§é‡ç”Ÿäº§</p>
</div>
<p>Mr Poonawalla estimates that until rivalsâ€™ new capacity comes online in the autumn, his companyâ€™s output will account for perhaps 40-50% of the worldâ€™s supply. Unlike Pfizer, an American drug giant<br>
which recently upped its production goal from 1.3bn to 2bn doses this year, Serum Instituteâ€™s shots are cheap and do not need to be stored at ultra-low temperatures. They will <mark class="label primary">inoculate</mark><sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> swathes of the poor world.</p>
<div class="note info"><p><strong>Pfizer</strong>ï¼šè¾‰ç‘</p>
</div>
<p>Some of the factors behind the companyâ€™s rise to prominence, like the pandemic and scientistsâ€™ rapid response to it, have been beyond its control. But Serum Institute has also placed bold bets that run counter to the traditional process of making vaccines, in which investments in capacity and distribution follow years of research, then more years of clinical trials for safety and efficacy. A brief conversation last April, between Mr Poonawalla and his father Cyrus, Serum Instituteâ€™s founder, resulted in a decision to start producing the Oxford vaccine before any clinical trials had begun.</p>
<p>It is the latest daring coup by the Poonawallas. In the 1960s Cyrus turned his horse-breeding business into one that used retired steeds as living vessels to create anti-body serum for treatment of snake bites, tetanus and other scourges. Forty years later his son, who has been chief executive since 2011, has added 165 countries as customers (often while courting Natasha on holidays). International sales now account for 70% of the firmâ€™s total. In December Serum Institute released the first vaccine to be fully developed in India, against a variant of pneumonia which kills 68,000 Indian children a year.</p>
<p>The companyâ€™s initial investment of $80m in capacity to produce the untested Oxford shot came from its billionaire ownersâ€™ own pocketâ€”a tidy sum next to the previous yearâ€™s $46m in capital expenditure. Since then Serum Institute has received a further $800m: $270m from the Poonawallas, $300m from the Bill &amp; Melinda Gates Foundation, the worldâ€™ s biggest charity, and the rest from prepayments by governments, including those of Bangladesh and Morocco.</p>
<p>The privately held firm will not say how much of that money has already been deployed. But Mr Poonawalla says it has doubled production capacity. It could do this quickly, he adds, thanks to a strategy of installing â€œexcess capacity ahead of demandâ€. For decades it had been adding a new building each year; one that was ready to go shortly before the fateful chat between father and son was immediately repurposed for the covid-19 effort.</p>
<p>A longstanding<br>
collaboration with Oxford<br>
and Novavax as part of an effÂort to create<br>
a malaria vaccine allowed Serum Institute<br>
to secure their recipes early. Deep relationships<br>
with suppliers of everything<br>
from glass vials to expensive â€œbioreactorsâ€<br>
for the production of biological substances<br>
have helped smooth procurement. Serum<br>
Institute has hired 1,000 new employees ,<br>
increasing its workforce by a sixth. Another<br>
500 construction workers are putting up<br>
new buildings with higher production capacity<br>
to add to the 30 or so that the company<br>
has erected over the years.</p>
<p>At the current pac e, Mr P oonawalla<br>
thinks, it will take at least two years for the<br>
global supply of covid19<br>
jabs to meet demand.<br>
It could take less if the worldâ€™s regulators<br>
coordinated<br>
more closely for the<br>
duration of the crisis , he ventures . U ntil<br>
then Serum Institute expects to be selling<br>
the jabs more or less at cost, which me ans<br>
about $35<br>
a dose for the Oxford v accine.<br>
After that, margins will eventually rise .<br>
â€œThis situation will last for a long time and<br>
there will be future demand, â€ Mr P oonawalla<br>
predicts. Covid19<br>
looks certain to become<br>
endemic in many parts of the world,<br>
with annual v accination drives akin to<br>
those for inflÂuenza becoming the norm.<br>
His fiÂrmâ€™s output will peak at 600m700m<br>
doses a year for each of the four vaccines it<br>
is currently eyeing, he says.</p>
<p>The pandemic will le ave vaccinemaking<br>
more prominent than ever before , Mr<br>
Poonawalla believesâ€”and much more<br>
crowded. This will inject competition into<br>
what most drugmak ers consider a thankless<br>
volume business with consider able<br>
capital outlays . A fiÂre e arlier this ye ar at<br>
one new building sent a shudder down the<br>
spines of the worldâ€™s covidresponders<br>
until<br>
the company assured them that the accident,<br>
which affÂected a production line for a<br>
tuberculosis jab, will not hurt the pandemic<br>
effÂort. Although the bet on the Oxford<br>
vaccine has paid offÂ, and the one on Novavax<br>
looks likely to, Codagenix and SpyBiotech<br>
are not yet shooins.<br>
And vaccine nationalism<br>
could stymie exports from India<br>
or imports of ingredients and kit.</p>
<p>Mr Poonawalla nevertheless remains<br>
confiÂdent that his fiÂrm will maintain its<br>
leading position. In contrast to big pharma,<br>
which spends billions on marketing<br>
costly medicines, it sells its vaccines chiefly<br>
to national health authorities, which<br>
prize low prices and reliable supply above<br>
all. Those have always been Serum Instituteâ€™s<br>
strong suits. And the Indian companyâ€™s<br>
remarkable response to covid19<br>
has<br>
bought it more global goodwill than any<br>
advertising campaign could hope to.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>ç¾ [ËˆkÊŒlmÉªËŒneÉªtid] åˆ°è¾¾é¡¶ç‚¹ï¼Œé«˜æ½® <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p>ç¾ [Éªk.strÃ¦vÉ™â€™É¡Ã¦nzÉ™] é“ºå¼ åä¸½çš„å¨±ä¹è¡¨æ¼” <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p>ç¾ [â€˜traÉªÉ™mf] 1. æˆ˜èƒœï¼Œæ‰“è´¥ï¼›2. å·¨å¤§æˆåŠŸï¼Œé‡å¤§æˆå°±ï¼Œä¼Ÿå¤§èƒœåˆ© <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p>ç¾ [â€˜fÃ¦bjÉ™lÉ™s] éš¾ä»¥ç½®ä¿¡çš„ï¼Œç¥è¯èˆ¬çš„ <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p>ç¾ [â€˜kÉœrsÉ™ri] ç²—ç•¥çš„ï¼›ä»“ä¿ƒçš„ï¼Œè‰ç‡çš„ <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p>ç¾ [flÃ¦mâ€™bÉ”ÉªÉ™nt] ç‚«è€€çš„ï¼Œå–å¼„çš„ï¼›åä¸½çš„ï¼Œè‰³ä¸½çš„ <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p>ç¾ [É¡lÉªtÊƒ] å°æ•…éšœï¼Œå°æ¯›ç—… <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p>ç¾ [snÃ¦É¡] éšœç¢ <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p>ç¾ ['skrÃ¦mb(É™)l] äº‰å¤ºï¼ŒæŠ¢å ï¼›ï¼ˆè¿…é€Ÿè€ŒåƒåŠ›åœ°ï¼‰çˆ¬ <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p>è¿½æ±‚ï¼Œæ‹›æƒ¹ï¼ˆç¥¸äº‹ï¼‰ <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn11" class="footnote-item"><p>ç¾ [â€˜kÉ‘ntrÉ™.vÉœrsi] äº‰è®º <a href="#fnref11" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn12" class="footnote-item"><p>ç¾ ['miz(É™)lz] éº»ç–¹ <a href="#fnref12" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn13" class="footnote-item"><p>ç¾ [tÊŠ.bÉœrkjÉ™â€™loÊŠsÉªs] ç»“æ ¸ç—… <a href="#fnref13" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn14" class="footnote-item"><p>ç¾ [â€˜maÉªldli] è½»å¾®åœ°ï¼Œç¨å¾®åœ°ï¼›æ¸©å’Œåœ°ï¼Œå’Œå–„åœ° <a href="#fnref14" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn15" class="footnote-item"><p>ç¾ ['neÉªz(É™)l] é¼»å­çš„ <a href="#fnref15" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn16" class="footnote-item"><p>ç¾ [Éªâ€™nÉ‘kjÉ™.leÉªt] ï¼ˆä¸ºâ€¦ï¼‰æ¥ç§ç–«è‹— <a href="#fnref16" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>The Economist</category>
        <category>Business</category>
      </categories>
      <tags>
        <tag>The Economist</tag>
        <tag>ç»æµå­¦äºº</tag>
        <tag>Business</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo Tag Plugins çš„ä½¿ç”¨</title>
    <url>/archives/c9ea8104.html</url>
    <content><![CDATA[<p>Tag Plugin æ˜¯ä¸€ç§ä½¿ Hexo æ”¯æŒç‰¹æ®Šæ ·å¼å†…å®¹çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ— æ³•åœ¨æ ‡å‡† Markdown ä¸­æ˜¾ç¤ºå…·æœ‰è‡ªå®šä¹‰å°ºå¯¸çš„å›¾åƒã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡ç­¾æ’ä»¶æ¥è§£å†³å®ƒã€‚ Hexo æœ‰å¾ˆå¤šå¯ä»¥å¸®åŠ©ç”¨æˆ·çš„æ ‡ç­¾ã€‚ Hexo è¿˜å…·æœ‰ä¸»é¢˜æ¥å£ï¼Œä½¿ä¸»é¢˜èƒ½å¤Ÿåˆ›å»ºè‡ªå·±çš„æ ‡ç­¾ã€‚</p>
<span id="more"></span>
<h4 id="quote"><a class="markdownIt-Anchor" href="#quote"></a> Quote</h4>
<p>ç”¨æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% blockquote [author[, source]] [link] [source_link_title] %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å­ï¼š</p>
<p>æ²¡æœ‰å‚æ•°çš„æ™®é€š <code>blockquote</code>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% blockquote %&#125;</span><br><span class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque hendrerit lacus ut purus iaculis feugiat. Sed nec tempor elit, quis aliquam neque. Curabitur sed diam eget dolor fermentum semper at eu lorem.</span><br><span class="line">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure>
<blockquote><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque hendrerit lacus ut purus iaculis feugiat. Sed nec tempor elit, quis aliquam neque. Curabitur sed diam eget dolor fermentum semper at eu lorem.</p>
</blockquote>
<p>å¼•ç”¨ä¹¦ä¸Šçš„å¥å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% blockquote David Levithan, Wide Awake %&#125;</span><br><span class="line">Do not just seek happiness for yourself. Seek happiness for all. Through kindness. Through mercy.</span><br><span class="line">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure>
<blockquote><p>Do not just seek happiness for yourself. Seek happiness for all. Through kindness. Through mercy.</p>
<footer><strong>David Levithan</strong><cite>Wide Awake</cite></footer></blockquote>
<p>å¼•ç”¨ç½‘ç»œä¸Šçš„æ–‡ç« ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% blockquote Seth Godin http:&#x2F;&#x2F;sethgodin.typepad.com&#x2F;seths_blog&#x2F;2009&#x2F;07&#x2F;welcome-to-island-marketing.html Welcome to Island Marketing %&#125;</span><br><span class="line">Every interaction is both precious and an opportunity to delight.</span><br><span class="line">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure>
<blockquote><p>Every interaction is both precious and an opportunity to delight.</p>
<footer><strong>Seth Godin</strong><cite><a href="http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html">Welcome to Island Marketing</a></cite></footer></blockquote>
<p>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„ <code>quote</code> â€” <code>centered quote</code>ï¼Œç®€å†™æˆ <code>cq</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% cq %&#125; æ¢…èŠ±é¦™è‡ªè‹¦å¯’æ¥ &#123;% endcq %&#125;</span><br></pre></td></tr></table></figure>
<blockquote class="blockquote-center">
<p>æ¢…èŠ±é¦™è‡ªè‹¦å¯’æ¥</p>

</blockquote>
<h4 id="note"><a class="markdownIt-Anchor" href="#note"></a> Note</h4>
<p>ç”¨æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note [class] [no-icon] [summary] %&#125;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>[class]</code> : <em>å¯é€‰å‚æ•°.</em> å¯é€‰å€¼: default | primary | success | info | warning | danger.</li>
<li><code>[no-icon]</code> : <em>å¯é€‰å‚æ•°.</em> æ˜¯å¦è¦æç¤ºæ ‡å¿—.</li>
<li><code>[summary]</code> : <em>å¯é€‰å‚æ•°.</em> æç¤ºçš„æ‘˜è¦.</li>
</ul>
<p>æ‰€æœ‰å‚æ•°éƒ½æ˜¯å¯é€‰çš„ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note %&#125;</span><br><span class="line">#### No class style</span><br><span class="line">(without define class style)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note "><h5 id="no-parameter"><a class="markdownIt-Anchor" href="#no-parameter"></a> No parameter</h5>
<p>(without define class style)</p>
</div>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note default %&#125;</span><br><span class="line">#### Default</span><br><span class="line">Welcome to [Hexo!](https:&#x2F;&#x2F;hexo.io)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note default"><h5 id="default"><a class="markdownIt-Anchor" href="#default"></a> Default</h5>
<p>Welcome to <a href="https://hexo.io">Hexo!</a></p>
</div>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note primary %&#125;</span><br><span class="line">#### Primary</span><br><span class="line">**Welcome** to [Hexo!](https:&#x2F;&#x2F;hexo.io)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note primary"><h5 id="primary"><a class="markdownIt-Anchor" href="#primary"></a> Primary</h5>
<p><strong>Welcome</strong> to <a href="https://hexo.io">Hexo!</a></p>
</div>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note success %&#125;</span><br><span class="line">#### Success</span><br><span class="line">**Welcome** to [Hexo!](https:&#x2F;&#x2F;hexo.io)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note success"><h5 id="success"><a class="markdownIt-Anchor" href="#success"></a> Success</h5>
<p><strong>Welcome</strong> to <a href="https://hexo.io">Hexo!</a></p>
</div>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note info %&#125;</span><br><span class="line">#### Info</span><br><span class="line">**Welcome** to [Hexo!](https:&#x2F;&#x2F;hexo.io)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note info"><h5 id="info"><a class="markdownIt-Anchor" href="#info"></a> Info</h5>
<p><strong>Welcome</strong> to <a href="https://hexo.io">Hexo!</a></p>
</div>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note danger %&#125;</span><br><span class="line">#### Dange</span><br><span class="line">**Welcome** to [Hexo!](https:&#x2F;&#x2F;hexo.io)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note danger"><h5 id="danger"><a class="markdownIt-Anchor" href="#danger"></a> Danger</h5>
<p><strong>Welcome</strong> to <a href="https://hexo.io">Hexo!</a></p>
</div>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note info no-icon %&#125;</span><br><span class="line">#### No icon note</span><br><span class="line">Note **without** icon: &#96;note info no-icon&#96;</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note info no-icon"><h5 id="without-icon"><a class="markdownIt-Anchor" href="#without-icon"></a> Without icon</h5>
<p>Note <strong>without</strong> icon: <code>note info no-icon</code></p>
</div>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% note primary This is a summary %&#125;</span><br><span class="line">#### Details and summary</span><br><span class="line">Note with summary: &#96;note primary This is a summary&#96;</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<details class="note primary"><summary><p>This is a summary</p>
</summary>
<h5 id="with-summary"><a class="markdownIt-Anchor" href="#with-summary"></a> With Summary</h5>
<p>Note with summary: <code>note primary This is a summary</code></p>

</details>
<h4 id="label"><a class="markdownIt-Anchor" href="#label"></a> Label</h4>
<p>ç”¨æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% label [class]@text %&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><code>[class]</code> : <em>å¯é€‰å‚æ•°.</em> å¯é€‰å€¼: <code>default</code> | <code>primary</code> | <code>success</code> | <code>info</code> | <code>warning</code> | <code>danger</code>.</p>
<p>å¦‚æœæ²¡æœ‰æŒ‡å®šå‚æ•°ï¼Œä½¿ç”¨æµè§ˆå™¨çš„é»˜è®¤é£æ ¼.</p>
</li>
<li>
<p><code>text</code> : è¦æ ‡æ³¨çš„æ–‡æœ¬ï¼Œ<code>@text</code> å’Œ <code>[class]</code> ä¹‹é—´çš„ç©ºæ ¼å¯æœ‰å¯æ— .<br>
E.g. <code>success @text</code> å’Œ <code>success@text</code> æ˜¯ä¸€æ ·çš„.</p>
</li>
</ul>
<h5 id="default"><a class="markdownIt-Anchor" href="#default"></a> default</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% label default@default label %&#125;</span><br></pre></td></tr></table></figure>
<mark class="label default">default label</mark>
<h5 id="primary"><a class="markdownIt-Anchor" href="#primary"></a> Primary</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% label primary@primary label %&#125;</span><br></pre></td></tr></table></figure>
<mark class="label primary">primary label</mark>
<h5 id="success"><a class="markdownIt-Anchor" href="#success"></a> Success</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% label success@success label %&#125;</span><br></pre></td></tr></table></figure>
<mark class="label success">success label</mark>
<h5 id="info"><a class="markdownIt-Anchor" href="#info"></a> Info</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% label info@info label %&#125;</span><br></pre></td></tr></table></figure>
<mark class="label info">info label</mark>
<h5 id="warning"><a class="markdownIt-Anchor" href="#warning"></a> Warning</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% label warning@warning label %&#125;</span><br></pre></td></tr></table></figure>
<mark class="label warning">warning label</mark>
<h5 id="danger"><a class="markdownIt-Anchor" href="#danger"></a> Danger</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% label danger@danger label %&#125;</span><br></pre></td></tr></table></figure>
<mark class="label danger">danger label</mark>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;mark&gt;æ ‡å¿—&lt;&#x2F;mark&gt;</span><br></pre></td></tr></table></figure>
<p><mark>æ ‡å¿—</mark></p>
<h4 id="tabs"><a class="markdownIt-Anchor" href="#tabs"></a> Tabs</h4>
<p>ç”¨æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><code>Unique name</code> : æ ‡ç­¾å—çš„å”¯ä¸€åç§°.</p>
<p>åªéœ€ä¿è¯å½“å‰é¡µé¢å”¯ä¸€.</p>
</li>
<li>
<p><code>[index]</code> : <em>å¯é€‰å‚æ•°.</em> é»˜è®¤é€‰å®šçš„æ ‡ç­¾é¡¹.<br>
å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œç¬¬ä¸€ä¸ªæ ‡ç­¾å°†ä¼šè¢«é€‰å®š.<br>
å¦‚æœä¸º -1ï¼Œåˆ™æ²¡æœ‰é»˜è®¤çš„é€‰å®šæ ‡ç­¾.</p>
</li>
<li>
<p><code>[Tab caption]</code> : <em>å¯é€‰å‚æ•°.</em> å½“å‰æ ‡ç­¾çš„æ ‡é¢˜.<br>
å¦‚æœæ²¡æœ‰æŒ‡å®šæ ‡é¢˜ï¼Œå°†ç”¨æ ‡ç­¾å—åæ ¹æ ‡ç­¾çš„ç´¢å¼•ä½œä¸ºæ ‡é¢˜.<br>
å¦‚æœæ²¡æœ‰æŒ‡å®šæ ‡é¢˜ï¼Œä½†æ˜¯æŒ‡å®šäº† <code>@icon</code>ï¼Œåˆ™æ ‡é¢˜å¯ä»¥ä¸ºç©º.</p>
</li>
<li>
<p><code>[@icon]</code> : <em>å¯é€‰å‚æ•°.</em> Font Awesome icon name.</p>
</li>
</ul>
<p>ä¾‹å­ï¼š</p>
<h5 id="é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªæ ‡ç­¾"><a class="markdownIt-Anchor" href="#é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªæ ‡ç­¾"></a> é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªæ ‡ç­¾</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% tabs Unique name %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 1.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 2.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 3.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure>
<div class="tabs" id="unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#unique-name-1">Unique name 1</a></li><li class="tab"><a href="#unique-name-2">Unique name 2</a></li><li class="tab"><a href="#unique-name-3">Unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="unique-name-1"><p><strong>Tab 1.</strong></p></div><div class="tab-pane" id="unique-name-2"><p><strong>Tab 2.</strong></p></div><div class="tab-pane" id="unique-name-3"><p><strong>Tab 3.</strong></p></div></div></div>
<h5 id="æŒ‡å®šé€‰ä¸­ç¬¬ä¸‰ä¸ªæ ‡ç­¾"><a class="markdownIt-Anchor" href="#æŒ‡å®šé€‰ä¸­ç¬¬ä¸‰ä¸ªæ ‡ç­¾"></a> æŒ‡å®šé€‰ä¸­ç¬¬ä¸‰ä¸ªæ ‡ç­¾</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% tabs Unique name, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 1.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 2.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 3.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure>
<div class="tabs" id="unique-name"><ul class="nav-tabs"><li class="tab"><a href="#unique-name-1">Unique name 1</a></li><li class="tab"><a href="#unique-name-2">Unique name 2</a></li><li class="tab active"><a href="#unique-name-3">Unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane" id="unique-name-1"><p><strong>Tab 1.</strong></p></div><div class="tab-pane" id="unique-name-2"><p><strong>Tab 2.</strong></p></div><div class="tab-pane active" id="unique-name-3"><p><strong>Tab 3.</strong></p></div></div></div>
<h5 id="è‡ªå®šä¹‰æ ‡ç­¾é¡¹æ ‡é¢˜"><a class="markdownIt-Anchor" href="#è‡ªå®šä¹‰æ ‡ç­¾é¡¹æ ‡é¢˜"></a> è‡ªå®šä¹‰æ ‡ç­¾é¡¹æ ‡é¢˜</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% tabs Unique name %&#125;</span><br><span class="line">&lt;!-- tab Solution 1 --&gt;</span><br><span class="line">**Tab 1.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab Solution 2 --&gt;</span><br><span class="line">**Tab 2.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab Solution 3 --&gt;</span><br><span class="line">**Tab 3.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure>
<div class="tabs" id="unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#unique-name-1">Solution 1</a></li><li class="tab"><a href="#unique-name-2">Solution 2</a></li><li class="tab"><a href="#unique-name-3">Solution 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="unique-name-1"><p><strong>Tab 1.</strong></p></div><div class="tab-pane" id="unique-name-2"><p><strong>Tab 2.</strong></p></div><div class="tab-pane" id="unique-name-3"><p><strong>Tab 3.</strong></p></div></div></div>
<h5 id="åªå¸¦-icon-çš„æ ‡ç­¾"><a class="markdownIt-Anchor" href="#åªå¸¦-icon-çš„æ ‡ç­¾"></a> åªå¸¦ <code>icon</code> çš„æ ‡ç­¾</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% tabs Unique name %&#125;</span><br><span class="line">&lt;!-- tab @text-width --&gt;</span><br><span class="line">**Tab 1.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @font --&gt;</span><br><span class="line">**Tab 2.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @bold --&gt;</span><br><span class="line">**Tab 3.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure>
<div class="tabs" id="unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#unique-name-1"><i class="fa fa-text-width"></i></a></li><li class="tab"><a href="#unique-name-2"><i class="fa fa-font"></i></a></li><li class="tab"><a href="#unique-name-3"><i class="fa fa-bold"></i></a></li></ul><div class="tab-content"><div class="tab-pane active" id="unique-name-1"><p><strong>Tab 1.</strong></p></div><div class="tab-pane" id="unique-name-2"><p><strong>Tab 2.</strong></p></div><div class="tab-pane" id="unique-name-3"><p><strong>Tab 3.</strong></p></div></div></div>
<h5 id="æ ‡ç­¾æ°¸ä¹…é“¾æ¥"><a class="markdownIt-Anchor" href="#æ ‡ç­¾æ°¸ä¹…é“¾æ¥"></a> æ ‡ç­¾æ°¸ä¹…é“¾æ¥</h5>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Permalink for &gt; [Tab one](#tab-one).</span><br><span class="line">Permalink for &gt; [Tab one 1](#tab-one-1).</span><br><span class="line">Permalink for &gt; [Tab one 2](#tab-one-2).</span><br><span class="line">Permalink for &gt; [Tab one 3](#tab-one-3).</span><br><span class="line"></span><br><span class="line">Permalink for &gt; [Tab two](#tab-two).</span><br><span class="line">Permalink for &gt; [Tab two 1](#tab-two-1).</span><br><span class="line">Permalink for &gt; [Tab two 2](#tab-two-2).</span><br><span class="line">Permalink for &gt; [Tab two 3](#tab-two-3).</span><br><span class="line"></span><br><span class="line">&#123;% tabs Tab one %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 1.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 2.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 3.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% tabs Tab two %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 1.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 2.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line">**Tab 3.**</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure>
<p>Permalink for &gt; <a href="#tab-one">Tab one</a>.<br>
Permalink for &gt; <a href="#tab-one-1">Tab one 1</a>.<br>
Permalink for &gt; <a href="#tab-one-2">Tab one 2</a>.<br>
Permalink for &gt; <a href="#tab-one-3">Tab one 3</a>.</p>
<p>Permalink for &gt; <a href="#tab-two">Tab two</a>.<br>
Permalink for &gt; <a href="#tab-two-1">Tab two 1</a>.<br>
Permalink for &gt; <a href="#tab-two-2">Tab two 2</a>.<br>
Permalink for &gt; <a href="#tab-two-3">Tab two 3</a>.</p>
<div class="tabs" id="tab-one"><ul class="nav-tabs"><li class="tab active"><a href="#tab-one-1">Tab one 1</a></li><li class="tab"><a href="#tab-one-2">Tab one 2</a></li><li class="tab"><a href="#tab-one-3">Tab one 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-one-1"><p><strong>Tab 1.</strong></p></div><div class="tab-pane" id="tab-one-2"><p><strong>Tab 2.</strong></p></div><div class="tab-pane" id="tab-one-3"><p><strong>Tab 3.</strong></p></div></div></div>
<div class="tabs" id="tab-two"><ul class="nav-tabs"><li class="tab active"><a href="#tab-two-1">Tab two 1</a></li><li class="tab"><a href="#tab-two-2">Tab two 2</a></li><li class="tab"><a href="#tab-two-3">Tab two 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-two-1"><p><strong>Tab 1.</strong></p></div><div class="tab-pane" id="tab-two-2"><p><strong>Tab 2.</strong></p></div><div class="tab-pane" id="tab-two-3"><p><strong>Tab 3.</strong></p></div></div></div>
<h4 id="button"><a class="markdownIt-Anchor" href="#button"></a> Button</h4>
<p>ç”¨æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% button url, text, icon [class], [title] %&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>url</code> : ç»å¯¹æˆ–ç›¸å¯¹ URL</li>
<li><code>text</code> : æŒ‰é’®æ–‡å­—ï¼Œå¦‚æœæœªæŒ‡å®šå›¾æ ‡åˆ™ä¸ºå¿…é¡»</li>
<li><code>icon</code> : FontAwesome å›¾æ ‡åç§°ï¼ˆå¼€å¤´æ²¡æœ‰â€™fa-â€˜ï¼‰ã€‚å¦‚æœæœªæŒ‡å®šæ–‡æœ¬ï¼Œåˆ™ä¸ºå¿…éœ€</li>
<li><code>[class]</code> : FontAwesome ç±»ï¼š<code>fa-fw | fa-lg | fa-2x | fa-3x | fa-4x | fa-5X</code> ï¼Œå¯é€‰å‚æ•°ã€‚</li>
<li><code>[title]</code> : é¼ æ ‡æ‚¬åœæ—¶çš„å·¥å…·æç¤ºï¼Œå¯é€‰å‚æ•°ã€‚</li>
</ul>
<p>æ³¨æ„ï¼šæœ€å¥½æ·»åŠ  `` æ ‡ç­¾ï¼Œæµ‹è¯•æ—¶æ²¡åŠ  divï¼Œä¸‹é¢æ˜¾ç¤ºä¸å®Œå…¨ï¼Œè€Œä¸”åŠ ä¸Šæ›´åŠ ç¾è§‚ã€‚</p>
<div>
  <a class="btn" href="https://time_wait.gitee.io/" title="åšå®¢é¦–é¡µ"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>
</div>
<p>å…¶ä»–ä¸€äº›ä¾‹å­ï¼š</p>
<h5 id="åªæœ‰-text"><a class="markdownIt-Anchor" href="#åªæœ‰-text"></a> åªæœ‰ <code>text</code></h5>
<a class="btn" href="#">Text</a>
<h5 id="åªæœ‰-icon"><a class="markdownIt-Anchor" href="#åªæœ‰-icon"></a> åªæœ‰ <code>icon</code></h5>
<div><a class="btn" href="#"><i class="fa fa-home fa-5x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-4x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-3x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-2x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-lg"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home"></i></a></div>
<h5 id="æœ‰-text-å’Œ-title"><a class="markdownIt-Anchor" href="#æœ‰-text-å’Œ-title"></a> æœ‰ <code>text</code> å’Œ <code>title</code></h5>
<a class="btn" href="#" title="Title">Text & Title</a>
<h5 id="æœ‰-text-å’Œ-icon"><a class="markdownIt-Anchor" href="#æœ‰-text-å’Œ-icon"></a> æœ‰ <code>text</code> å’Œ <code>icon</code></h5>
<p>
  <a class="btn" href="#"><i class="fa fa-home"></i>Text & Icon</a>
</p>
<p>æœ€åï¼ŒæŒ‰é’® tag è¿˜å¯ä»¥åµŒå¥—åœ¨å…¶ä»– tag ä¸­ä½¿ç”¨ã€‚</p>
<h4 id="link-grid"><a class="markdownIt-Anchor" href="#link-grid"></a> Link Grid</h4>
<p>ç”¨æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% linkgrid [image] [delimiter] [comment] %&#125;&#123;% endlinkgrid %&#125;</span><br><span class="line">&lt;!-- Tag Alias --&gt;</span><br><span class="line">&#123;% lg [image] [delimiter] [comment] %&#125;&#123;% endlg %&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>[image]</code> : <em>Optional parameter.</em> Default image URL.</li>
<li><code>[delimiter]</code> : <em>Optional parameter.</em> If the optional delimiter parameter is given, it is interpreted as the delimiter of items in each line.</li>
<li><code>[comment]</code> : <em>Optional parameter.</em> If the optional comment parameter is given, it is interpreted as the symbol to comment out a line.</li>
</ul>
<div class="link-grid"><div class="link-grid-container">
<div class="link-grid-image" style="background-image: url(/images/apple-touch-icon-next.png);"></div>
<p>Theme NexT</p><p>Stay Simple. Stay NexT.</p>
<a href="https://theme-next.js.org/"></a>
</div></div>
<div class="link-grid"><div class="link-grid-container">
<div class="link-grid-image" style="background-image: url(/images/apple-touch-icon-next.png);"></div>
<p>Theme NexT</p><p>Stay Simple. Stay NexT.</p>
<a href="https://theme-next.js.org/"></a>
</div></div>]]></content>
      <categories>
        <category>Hexo&amp;NexT</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Tag Plugins</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/archives/4a17b156.html</url>
    <content><![CDATA[<p>Welcome<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<span id="more"></span>
<h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2>
<h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Test <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
  </entry>
  <entry>
    <title>åŸºæœ¬æ’åºç®—æ³•</title>
    <url>/archives/981a96f7.html</url>
    <content><![CDATA[<h3 id="æ¯”è¾ƒæ’åº"><a class="markdownIt-Anchor" href="#æ¯”è¾ƒæ’åº"></a> æ¯”è¾ƒæ’åº</h3>
<h4 id="å†’æ³¡æ’åº"><a class="markdownIt-Anchor" href="#å†’æ³¡æ’åº"></a> å†’æ³¡æ’åº</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] BubbleSort(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">int</span> tmp = arr[j];</span><br><span class="line">                arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">                arr[j + <span class="number">1</span>] = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h4 id="é€‰æ‹©æ’åº"><a class="markdownIt-Anchor" href="#é€‰æ‹©æ’åº"></a> é€‰æ‹©æ’åº</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] SelectionSort(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> index = i;</span><br><span class="line">        <span class="keyword">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; arr.length) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &lt; minVal) &#123;</span><br><span class="line">                index = j;</span><br><span class="line">            &#125;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">      	<span class="keyword">if</span> (index != i) &#123;</span><br><span class="line">          	<span class="keyword">int</span> tmp = arr[i];</span><br><span class="line">          	arr[i] = arr[index];</span><br><span class="line">        		arr[index] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ’å…¥æ’åº"><a class="markdownIt-Anchor" href="#æ’å…¥æ’åº"></a> æ’å…¥æ’åº</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] InsertSort(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> val = arr[i];</span><br><span class="line">        <span class="keyword">int</span> j = i - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &lt; val) <span class="keyword">break</span>;</span><br><span class="line">            arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[j + <span class="number">1</span>] = val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¸Œå°”æ’åº"><a class="markdownIt-Anchor" href="#å¸Œå°”æ’åº"></a> å¸Œå°”æ’åº</h4>
<p>å¸Œå°”æ’åºæ˜¯ä¸€ç§æ”¹è¿›çš„æ’å…¥æ’åºï¼Œä¹Ÿå«å¢é‡å‡å°æ’åºã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] ShellSort(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> step = arr.length / <span class="number">2</span>; step &gt; <span class="number">0</span>; step /= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="comment">// æ’å…¥æ’åºæ€æƒ³</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = step; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> val = arr[i];</span><br><span class="line">            <span class="keyword">int</span> j = i - step;</span><br><span class="line">            <span class="keyword">while</span> (j &gt;= step) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[j] &lt; val) <span class="keyword">break</span>;</span><br><span class="line">                arr[j + step] = arr[j];</span><br><span class="line">                j -= step;</span><br><span class="line">            &#125;</span><br><span class="line">            arr[j + step] = val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å½’å¹¶æ’åº"><a class="markdownIt-Anchor" href="#å½’å¹¶æ’åº"></a> å½’å¹¶æ’åº</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span>[] copy)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰¾åˆ°å¾…æ’åºæ•°ç»„çš„ä¸­é—´ä½ç½®ï¼Œå¯¹å·¦å³ä¸¤ä¸ªå­æ•°ç»„é€’å½’</span></span><br><span class="line">    <span class="keyword">int</span> mid = l + (r - l) / <span class="number">2</span>;</span><br><span class="line">    mergeSort(arr, l, mid, copy);</span><br><span class="line">    mergeSort(arr, mid + <span class="number">1</span>, r, copy);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€’å½’è¿”å›åï¼Œå·¦å³ä¸¤ä¸ªå­æ•°ç»„å·²ç»æœ‰åºï¼Œæ¥ç€åˆå¹¶ä¸¤ä¸ªæœ‰åºå­æ•°ç»„å³å¯</span></span><br><span class="line">    <span class="keyword">int</span> i = l;</span><br><span class="line">    <span class="keyword">int</span> j = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> k = l;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= r) &#123;</span><br><span class="line">        copy[k++] = arr[i] &lt;= arr[j] ? arr[i++] : arr[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= mid) &#123;</span><br><span class="line">        copy[k++] = arr[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j &lt;= r) &#123;</span><br><span class="line">        copy[k++] = arr[j++];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå¹¶å®Œæˆåï¼Œå°†å¤åˆ¶æ•°ç»„çš„æ•°æ®æ‹·è´å›åŸæ•°ç»„</span></span><br><span class="line">    k = l;</span><br><span class="line">    <span class="keyword">while</span> (k &lt;= r) &#123;</span><br><span class="line">        arr[k] = copy[k++];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å †æ’åº"><a class="markdownIt-Anchor" href="#å †æ’åº"></a> å †æ’åº</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç»´æŒæœ€å¤§å †çš„ç‰¹æ€§</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] heapify(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> heapSize, <span class="keyword">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">int</span> l = (i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> r = l + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> largest = i;</span><br><span class="line">    <span class="comment">// æ‰¾åˆ°å½“å‰èŠ‚ç‚¹åŠå…¶å·¦å³å­èŠ‚ç‚¹çš„æœ€å¤§å€¼çš„ä¸‹æ ‡</span></span><br><span class="line">    <span class="keyword">if</span> (l &lt;= heapSize &amp;&amp; arr[l] &gt; arr[largest]) largest = l;</span><br><span class="line">    <span class="keyword">if</span> (r &lt;= heapSize &amp;&amp; arr[r] &gt; arr[largest]) largest = r;</span><br><span class="line">    <span class="comment">// å¦‚æœå½“å‰èŠ‚ç‚¹çš„å€¼ä¸æ˜¯æœ€å¤§çš„ï¼Œäº¤æ¢ï¼Œå¹¶é€’å½’</span></span><br><span class="line">    <span class="keyword">if</span> (largest != i) &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = arr[i];</span><br><span class="line">        arr[i] = arr[largest];</span><br><span class="line">        arr[largest] = tmp;</span><br><span class="line">        heapify(arr, heapSize, largest);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å»ºå †</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] buildHeap(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length &gt;&gt; <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        heapify(arr, arr.length - <span class="number">1</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] HeapSort(<span class="keyword">int</span>[] arr) &#123;</span><br><span class="line">    <span class="comment">// å»ºå †</span></span><br><span class="line">    buildHeap(arr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å †é¡¶çš„æœ€å¤§å€¼æ¢åˆ°æ•°ç»„æœ€åçš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> val = arr[<span class="number">0</span>];</span><br><span class="line">        arr[<span class="number">0</span>] = arr[i];</span><br><span class="line">        arr[i] = val;</span><br><span class="line">        <span class="comment">// ç»´æŠ¤å †çš„æ€§è´¨</span></span><br><span class="line">        heapify(arr, i - <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¿«é€Ÿæ’åº"><a class="markdownIt-Anchor" href="#å¿«é€Ÿæ’åº"></a> å¿«é€Ÿæ’åº</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] quickSort(<span class="keyword">int</span>[] arr, <span class="keyword">int</span> l, <span class="keyword">int</span> r) &#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span> arr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> pivot = arr[r];  <span class="comment">// è¿™ä¸€æ­¥å¯ä»¥ä¼˜åŒ–ï¼Œå¯ä»¥éšæœºé€‰å–ä¸€ä¸ªæ•°ä½œä¸º pivot</span></span><br><span class="line">    <span class="keyword">int</span> index = l - <span class="number">1</span>;  <span class="comment">// æœ€åä¸€ä¸ªå°äº pivot å…ƒç´ çš„ä¸‹æ ‡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] &lt;= pivot) &#123;  <span class="comment">// æ¯æ‰¾åˆ°ä¸€ä¸ªå°äº pivot å…ƒç´ </span></span><br><span class="line">            index++;  <span class="comment">// index åŠ ä¸€ï¼Œäº¤æ¢å…ƒç´ çš„ä½ç½®</span></span><br><span class="line">            <span class="keyword">int</span> tmp = arr[index];</span><br><span class="line">            arr[index] = arr[i];</span><br><span class="line">            arr[i] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹å·¦å³ä¸¤ä¸ªå­æ•°ç»„é€’å½’æ“ä½œ</span></span><br><span class="line">    quickSort(arr, l, index - <span class="number">1</span>);</span><br><span class="line">    quickSort(arr,index + <span class="number">1</span>, r);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¯”è¾ƒæ’åºæ€»ç»“"><a class="markdownIt-Anchor" href="#æ¯”è¾ƒæ’åºæ€»ç»“"></a> æ¯”è¾ƒæ’åºæ€»ç»“</h4>
<table>
<thead>
<tr>
<th>æ’åºç®—æ³•</th>
<th style="text-align:center">æœ€å¥½æ—¶é—´å¤æ‚åº¦</th>
<th style="text-align:center">æœ€åæ—¶é—´å¤æ‚åº¦</th>
<th style="text-align:center">å¹³å‡æ—¶é—´å¤æ‚åº¦</th>
<th style="text-align:center">ç©ºé—´å¤æ‚åº¦</th>
<th style="text-align:center">æ˜¯å¦ç¨³å®š</th>
</tr>
</thead>
<tbody>
<tr>
<td>å†’æ³¡æ’åº</td>
<td style="text-align:center"><code>O(1)</code></td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(1)</code></td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td>é€‰æ‹©æ’åº</td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(1)</code></td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
<tr>
<td>æ’å…¥æ’åº</td>
<td style="text-align:center"><code>O(n)</code></td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(1)</code></td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td>å¸Œå°”æ’åº</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>O(1)</code></td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
<tr>
<td>å½’å¹¶æ’åº</td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"><code>O(n)</code></td>
<td style="text-align:center">ç¨³å®š</td>
</tr>
<tr>
<td>å †æ’åº</td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"><code>O(1)</code></td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
<tr>
<td>å¿«é€Ÿæ’åº</td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"><code>O(n^2)</code></td>
<td style="text-align:center"><code>O(nlogn)</code></td>
<td style="text-align:center"></td>
<td style="text-align:center">ä¸ç¨³å®š</td>
</tr>
</tbody>
</table>
<h3 id="éæ¯”è¾ƒæ’åº"><a class="markdownIt-Anchor" href="#éæ¯”è¾ƒæ’åº"></a> éæ¯”è¾ƒæ’åº</h3>
<h4 id="è®¡æ•°æ’åº"><a class="markdownIt-Anchor" href="#è®¡æ•°æ’åº"></a> è®¡æ•°æ’åº</h4>
<h4 id="åŸºæ•°æ’åº"><a class="markdownIt-Anchor" href="#åŸºæ•°æ’åº"></a> åŸºæ•°æ’åº</h4>
<h4 id="æ¡¶æ’åº"><a class="markdownIt-Anchor" href="#æ¡¶æ’åº"></a> æ¡¶æ’åº</h4>
<h4 id="éæ¯”è¾ƒæ’åºæ€»ç»“"><a class="markdownIt-Anchor" href="#éæ¯”è¾ƒæ’åºæ€»ç»“"></a> éæ¯”è¾ƒæ’åºæ€»ç»“</h4>
]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„&amp;ç®—æ³•</category>
        <category>æ’åº</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„&amp;ç®—æ³•</tag>
        <tag>æ’åº</tag>
        <tag>å¿«é€Ÿæ’åº</tag>
        <tag>å½’å¹¶æ’åº</tag>
        <tag>å †æ’åº</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°æ®åº“ç³»ç»ŸåŸç†</title>
    <url>/archives/351e2939.html</url>
    <content><![CDATA[<h4 id="äº‹åŠ¡"><a class="markdownIt-Anchor" href="#äº‹åŠ¡"></a> äº‹åŠ¡</h4>
<p>æ»¡è¶³ <code>ACID</code> ç‰¹æ€§çš„ä¸€ç»„æ“ä½œã€‚</p>
<h5 id="acid"><a class="markdownIt-Anchor" href="#acid"></a> <code>ACID</code></h5>
<ul>
<li>åŸå­æ€§ï¼ˆAtomicityï¼‰- äº‹åŠ¡çš„ä¸€ç»„æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¸å…¨éƒ¨å¤±è´¥å›æ»šã€‚å›æ»šå¯ä»¥æ ¹æ® <code>Undo log</code> æ¥å®ç°ã€‚</li>
<li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰- æ•°æ®åº“åœ¨äº‹åŠ¡æ‰§è¡Œå‰åéƒ½ä¿æŒä¸€è‡´æ€§çŠ¶æ€ã€‚</li>
<li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰- ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤ä»¥å‰ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚</li>
<li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰- ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œæ‰€åšçš„ä¿®æ”¹å°†ä¼šæ°¸è¿œä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚å¦‚æœç³»ç»Ÿå´©æºƒï¼Œå¯ä»¥æ ¹æ® <code>Redo log</code> æ¥æ¢å¤æ•°æ®ã€‚</li>
</ul>
<p><code>Undo log</code> è®°å½•çš„æ˜¯é€»è¾‘ä¿®æ”¹ï¼Œ<code>Redo log</code> è®°å½•çš„æ˜¯ç‰©ç†ä¿®æ”¹ã€‚</p>
<h4 id="å¹¶å‘ä¸€è‡´æ€§"><a class="markdownIt-Anchor" href="#å¹¶å‘ä¸€è‡´æ€§"></a> å¹¶å‘ä¸€è‡´æ€§</h4>
<p>åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œäº‹åŠ¡çš„éš”ç¦»æ€§å¾ˆéš¾ä¿è¯ï¼Œå› æ­¤ä¼šå‡ºç°å¾ˆå¤šå¹¶å‘ä¸€è‡´æ€§é—®é¢˜ã€‚</p>
<h5 id="ä¸¢å¤±ä¿®æ”¹"><a class="markdownIt-Anchor" href="#ä¸¢å¤±ä¿®æ”¹"></a> ä¸¢å¤±ä¿®æ”¹</h5>
<div class="note "><p>ä¸¢å¤±ä¿®æ”¹æŒ‡ä¸€ä¸ªäº‹åŠ¡çš„æ›´æ–°æ“ä½œè¢«å¦å¤–ä¸€ä¸ªäº‹åŠ¡çš„æ›´æ–°æ“ä½œè¦†ç›–ã€‚</p>
<p>ä¾‹å¦‚ï¼š<code>T1</code> å’Œ <code>T2</code> ä¸¤ä¸ªäº‹åŠ¡éƒ½å¯¹ä¸€ä¸ªæ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œ<code>T1</code> å…ˆä¿®æ”¹å¹¶æäº¤ç”Ÿæ•ˆï¼Œ<code>T2</code> éšåä¿®æ”¹ï¼Œ<code>T2</code> çš„ä¿®æ”¹è¦†ç›–äº† <code>T1</code> çš„ä¿®æ”¹ã€‚</p>
</div>
<h5 id="è¯»è„æ•°æ®"><a class="markdownIt-Anchor" href="#è¯»è„æ•°æ®"></a> è¯»è„æ•°æ®</h5>
<div class="note "><p>è¯»è„æ•°æ®æŒ‡åœ¨ä¸åŒçš„äº‹åŠ¡ä¸‹ï¼Œå½“å‰äº‹åŠ¡å¯ä»¥è¯»åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚</p>
<p>ä¾‹å¦‚ï¼š<code>T1</code> ä¿®æ”¹ä¸€ä¸ªæ•°æ®ä½†æœªæäº¤ï¼Œ<code>T2</code> éšåè¯»å–è¿™ä¸ªæ•°æ®ã€‚å¦‚æœ <code>T1</code> æ’¤é”€äº†è¿™æ¬¡ä¿®æ”¹ï¼Œ <code>T2</code> è¯»å–çš„æ•°æ®æ˜¯è„æ•°æ®ã€‚</p>
</div>
<h5 id="ä¸å¯é‡å¤è¯»"><a class="markdownIt-Anchor" href="#ä¸å¯é‡å¤è¯»"></a> ä¸å¯é‡å¤è¯»</h5>
<div class="note "><p>ä¸å¯é‡å¤è¯»æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®å¾—åˆ°ä¸åŒç»“æœã€‚</p>
</div>
<h5 id="å¹»å½±è¯»"><a class="markdownIt-Anchor" href="#å¹»å½±è¯»"></a> å¹»å½±è¯»</h5>
<div class="note "><p>å¹»è¯»æœ¬è´¨ä¸Šå°±æ˜¯ä¸å¯é‡å¤è¯»ã€‚<code>T1</code> è¯»å–æŸä¸ªèŒƒå›´çš„æ•°æ®ï¼Œ<code>T2</code> åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥æ–°çš„æ•°æ®ï¼Œ<code>T1</code> å†æ¬¡è¯»å–è¿™ä¸ªèŒƒå›´çš„æ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚</p>
</div>
<h4 id="å°é”"><a class="markdownIt-Anchor" href="#å°é”"></a> å°é”</h4>
<h5 id="é”ç²’åº¦"><a class="markdownIt-Anchor" href="#é”ç²’åº¦"></a> é”ç²’åº¦</h5>
<div class="note "><p><code>MySQL</code> ä¸­æä¾›äº†ä¸¤ç§å°é”ç²’åº¦ï¼š<strong>è¡Œçº§é”</strong>ä»¥åŠ<strong>è¡¨çº§é”</strong>ã€‚</p>
<p>é”ç²’åº¦è¶Šå°ï¼Œå‘ç”Ÿé”äº‰ç”¨çš„å¯èƒ½å°±è¶Šå°ï¼Œç³»ç»Ÿçš„å¹¶å‘åº¦å°±è¶Šé«˜ï¼Œä½†åŒæ—¶ç³»ç»Ÿå¼€é”€ä¼šè¶Šå¤§ã€‚</p>
<p>åœ¨é€‰æ‹©å°é”ç²’åº¦æ—¶ï¼Œéœ€è¦åœ¨é”å¼€é”€å’Œå¹¶å‘åº¦ä¹‹é—´åšä¸€ä¸ªæƒè¡¡ã€‚</p>
</div>
<h5 id="é”ç±»å‹"><a class="markdownIt-Anchor" href="#é”ç±»å‹"></a> é”ç±»å‹</h5>
<ul>
<li>
<p>è¯»å†™é”</p>
<ul>
<li>äº’æ–¥é”ï¼šåˆç§°å†™é”ï¼Œç®€å†™ä¸º X é”ã€‚</li>
<li>å…±äº«é”ï¼šåˆç§°è¯»é”ï¼Œç®€å†™ä¸º S é”ã€‚</li>
</ul>
<div class="note "><p>ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ® A åŠ äº† X é”ï¼ŒæœŸé—´å…¶ä»–äº‹åŠ¡å°±ä¸èƒ½å¯¹ A åŠ ä»»ä½•é”ï¼›</p>
<p>ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ® A åŠ äº† S é”ï¼ŒæœŸé—´å…¶ä»–äº‹åŠ¡å¯ä»¥å¯¹ A åŠ  S é”ï¼Œä¸èƒ½åŠ  X é”ã€‚</p>
</div>
</li>
<li>
<p>æ„å‘é”</p>
<div class="note "><p><code>MySQL</code> ä¸­å­˜åœ¨è¡Œçº§é”å’Œè¡¨çº§é”ï¼Œå› æ­¤ä¸€ä¸ªäº‹åŠ¡å¦‚æœæƒ³å¯¹ä¸€å¼ è¡¨ A åŠ  X é”ï¼Œéœ€è¦æ£€æµ‹ A ä¸­æ¯ä¸€è¡Œæ•°æ®æ˜¯å¦åŠ é”ï¼Œè¿™æ— ç–‘éå¸¸è€—æ—¶ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<code>MySQL</code> åˆå¼•å…¥äº†<strong>æ„å‘é”</strong>æ¦‚å¿µã€‚</p>
<p>æ„å‘é”åœ¨åŸæ¥çš„ X/S é”ä¹‹ä¸Šå¼•å…¥äº† IX/ISï¼ŒIX/IS éƒ½æ˜¯è¡¨é”ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªäº‹åŠ¡æƒ³è¦åœ¨è¡¨ä¸­çš„æŸè¡Œæ•°æ®ä¸ŠåŠ  X é”æˆ– S é”ã€‚å…·ä½“è§„å®šå¦‚ä¸‹ï¼š</p>
<ul>
<li>ä¸€ä¸ªäº‹åŠ¡åœ¨è·å¾—æŸè¡Œæ•°æ®çš„ S é”ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·å¾—è¡¨çš„ IS é”æˆ–è€…æ›´å¼ºçš„é”ï¼›</li>
<li>ä¸€ä¸ªäº‹åŠ¡åœ¨è·å¾—æŸè¡Œæ•°æ®çš„ X é”ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·å¾—è¡¨çš„ IX é”ã€‚</li>
</ul>
<p>é€šè¿‡å¼•å…¥æ„å‘é”ï¼Œäº‹åŠ¡æƒ³è¦å¯¹è¡¨ A åŠ  X é”ï¼Œåªéœ€æ£€æµ‹æ˜¯å¦æœ‰å…¶å®ƒäº‹åŠ¡å¯¹ A åŠ äº† X/IX/S/IS é”ï¼Œå¦‚æœåŠ äº†å°±è¡¨ç¤ºæœ‰å…¶å®ƒäº‹åŠ¡æ­£åœ¨ä½¿ç”¨è¿™ä¸ªè¡¨æˆ–è€…è¡¨ä¸­æŸä¸€è¡Œçš„é”ï¼Œå› æ­¤äº‹åŠ¡åŠ  X é”å¤±è´¥ã€‚</p>
</div>
</li>
</ul>
<h5 id="é”åè®®"><a class="markdownIt-Anchor" href="#é”åè®®"></a> é”åè®®</h5>
<ul>
<li>
<p>ä¸‰çº§å°é”åè®®</p>
<ul>
<li>
<p>ä¸€çº§å°é”åè®®</p>
<p>äº‹åŠ¡ä¿®æ”¹æ•°æ®éœ€å…ˆåŠ  X é”ï¼Œå¯ä»¥<strong>è§£å†³ä¿®æ”¹ä¸¢å¤±é—®é¢˜</strong>ã€‚</p>
<p>å› ä¸ºåœ¨ä¸€ä¸ªäº‹åŠ¡ç»“æŸå¹¶é‡Šæ”¾ X é”ä¹‹å‰ï¼Œä¸ä¼šæœ‰å…¶ä»–äº‹åŠ¡ä¿®æ”¹åŒä¸€æ•°æ®ã€‚</p>
</li>
<li>
<p>äºŒçº§å°é”åè®®</p>
<p>åœ¨ä¸€çº§çš„åŸºç¡€ä¸Šï¼Œè¦æ±‚è¯»å–æ•°æ® A æ—¶å¿…é¡»åŠ  S é”ï¼Œ<strong>è¯»å–å®Œé©¬ä¸Šé‡Šæ”¾ S é”</strong>ã€‚</p>
<p>å¯ä»¥è§£å†³è¯»è„æ•°æ®é—®é¢˜ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªäº‹åŠ¡åœ¨å¯¹æ•°æ® A è¿›è¡Œä¿®æ”¹ï¼Œæ ¹æ® 1 çº§å°é”åè®®ï¼Œä¼šåŠ  X é”ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å†åŠ  S é”äº†ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šè¯»å…¥æ•°æ®ã€‚</p>
</li>
<li>
<p>ä¸‰çº§å°é”åè®®</p>
<p>åœ¨äºŒçº§çš„åŸºç¡€ä¸Šï¼Œè¦æ±‚è¯»å–æ•°æ® A æ—¶å¿…é¡»åŠ  S é”ï¼Œ<strong>ç›´åˆ°äº‹åŠ¡ç»“æŸäº†æ‰èƒ½é‡Šæ”¾ S é”</strong>ã€‚</p>
<p>å¯ä»¥è§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œå› ä¸ºè¯» A æ—¶ï¼Œå…¶å®ƒäº‹åŠ¡ä¸èƒ½å¯¹ A åŠ  X é”ï¼Œä»è€Œé¿å…äº†åœ¨è¯»çš„æœŸé—´æ•°æ®å‘ç”Ÿæ”¹å˜ã€‚</p>
</li>
</ul>
</li>
<li>
<p>ä¸¤æ®µé”åè®®</p>
<p>åŠ é”å’Œè§£é”åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µè¿›è¡Œã€‚</p>
</li>
</ul>
<h4 id="éš”ç¦»çº§åˆ«"><a class="markdownIt-Anchor" href="#éš”ç¦»çº§åˆ«"></a> éš”ç¦»çº§åˆ«</h4>
<h5 id="æœªæäº¤è¯»read-uncommitted"><a class="markdownIt-Anchor" href="#æœªæäº¤è¯»read-uncommitted"></a> æœªæäº¤è¯»ï¼ˆRead Uncommittedï¼‰</h5>
<p>ä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–å…¶ä»–äº‹åŠ¡è¿˜æœªæäº¤çš„å¯¹æ•°æ®çš„ä¿®æ”¹ã€‚</p>
<h5 id="æäº¤è¯»read-committed"><a class="markdownIt-Anchor" href="#æäº¤è¯»read-committed"></a> æäº¤è¯»ï¼ˆRead Committedï¼‰</h5>
<p>ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–å·²æäº¤äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ã€‚</p>
<h5 id="å¯é‡å¤è¯»repeatable-read"><a class="markdownIt-Anchor" href="#å¯é‡å¤è¯»repeatable-read"></a> å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰</h5>
<p>ä¸€ä¸ªäº‹åŠ¡å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®å¾—åˆ°çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p>
<h5 id="ä¸²è¡ŒåŒ–serializable"><a class="markdownIt-Anchor" href="#ä¸²è¡ŒåŒ–serializable"></a> ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰</h5>
<p>äº‹åŠ¡ä¸²è¡ŒåŒ–æ‰§è¡Œã€‚</p>
<p>éš”ç¦»çº§åˆ«èƒ½è§£å†³çš„å¹¶å‘ä¸€è‡´æ€§é—®é¢˜ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align:center">è„è¯»</th>
<th style="text-align:center">ä¸å¯é‡å¤è¯»</th>
<th style="text-align:center">å¹»è¯»</th>
</tr>
</thead>
<tbody>
<tr>
<td>æœªæäº¤è¯»</td>
<td style="text-align:center">âœ—</td>
<td style="text-align:center">âœ—</td>
<td style="text-align:center">âœ—</td>
</tr>
<tr>
<td>æäº¤è¯»</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ—</td>
<td style="text-align:center">âœ—</td>
</tr>
<tr>
<td>å¯é‡å¤è¯»</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ—</td>
</tr>
<tr>
<td>ä¸²è¡ŒåŒ–</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
</tbody>
</table>
<h4 id="å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶"><a class="markdownIt-Anchor" href="#å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶"></a> å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</h4>
]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“ç³»ç»ŸåŸç†</tag>
        <tag>äº‹åŠ¡</tag>
        <tag>å¹¶å‘ä¸€è‡´æ€§</tag>
        <tag>éš”ç¦»çº§åˆ«</tag>
        <tag>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¿ç¨‹æ± </title>
    <url>/archives/de7c53fe.html</url>
    <content><![CDATA[<h4 id="çº¿ç¨‹æ± çŠ¶æ€"><a class="markdownIt-Anchor" href="#çº¿ç¨‹æ± çŠ¶æ€"></a> çº¿ç¨‹æ± çŠ¶æ€</h4>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> AtomicInteger ctl = <span class="keyword">new</span> AtomicInteger(ctlOf(RUNNING, <span class="number">0</span>));</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> COUNT_BITS = Integer.SIZE - <span class="number">3</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CAPACITY   = (<span class="number">1</span> &lt;&lt; COUNT_BITS) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// runState is stored in the high-order bits</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> RUNNING    = -<span class="number">1</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SHUTDOWN   =  <span class="number">0</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STOP       =  <span class="number">1</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TIDYING    =  <span class="number">2</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TERMINATED =  <span class="number">3</span> &lt;&lt; COUNT_BITS;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Packing and unpacking ctl</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">runStateOf</span><span class="params">(<span class="keyword">int</span> c)</span>     </span>&#123; <span class="keyword">return</span> c &amp; ~CAPACITY; &#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">workerCountOf</span><span class="params">(<span class="keyword">int</span> c)</span>  </span>&#123; <span class="keyword">return</span> c &amp; CAPACITY; &#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">ctlOf</span><span class="params">(<span class="keyword">int</span> rs, <span class="keyword">int</span> wc)</span> </span>&#123; <span class="keyword">return</span> rs | wc; &#125;</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<div class="note "><p>å˜é‡ **<code>ctl</code>**è®°å½•äº†â€œ<strong>çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡æ•°</strong>é‡â€å’Œâ€œ<strong>çº¿ç¨‹æ± çš„çŠ¶æ€</strong>â€ä¸¤ä¸ªä¿¡æ¯ã€‚å…±32ä½ï¼Œå…¶ä¸­é«˜  3ä½è¡¨ç¤ºâ€çº¿ç¨‹æ± çŠ¶æ€â€ï¼Œä½ 29 ä½è¡¨ç¤ºâ€çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡æ•°é‡â€ã€‚</p>
<ul>
<li>
<p><code>RUNNING</code>           å¯¹åº”é«˜ 3 ä½ä¸º 111</p>
<p>å¤„äº <code>RUNNING</code> çŠ¶æ€çš„çº¿ç¨‹æ± èƒ½å¤Ÿå¤„ç†å·²ç»æ¥æ”¶çš„ä»»åŠ¡ï¼Œä»¥åŠæ¥æ”¶æ–°ä»»åŠ¡ã€‚</p>
</li>
<li>
<p><code>SHUTDOWN</code>         å¯¹åº”é«˜ 3 ä½ä¸º 000</p>
<p>å¤„äº <code>SHUTDOWN</code> çŠ¶æ€çš„çº¿ç¨‹æ± èƒ½å¤Ÿå¤„ç†å·²ç»æ¥æ”¶çš„ä»»åŠ¡ï¼Œä¸èƒ½æ¥æ”¶æ–°ä»»åŠ¡ã€‚</p>
</li>
<li>
<p><code>STOP</code>                 å¯¹åº”é«˜ 3 ä½ä¸º 001</p>
<p>å¤„äº <code>STOP</code> çŠ¶æ€çš„çº¿ç¨‹æ± ä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä¸å¤„ç†å·²æ·»åŠ çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¼šä¸­æ–­æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ã€‚</p>
</li>
<li>
<p><code>TIDYING</code>           å¯¹åº”é«˜ 3 ä½ä¸º 010</p>
<p>å½“æ‰€æœ‰çš„ä»»åŠ¡å·²ç»ˆæ­¢ï¼Œ<code>ctl</code> è®°å½•çš„â€ä»»åŠ¡æ•°é‡â€ä¸º 0ï¼Œçº¿ç¨‹æ± ä¼šå˜ä¸º <code>TIDYING</code> çŠ¶æ€ï¼Œå¹¶æ‰§è¡Œé’©å­å‡½æ•°<code>terminated()</code>ã€‚</p>
</li>
<li>
<p><code>TERMINATED</code>     å¯¹åº”é«˜ 3 ä½ä¸º 011</p>
<p>æ‰§è¡Œå®Œé’©å­å‡½æ•° <code>terminated()</code> çš„çº¿ç¨‹æ± çŠ¶æ€ã€‚</p>
</li>
</ul>
<p>å¤„äº <code>RUNNING</code> çŠ¶æ€çš„çº¿ç¨‹æ± è°ƒç”¨ <code>shutdown()</code> ä¼šè¿›å…¥ <code>SHUTDOWN</code> çŠ¶æ€ï¼›æ‰§è¡Œ <code>shutdownNow()</code> ä¼šè¿›å…¥ <code>STOP</code> çŠ¶æ€ã€‚</p>
</div>
<h4 id="åˆ›å»ºçº¿ç¨‹æ± "><a class="markdownIt-Anchor" href="#åˆ›å»ºçº¿ç¨‹æ± "></a> åˆ›å»ºçº¿ç¨‹æ± </h4>
<p>é€šè¿‡ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">int</span> maximumPoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">long</span> keepAliveTime,</span></span></span><br><span class="line"><span class="function"><span class="params">                          TimeUnit unit,</span></span></span><br><span class="line"><span class="function"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span></span><br><span class="line"><span class="function"><span class="params">                          ThreadFactory threadFactory,</span></span></span><br><span class="line"><span class="function"><span class="params">                          RejectedExecutionHandler handler)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (corePoolSize &lt; <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt;= <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt; corePoolSize ||</span><br><span class="line">        keepAliveTime &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">    <span class="keyword">if</span> (workQueue == <span class="keyword">null</span> || threadFactory == <span class="keyword">null</span> || handler == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    <span class="keyword">this</span>.acc = System.getSecurityManager() == <span class="keyword">null</span> ?</span><br><span class="line">            <span class="keyword">null</span> :</span><br><span class="line">            AccessController.getContext();</span><br><span class="line">    <span class="keyword">this</span>.corePoolSize = corePoolSize;</span><br><span class="line">    <span class="keyword">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class="line">    <span class="keyword">this</span>.workQueue = workQueue;</span><br><span class="line">    <span class="keyword">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class="line">    <span class="keyword">this</span>.threadFactory = threadFactory;</span><br><span class="line">    <span class="keyword">this</span>.handler = handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="note "><p>å‚æ•°å«ä¹‰ï¼š</p>
<ul>
<li>
<p><code>corePoolSize</code> â€“ çº¿ç¨‹æ± ä¸­æ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡ã€‚å½“å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªä»»åŠ¡åï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œç­‰ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå¦‚æœçº¿ç¨‹æ•°å°‘äº <code>corePoolSize</code>ï¼Œçº¿ç¨‹ä¼šç»§ç»­å­˜åœ¨ï¼Œä¸ä¼šé”€æ¯ã€‚</p>
</li>
<li>
<p><code>maximumPoolSize</code> â€“ çº¿ç¨‹æ± ä¸­å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°ã€‚</p>
</li>
<li>
<p><code>keepAliveTime</code> â€“ å½“çº¿ç¨‹æ•°å¤šäº <code>corePoolSize</code> æ—¶ï¼Œå¤šä½™çš„çº¿ç¨‹ç»§ç»­å­˜æ´» <code>keepAliveTime</code> æ—¶é—´ï¼Œç­‰å¾…æ–°ä»»åŠ¡çš„åˆ°æ¥ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´æ²¡æœ‰æ–°ä»»åŠ¡å¤„ç†å°±é”€æ¯å¤šä½™çš„çº¿ç¨‹ã€‚</p>
</li>
<li>
<p>unit â€“ <code>keepAliveTime</code> çš„å•ä½ã€‚</p>
</li>
<li>
<p><code>workQueue</code> â€“ ä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚åªä¿å­˜ç”¨ <code>execute()</code> æäº¤çš„å®ç° <code>Runnable</code> æ¥å£çš„ä»»åŠ¡ã€‚</p>
<p>å¸¸ç”¨çš„é˜»å¡é˜Ÿåˆ—åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>ArrayBlockingQueue</code> - åŸºäºæ•°ç»„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</li>
<li><code>LinkedBlockingQueue</code> - åŸºäºé“¾è¡¨çš„æ— è§£é˜»å¡é˜Ÿåˆ—ï¼Œå¯ä»¥è®¾ç½®ä¸ºæœ‰ç•Œã€‚</li>
<li><code>PriorityBlockingQueue</code> - å…·æœ‰ä¼˜å…ˆçº§åˆ«çš„é˜»å¡é˜Ÿåˆ—</li>
<li><code>SynchronousQueue</code> -</li>
</ul>
</li>
<li>
<p>threadFactory â€“ åˆ›å»ºæ–°çº¿ç¨‹çš„å·¥å‚ã€‚</p>
</li>
<li>
<p>handler â€“ å½“çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°è¾¾åˆ°äº†è¾¹ç•Œï¼Œä¸”ä»»åŠ¡é˜»å¡é˜Ÿåˆ—å·²æ»¡çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± çš„å¤„ç†ç­–ç•¥ã€‚</p>
<p>æœ‰å››ç§ç­–ç•¥ï¼š</p>
<ul>
<li><code>AbortPolicy</code> - ç›´æ¥æŠ›å‡º <code>RejectedExecutionException</code> å¼‚å¸¸ï¼Œé»˜è®¤ç­–ç•¥</li>
<li><code>CallerRunsPolicy</code> - ç”¨è°ƒç”¨è€…æ‰€åœ¨çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡</li>
<li><code>DiscardOldestPolicy</code> - ä¸¢å¼ƒé˜»å¡é˜Ÿåˆ—ä¸­é æœ€å‰çš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡</li>
<li><code>DiscardPolicy</code> - ç›´æ¥ä¸¢å¼ƒä»»åŠ¡</li>
</ul>
</li>
</ul>
</div>
<h5 id="fixedthreadpool"><a class="markdownIt-Anchor" href="#fixedthreadpool"></a> <code>FixedThreadPool</code></h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="note "><p><code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> éƒ½è®¾ç½®ä¸º <code>nThreads</code>ï¼Œæ„å‘³ç€å½“çº¿ç¨‹æ± æ»¡æ—¶ä¸”é˜»å¡é˜Ÿåˆ—ä¹Ÿå·²ç»æ»¡æ—¶ï¼Œå¦‚æœç»§ç»­æäº¤ä»»åŠ¡ï¼Œè¯¥çº¿ç¨‹æ± ä¸ä¼šå†æ–°å»ºçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œè€Œæ˜¯ç›´æ¥èµ°æ‹’ç»ç­–ç•¥ã€‚</p>
<p><code>FixedThreadPool</code> ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„æ‹’ç»ç­–ç•¥ <code>AbortPolicy</code>ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p>
</div>
<h5 id="singlethreadpool"><a class="markdownIt-Anchor" href="#singlethreadpool"></a> <code>SingleThreadPool</code></h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newSingleThreadExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> FinalizableDelegatedExecutorService</span><br><span class="line">        (<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                                <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="cachedthreadpool"><a class="markdownIt-Anchor" href="#cachedthreadpool"></a> <code>CachedThreadPool</code></h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡æäº¤"><a class="markdownIt-Anchor" href="#ä»»åŠ¡æäº¤"></a> ä»»åŠ¡æäº¤</h4>
<p>çº¿ç¨‹æ± æ ¹æ®ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚æä¾›äº†ä¸¤ç§æ–¹å¼æäº¤ä»»åŠ¡ï¼š</p>
<ul>
<li>
<p><code>Executor.execute()</code></p>
<p><code>ThreadPoolExecutor</code> ä¸­çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (command == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * Proceed in 3 steps:</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 1. If fewer than corePoolSize threads are running, try to</span></span><br><span class="line"><span class="comment">         * start a new thread with the given command as its first</span></span><br><span class="line"><span class="comment">         * task.  The call to addWorker atomically checks runState and</span></span><br><span class="line"><span class="comment">         * workerCount, and so prevents false alarms that would add</span></span><br><span class="line"><span class="comment">         * threads when it shouldn&#x27;t, by returning false.</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 2. If a task can be successfully queued, then we still need</span></span><br><span class="line"><span class="comment">         * to double-check whether we should have added a thread</span></span><br><span class="line"><span class="comment">         * (because existing ones died since last checking) or that</span></span><br><span class="line"><span class="comment">         * the pool shut down since entry into this method. So we</span></span><br><span class="line"><span class="comment">         * recheck state and if necessary roll back the enqueuing if</span></span><br><span class="line"><span class="comment">         * stopped, or start a new thread if there are none.</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 3. If we cannot queue task, then we try to add a new</span></span><br><span class="line"><span class="comment">         * thread.  If it fails, we know we are shut down or saturated</span></span><br><span class="line"><span class="comment">         * and so reject the task.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> c = ctl.get();</span><br><span class="line">        <span class="comment">// è·å–å½“å‰çº¿ç¨‹æ•°å¹¶ä¸ corePoolSize æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">if</span> (workerCountOf(c) &lt; corePoolSize) &#123; </span><br><span class="line">            <span class="keyword">if</span> (addWorker(command, <span class="keyword">true</span>)) <span class="comment">// åˆ›å»ºæ–°çº¿ç¨‹</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            c = ctl.get();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class="line">            <span class="keyword">int</span> recheck = ctl.get();</span><br><span class="line">            <span class="keyword">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class="line">                reject(command);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (workerCountOf(recheck) == <span class="number">0</span>)</span><br><span class="line">                addWorker(<span class="keyword">null</span>, <span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!addWorker(command, <span class="keyword">false</span>))</span><br><span class="line">            reject(command);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>ExecutorService.submit()</code>ã€‚</p>
<p>å¯ä»¥è·å–è¯¥ä»»åŠ¡æ‰§è¡Œçš„ <code>Future</code>ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>å¹¶å‘</category>
      </categories>
      <tags>
        <tag>çº¿ç¨‹æ± </tag>
        <tag>ThreadPoolExecutor</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaåŸºç¡€</title>
    <url>/archives/f7ede91d.html</url>
    <content><![CDATA[<h4 id="java-çš„è·¨å¹³å°æ€§"><a class="markdownIt-Anchor" href="#java-çš„è·¨å¹³å°æ€§"></a> Java çš„è·¨å¹³å°æ€§</h4>
<p>å­—èŠ‚ç ï¼š</p>
<blockquote>
<p>ç”± Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰è§£é‡Šæ‰§è¡Œçš„ä»£ç ï¼Œå­—èŠ‚ç ä¸é¢å‘ä»»ä½•å…·ä½“çš„æ“ä½œç³»ç»Ÿï¼Œåªé¢å‘ JVMã€‚Java è¯­è¨€é€šè¿‡å­—èŠ‚ç çš„å½¢å¼ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ä¼ ç»Ÿè§£é‡Šå‹è¯­è¨€æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼ŒåŒæ—¶å³ä¿ç•™äº†è§£é‡Šå‹è¯­è¨€å¯ç§»æ¤çš„ç‰¹ç‚¹ã€‚</p>
</blockquote>
<p>Java ç¨‹åºçš„æ‰§è¡Œéœ€è¦å…ˆç»ç”± JDK ä¸­çš„ javac å·¥å…·ç¼–è¯‘æˆå­—èŠ‚ç æ–‡ä»¶ï¼ˆ.class æ–‡ä»¶ï¼‰ï¼Œç„¶åå†ç”± JVM è§£é‡Šæ‰§è¡Œï¼ˆæ²¡æ‰§è¡Œä¸€å¥ï¼ŒæŠŠè¿™æ¡è¯­å¥ç¿»è¯‘æˆæœºå™¨å¯ä»¥ç†è§£çš„æœºå™¨ç ï¼‰ã€‚è§£é‡Šæ‰§è¡Œæ•ˆç‡ç›¸å¯¹è¾ƒä½ï¼Œè€Œç¨‹åºä¸­é€šå¸¸æœ‰äº›ä»£ç ä¼šç»å¸¸è¢«è°ƒç”¨æ‰§è¡Œï¼ˆçƒ­ç‚¹ä»£ç ï¼‰ï¼Œæ‰€ä»¥åˆå¼•å…¥ JIT ç¼–è¯‘å™¨ï¼Œå¯¹äºçƒ­ç‚¹ä»£ç ï¼ŒJIT ç¼–è¯‘å™¨ä¼šå°†å…¶å¯¹åº”çš„æœºå™¨ç ä¿å­˜èµ·æ¥ï¼Œä¸‹æ¬¡éœ€è¦çš„æ—¶å€™ç›´æ¥ä½¿ç”¨ï¼Œæé«˜ç¨‹åºæ‰§è¡Œçš„æ•ˆç‡ã€‚</p>
<p><strong>JVM é’ˆå¯¹ä¸åŒçš„ç³»ç»Ÿæœ‰ç‰¹å®šçš„å®ç°ï¼Œè¿™äº›ä¸åŒçš„å®ç°å¯¹äºç»™å®šçš„å­—èŠ‚ç æ–‡ä»¶ï¼Œéƒ½ä¼šç»™å‡ºç›¸åŒçš„æ‰§è¡Œç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´å­—èŠ‚ç å’Œ JVMå…±åŒå®ç°äº† Java â€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œâ€çš„ç‰¹æ€§</strong>ã€‚</p>
<span id="more"></span>
<h4 id="switch"><a class="markdownIt-Anchor" href="#switch"></a> switch</h4>
<p>åœ¨ Java 5 ä¹‹å‰ï¼Œswitch(expr) ä¸­çš„ expr åªèƒ½æ˜¯ charã€byteã€shortã€intï¼›</p>
<p>ä» Java 5 å¼€å§‹ï¼Œå¼•å…¥äº†æšä¸¾ç±»å‹ï¼Œexpr ä¹Ÿå¯ä»¥æ˜¯æšä¸¾ç±»å‹ï¼›</p>
<p>ä» Java 7 å¼€å§‹ï¼Œexpr è¿˜å¯ä»¥æ˜¯ String ç±»å‹ã€‚</p>
<p><strong>ä¹Ÿå°±æ˜¯è¯´ç›®å‰ expr çš„ç±»å‹å¯ä»¥æ˜¯ charã€byteã€shortã€intã€enumã€Stringã€‚</strong></p>
<h4 id="è½¬å‹"><a class="markdownIt-Anchor" href="#è½¬å‹"></a> è½¬å‹</h4>
<ul>
<li>
<p><code>short s1 = 1; s1 = s1 + 1;</code> æ˜¯å¦æ­£ç¡®ï¼Ÿ</p>
<blockquote>
<p>ä¸å¯¹ã€‚</p>
<p>å› ä¸ºæ•°å€¼ 1 é»˜è®¤æ˜¯ int ç±»å‹ï¼Œå› æ­¤ s1+1 è¿ç®—ç»“æœä¹Ÿæ˜¯ int å‹ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ç±»å‹æ‰èƒ½èµ‹å€¼ç»™ short å‹ã€‚</p>
<p>æ­£ç¡®å†™æ³•æ˜¯ <code>s1 = (short)(s1 + 1)</code>ã€‚</p>
</blockquote>
</li>
<li>
<p><code>short s1 = 1; s1 += 1;</code> æ˜¯å¦æ­£ç¡®ï¼Ÿ</p>
<blockquote>
<p>å¯ä»¥æ­£ç¡®ç¼–è¯‘ã€‚</p>
<p>å› ä¸º <code>s1 += 1;</code> å°±ç›¸å½“äº <code>s1 = (short) (s1 + 1);</code> å…¶ä¸­æœ‰<strong>éšå«çš„å¼ºåˆ¶ç±»å‹è½¬æ¢</strong>ã€‚</p>
</blockquote>
</li>
</ul>
<h4 id="è®¿é—®ä¿®é¥°ç¬¦"><a class="markdownIt-Anchor" href="#è®¿é—®ä¿®é¥°ç¬¦"></a> è®¿é—®ä¿®é¥°ç¬¦</h4>
<blockquote>
<p>è®¿é—®ä¿®é¥°ç¬¦ç”¨æ¥ä¿æŠ¤å¯¹ç±»ã€æ•°æ®ã€æ–¹æ³•çš„è®¿é—®ï¼ŒJava æ”¯æŒ 4 ç§è®¿é—®æƒé™ã€‚</p>
</blockquote>
<table>
<thead>
<tr>
<th>ä¿®é¥°ç¬¦</th>
<th>å½“å‰ç±»</th>
<th>åŒåŒ…</th>
<th>å­ç±»ï¼ˆå¼‚åŒ…ï¼‰</th>
<th>å¼‚åŒ…</th>
</tr>
</thead>
<tbody>
<tr>
<td>public</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>protected</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
</tr>
<tr>
<td>default</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>private</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
</tbody>
</table>
<h4 id="final"><a class="markdownIt-Anchor" href="#final"></a> final</h4>
<ol>
<li>ä¿®é¥°æ•°æ®</li>
</ol>
<blockquote>
<p>å£°æ˜æ•°æ®ä¸ºå¸¸é‡ï¼Œå¯ä»¥æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨è¿è¡Œæ—¶è¢«åˆå§‹åŒ–åä¸èƒ½è¢«æ”¹å˜çš„å¸¸é‡ã€‚</p>
<ul>
<li>å¯¹äºåŸºæœ¬ç±»å‹ï¼Œfinal ä½¿æ•°å€¼ä¸å˜ï¼›</li>
<li>å¯¹äºå¼•ç”¨ç±»å‹ï¼Œfinal ä½¿å¼•ç”¨ä¸å˜ï¼Œä¹Ÿå°±ä¸èƒ½å¼•ç”¨å…¶å®ƒå¯¹è±¡ï¼Œä½†æ˜¯è¢«å¼•ç”¨çš„å¯¹è±¡æœ¬èº«æ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚</li>
</ul>
</blockquote>
<ol start="2">
<li>ä¿®é¥°æ–¹æ³•</li>
</ol>
<blockquote>
<p>å£°æ˜æ–¹æ³•ä¸èƒ½è¢«å­ç±»é‡å†™ã€‚</p>
<p><strong>private æ–¹æ³•éšå¼åœ°è¢«æŒ‡å®šä¸º final</strong>ã€‚</p>
<p>å¦‚æœåœ¨å­ç±»ä¸­å®šä¹‰çš„æ–¹æ³•å’ŒåŸºç±»ä¸­çš„ä¸€ä¸ª private æ–¹æ³•ç­¾åç›¸åŒï¼Œæ­¤æ—¶å­ç±»çš„æ–¹æ³•ä¸æ˜¯é‡å†™åŸºç±»æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨å­ç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•ã€‚</p>
</blockquote>
<ol start="3">
<li>ä¿®é¥°ç±»</li>
</ol>
<blockquote>
<p>å£°æ˜ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚</p>
</blockquote>
<h4 id="static"><a class="markdownIt-Anchor" href="#static"></a> static</h4>
<ol>
<li>é™æ€å˜é‡</li>
</ol>
<blockquote>
<p>åˆç§°ä¸ºç±»å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå˜é‡å±äºç±»çš„ï¼Œç±»æ‰€æœ‰çš„å®ä¾‹å…±äº«é™æ€å˜é‡ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åæ¥è®¿é—®å®ƒã€‚</p>
<p>é™æ€å˜é‡åœ¨å†…å­˜ä¸­åªå­˜åœ¨ä¸€ä»½ã€‚</p>
</blockquote>
<ol start="2">
<li>é™æ€æ–¹æ³•</li>
</ol>
<blockquote>
<p>é™æ€æ–¹æ³•å¿…é¡»æœ‰å®ç°ï¼Œ<strong>ä¸èƒ½æ˜¯æŠ½è±¡æ–¹æ³•</strong>ã€‚</p>
<p>åªèƒ½è®¿é—®æ‰€å±ç±»çš„é™æ€å­—æ®µå’Œé™æ€æ–¹æ³•ã€‚</p>
<p>é™æ€æ–¹æ³•ä¸­ä¸èƒ½æœ‰ this å’Œ super å…³é”®å­—ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªå…³é”®å­—ä¸å…·ä½“å¯¹è±¡å…³è”ã€‚</p>
</blockquote>
<ol start="3">
<li>é™æ€è¯­å¥å—</li>
</ol>
<blockquote>
<p>åœ¨ç±»åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ã€‚</p>
</blockquote>
<p>åˆå§‹åŒ–é¡ºåºï¼š</p>
<blockquote>
<ol>
<li>
<p>é™æ€å˜é‡/é™æ€è¯­å¥å—</p>
</li>
<li>
<p>å®ä¾‹å˜é‡/æ™®é€šè¯­å¥å—</p>
</li>
<li>
<p>æ„é€ å‡½æ•°</p>
</li>
</ol>
</blockquote>
<p>å­˜åœ¨ç»§æ‰¿çš„æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–é¡ºåºä¸ºï¼š</p>
<blockquote>
<ol>
<li>åŸºç±»ï¼ˆé™æ€å˜é‡/é™æ€è¯­å¥å—ï¼‰</li>
<li>å­ç±»ï¼ˆé™æ€å˜é‡/é™æ€è¯­å¥å—ï¼‰</li>
<li>åŸºç±»ï¼ˆå®ä¾‹å˜é‡/æ™®é€šè¯­å¥å—ï¼‰</li>
<li>åŸºç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰</li>
<li>å­ç±»ï¼ˆå®ä¾‹å˜é‡/æ™®é€šè¯­å¥å—ï¼‰</li>
<li>å­ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰</li>
</ol>
</blockquote>
<h4 id="é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§"><a class="markdownIt-Anchor" href="#é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§"></a> é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§</h4>
<ul>
<li>
<p>å°è£…</p>
</li>
<li>
<p>ç»§æ‰¿</p>
</li>
<li>
<p>å¤šæ€</p>
<blockquote>
<p>å…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯ä½œå‡ºå“åº”ã€‚</p>
</blockquote>
<blockquote>
<p>å¤šæ€å­˜åœ¨çš„ä¸‰ä¸ªå¿…è¦æ¡ä»¶</p>
<p>ä¸€ã€ç»§æ‰¿ï¼›</p>
<p>äºŒã€æ–¹æ³•é‡å†™ï¼›</p>
<p>ä¸‰ã€çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ã€‚</p>
</blockquote>
</li>
</ul>
<h4 id="é¢å‘å¯¹è±¡äº”å¤§åŸåˆ™"><a class="markdownIt-Anchor" href="#é¢å‘å¯¹è±¡äº”å¤§åŸåˆ™"></a> é¢å‘å¯¹è±¡äº”å¤§åŸåˆ™</h4>
<ul>
<li>
<p><strong>å•ä¸€èŒè´£åŸåˆ™</strong>ï¼ˆSingle Responsibility Principleï¼ŒSRPï¼‰</p>
<blockquote>
<p>ç±»çš„åŠŸèƒ½è¦å•ä¸€ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>å¼€æ”¾å°é—­åŸåˆ™</strong>ï¼ˆOpen-Close Principleï¼ŒOCPï¼‰</p>
<blockquote>
<p>ä¸€ä¸ªæ¨¡å—å¯¹æ‹“å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>é‡Œå¼æ›¿æ¢åŸåˆ™</strong>ï¼ˆthe Liskov Substitution Principleï¼ŒLSPï¼‰</p>
<blockquote>
<p>åŸºç±»å‡ºç°çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ç”¨å­ç±»æ›¿æ¢ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>ä¾èµ–å€’ç½®åŸåˆ™</strong>ï¼ˆthe Dependency Inversion Principleï¼ŒDIPï¼‰</p>
<blockquote>
<p>é«˜å±‚æ¬¡çš„æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½å±‚æ¬¡çš„æ¨¡å—ï¼Œä»–ä»¬éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p>
<p>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºå…·ä½“å®ç°ï¼Œå…·ä½“å®ç°åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p>
</blockquote>
</li>
<li>
<p>æ¥å£åˆ†ç¦»åŸåˆ™ï¼ˆthe Interface Segregation Principle ISPï¼‰</p>
</li>
</ul>
<h4 id="java-å¦‚ä½•å®ç°å¤šæ€"><a class="markdownIt-Anchor" href="#java-å¦‚ä½•å®ç°å¤šæ€"></a> Java å¦‚ä½•å®ç°å¤šæ€</h4>
<ol>
<li>é‡è½½ï¼ˆOverloadï¼‰</li>
</ol>
<blockquote>
<p>å¤šä¸ªæ–¹æ³•åŒåï¼Œä½†è¿™äº›æ–¹æ³•çš„å‚æ•°åœ¨ç±»å‹ã€ä¸ªæ•°ã€é¡ºåºè‡³å°‘æœ‰ä¸€ä¸ªä¸ä¸€æ ·ã€‚</p>
</blockquote>
<ol start="2">
<li>é‡å†™ï¼ˆOverrideï¼‰</li>
</ol>
<blockquote>
<p>å­˜åœ¨ä¸ç»§æ‰¿ä½“ç³»ä¸­ï¼ŒæŒ‡å­ç±»å¯¹åŸºç±»çš„æ–¹æ³•è¿›è¡Œé‡æ–°å®ç°ã€‚</p>
<p>ä¸ºäº†æ»¡è¶³é‡Œå¼æ›¿æ¢åŸåˆ™ï¼Œé‡å†™æœ‰ä»¥ä¸‹ä¸‰ä¸ªé™åˆ¶ï¼š</p>
<ul>
<li>å­ç±»æ–¹æ³•çš„è®¿é—®æƒé™å¿…é¡»å¤§äºç­‰äºçˆ¶ç±»æ–¹æ³•ï¼›</li>
<li>å­ç±»æ–¹æ³•çš„è¿”å›ç±»å‹å¿…é¡»æ˜¯çˆ¶ç±»æ–¹æ³•è¿”å›ç±»å‹æˆ–ä¸ºå…¶å­ç±»å‹ã€‚</li>
<li>å­ç±»æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹å¿…é¡»æ˜¯çˆ¶ç±»æŠ›å‡ºå¼‚å¸¸ç±»å‹æˆ–ä¸ºå…¶å­ç±»å‹ã€‚</li>
</ul>
</blockquote>
<p>åŠ¨æ€ç»‘å®šï¼š</p>
<blockquote>
<p>åœ¨æ‰§è¡ŒæœŸé—´åˆ¤æ–­å¼•ç”¨æ‰€æŒ‡å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œæ ¹æ®å…¶å®é™…çš„ç±»å‹è°ƒç”¨å…¶ç›¸åº”çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>å¤šæ€çš„å®ç°åŸºäºï¼š</p>
<blockquote>
<ol>
<li>ç±»çš„ç»§æ‰¿</li>
<li>æ–¹æ³•é‡å†™</li>
<li>åŸºç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡</li>
<li>åŠ¨æ€ç»‘å®š</li>
</ol>
</blockquote>
<h4 id="æŠ½è±¡ç±»ä¸æ¥å£"><a class="markdownIt-Anchor" href="#æŠ½è±¡ç±»ä¸æ¥å£"></a> æŠ½è±¡ç±»ä¸æ¥å£</h4>
<ul>
<li>
<p>æŠ½è±¡ç±»</p>
<blockquote>
<p>æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•éƒ½ä½¿ç”¨ abstract å…³é”®å­—è¿›è¡Œå£°æ˜ã€‚</p>
<p>å¦‚æœä¸€ä¸ªç±»ä¸­åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å¿…é¡»å£°æ˜ä¸ºæŠ½è±¡ç±»ã€‚</p>
<p>æŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ–ã€‚</p>
</blockquote>
</li>
<li>
<p>æ¥å£</p>
<blockquote>
<p>æ¥å£çš„å­—æ®µé»˜è®¤æ˜¯ public static final çš„ã€‚</p>
<p>æ¥å£çš„æ–¹æ³•é»˜è®¤æ˜¯ public çš„ã€‚</p>
<p>åœ¨ Java 8 ä¹‹å‰ï¼Œæ¥å£å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªå®Œå…¨æŠ½è±¡çš„ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´æ¥å£ä¸èƒ½æœ‰ä»»ä½•çš„æ–¹æ³•å®ç°ã€‚å¦‚æœæ¥å£æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œæ‰€æœ‰å®ç°è¯¥æ¥å£çš„ç±»éƒ½éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ã€‚æ˜¾ç„¶è¿™æ ·çš„è®¾è®¡ç»´æŠ¤æˆæœ¬å¤ªé«˜ã€‚æ‰€ä»¥ä» Java 8 ä¹‹åï¼Œæ¥å£ä¹Ÿå¯ä»¥æ‹¥æœ‰é»˜è®¤çš„æ–¹æ³•å®ç°ã€‚</p>
<p>Java 9 ä¹‹åå…è®¸å°†æ–¹æ³•å®šä¹‰ä¸º privateï¼Œè¿™æ ·å°±èƒ½å®šä¹‰æŸäº›å¤ç”¨çš„ä»£ç åˆä¸ä¼šæŠŠæ–¹æ³•æš´éœ²å‡ºå»ã€‚</p>
</blockquote>
</li>
<li>
<p>æ¯”è¾ƒ</p>
<blockquote>
<p>æŠ½è±¡ç±»æ˜¯å¯¹ç±»ç‰¹å¾çš„æŠ½è±¡ï¼ŒæŠ½è±¡ç±»å’Œå…¶å­ç±»ä¹‹é—´æ˜¯ IS-A å…³ç³»ï¼Œæ»¡è¶³é‡Œå¼æ›¿æ¢åŸåˆ™ï¼Œå³çˆ¶ç±»å¯¹è±¡å¯ä»¥ç”¨å­ç±»å¯¹è±¡æ›¿æ¢ã€‚</p>
<p>æ¥å£æ˜¯å¯¹è¡Œä¸ºçš„æŠ½è±¡ï¼Œæ¥å£å’Œå…¶å®ç°ç±»åƒæ˜¯ LIKE-A å…³ç³»ï¼Œæ¯”å¦‚é£æœºå’Œé¸Ÿéƒ½æœ‰é£çš„è¡Œä¸ºï¼Œä½†æ²¡æœ‰å…¶ä»–æ˜æ˜Ÿçš„å…±åŒç‰¹å¾ï¼Œæ­¤æ—¶è®©é£æœºå’Œé¸Ÿç»§æ‰¿ä¸€ä¸ªå…±åŒçš„åŸºç±»æ˜¾ç„¶ä¸å¤ªåˆç†ã€‚</p>
<p>ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªåŸºç±»ï¼›ä½†å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚</p>
</blockquote>
</li>
</ul>
<h4 id="é»˜è®¤æ„é€ å‡½æ•°"><a class="markdownIt-Anchor" href="#é»˜è®¤æ„é€ å‡½æ•°"></a> é»˜è®¤æ„é€ å‡½æ•°</h4>
<p>å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æ˜¾ç¤ºå®šä¹‰æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤ç”Ÿæˆä¸€ä¸ªæ— å‚çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚</p>
<p>å¦‚æœç°å®å®šä¹‰äº†æœ‰å‚çš„æ„é€ å‡½æ•°ï¼Œåˆ™ä¸ä¼šé»˜è®¤ç”Ÿæˆæ— å‚çš„æ„é€ å‡½æ•°ã€‚</p>
<p>å¦‚æœä¸€ä¸ªç±»æœ‰å­ç±»ï¼Œåˆ™æ˜¾ç¤ºå®šä¹‰äº†æœ‰å‚çš„æ„é€ å‡½æ•°ï¼Œéœ€è¦åŒæ—¶æ˜¾ç¤ºå®šä¹‰æ— å‚æ„é€ ã€‚</p>
<blockquote>
<p>å› ä¸ºåœ¨æ‰§è¡Œå­ç±»çš„æ„é€ å‡½æ•°ä¹‹å‰ï¼Œå¦‚æœæ²¡æœ‰ç”¨ super() æ¥è°ƒç”¨çˆ¶ç±»ç‰¹å®šçš„æ„é€ å‡½æ•°ï¼Œåˆ™ä¼šè°ƒç”¨çˆ¶ç±»ä¸­â€œæ— å‚çš„æ„é€ å‡½æ•°â€ã€‚å¦‚æœçˆ¶ç±»ä¸­åªå®šä¹‰äº†æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè€Œåœ¨å­ç±»çš„æ„é€ æ–¹æ³•ä¸­åˆæ²¡æœ‰ç”¨ super() æ¥è°ƒç”¨çˆ¶ç±»ä¸­ç‰¹å®šçš„æ„é€ æ–¹æ³•ï¼Œåˆ™ç¼–è¯‘æ—¶å°†å‘ç”Ÿé”™è¯¯ï¼Œå› ä¸º Java ç¨‹åºåœ¨çˆ¶ç±»ä¸­æ‰¾ä¸åˆ°æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•å¯ä¾›æ‰§è¡Œã€‚è§£å†³åŠæ³•æ˜¯åœ¨çˆ¶ç±»é‡ŒåŠ ä¸Šä¸€ä¸ªä¸æ— å‚æ„é€ å‡½æ•°ã€‚</p>
</blockquote>
<h4 id="å’Œ-equals-çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#å’Œ-equals-çš„åŒºåˆ«"></a> <code>==</code> å’Œ <code>equals</code> çš„åŒºåˆ«</h4>
<ul>
<li>
<p>å¯¹äºåŸºæœ¬ç±»å‹</p>
<p><code>==</code> åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼ŒåŸºæœ¬ç±»å‹æ²¡æœ‰ <code>equals()</code> æ–¹æ³•ã€‚</p>
</li>
<li>
<p>å¯¹äºå¼•ç”¨ç±»å‹</p>
<p><code>==</code> åˆ¤æ–­ä¸¤ä¸ªå˜é‡æ˜¯å¦å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œ <code>equals()</code> åˆ¤æ–­å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦ç­‰ä»·ã€‚</p>
</li>
</ul>
<p><code>equals</code> çš„å®ç°åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>
<blockquote>
<ol>
<li>æ£€æŸ¥æ˜¯å¦ä¸ºåŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚æœæ˜¯ç›´æ¥è¿”å› trueï¼›</li>
<li>æ£€æŸ¥æ˜¯å¦æ˜¯åŒä¸€ä¸ªç±»å‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œç›´æ¥è¿”å› falseï¼›</li>
<li>å°† Object å¯¹è±¡è¿›è¡Œè½¬å‹ï¼›</li>
<li>åˆ¤æ–­æ¯ä¸ªå…³é”®åŸŸæ˜¯å¦ç›¸ç­‰ã€‚</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EqualExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> y;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> z;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EqualExample</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">        <span class="keyword">this</span>.z = z;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">      	<span class="comment">// 1. æ£€æŸ¥æ˜¯å¦ä¸ºåŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">      </span><br><span class="line">        <span class="comment">// 2. æ£€æŸ¥æ˜¯å¦åŒä¸€ç±»å‹</span></span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. è½¬å‹</span></span><br><span class="line">        EqualExample that = (EqualExample) o;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. åˆ¤æ–­å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦ç­‰ä»·ï¼Œå³åˆ¤æ–­å¯¹è±¡çš„æ¯ä¸ªå­—æ®µæ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        <span class="keyword">if</span> (x != that.x) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (y != that.y) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> z == that.z;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="hashcode"><a class="markdownIt-Anchor" href="#hashcode"></a> hashCode</h4>
<p><code>equals()</code> ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç­‰ä»·ï¼Œ<code>hashCode()</code> è¿”å›å¯¹è±¡çš„å“ˆå¸Œå€¼ã€‚</p>
<p>ç­‰ä»·çš„ä¸¤ä¸ªå¯¹è±¡å“ˆå¸Œå€¼ä¸€å®šç›¸ç­‰ï¼Œå“ˆå¸Œå€¼ç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç­‰ä»·ã€‚</p>
<p><code>HashSet</code> ã€<code>HashMap</code> ç­‰é›†åˆç±»ä½¿ç”¨ <code>hashCode()</code> è®¡ç®—å¯¹è±¡åº”è¯¥å­˜å‚¨çš„ä½ç½®ï¼Œä¸ºäº†æ­£å¸¸å·¥ä½œï¼Œè¦å­˜å…¥<code>HashSet</code> ã€<code>HashMap</code> ç­‰é›†åˆçš„ç±»ä¹Ÿè¦é‡å†™ <code>hashCode()</code> æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyString</span> </span>&#123;</span><br><span class="line">    String s;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyString</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.s = s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String a = <span class="keyword">new</span> String(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        String b = <span class="keyword">new</span> String(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        System.out.println(a.hashCode());  <span class="comment">// 96354</span></span><br><span class="line">        System.out.println(b.hashCode());  <span class="comment">// 96354</span></span><br><span class="line"></span><br><span class="line">        HashSet&lt;String&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        set.add(a);</span><br><span class="line">        set.add(b);</span><br><span class="line">        System.out.println(set.size());  <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">        MyString c = <span class="keyword">new</span> MyString(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        MyString d = <span class="keyword">new</span> MyString(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        System.out.println(c.hashCode());  <span class="comment">// 1846274136</span></span><br><span class="line">        System.out.println(d.hashCode());  <span class="comment">// 1639705018</span></span><br><span class="line"></span><br><span class="line">        HashSet&lt;MyString&gt; set1 = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        set1.add(c);</span><br><span class="line">        set1.add(d);</span><br><span class="line">        System.out.println(set1.size());  <span class="comment">// 2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>String</code> ç±»å®ç°äº† <code>hashCode()</code>ï¼Œä¿è¯äº†å¯¹è±¡ <code>a</code> å’Œ <code>b</code> çš„å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå› æ­¤åªä¼šåœ¨ <code>HashSet</code> ä¸­ä¿å­˜ä¸€ä¸ªï¼›</p>
<p>è€Œ <code>MyString</code> æ²¡æœ‰å®ç° <code>hashCode()</code>ï¼Œå¯¹è±¡ <code>c</code> å’Œ <code>d</code> çš„å“ˆå¸Œå€¼ä¸ç­‰ï¼Œä¸¤ä¸ªå°±éƒ½å­˜å…¥ <code>HashSet</code>ã€‚</p>
<h4 id="å€¼ä¼ é€’"><a class="markdownIt-Anchor" href="#å€¼ä¼ é€’"></a> å€¼ä¼ é€’</h4>
<p>Java ä¸­å‚æ•°ä¼ é€’æ–¹å¼åªæœ‰ä¸€ç§ï¼Œå°±æ˜¯å€¼ä¼ é€’ï¼Œä¸å­˜åœ¨å¼•ç”¨ä¼ é€’ã€‚</p>
<h4 id="string-å’Œ-å­—ç¬¦ä¸²å¸¸é‡æ± "><a class="markdownIt-Anchor" href="#string-å’Œ-å­—ç¬¦ä¸²å¸¸é‡æ± "></a> String å’Œ å­—ç¬¦ä¸²å¸¸é‡æ± </h4>
<p><code>String</code> è¢«å£°æ˜ä¸º <code>final</code>ï¼Œå› æ­¤ä¸èƒ½ç»§æ‰¿ã€‚</p>
<p>åœ¨ Java 8 ä¸­ï¼Œ<code>String</code> å†…éƒ¨ä½¿ç”¨ <code>char[]</code> æ•°ç»„å­˜å‚¨æ•°æ®ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> value[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ Java 9 ä¸­ï¼Œ<code>String</code> å†…éƒ¨æ”¹ç”¨ <code>byte[]</code> æ•°ç»„å­˜å‚¨æ•°æ®ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">byte</span>[] value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The identifier of the encoding used to encode the bytes in &#123;<span class="doctag">@code</span> value&#125;. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">byte</span> coder;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>value</code> æ•°ç»„è¢«å£°æ˜ä¸º <code>final</code>ï¼Œè¿™æ„å‘³ç€ <code>value</code> æ•°ç»„åˆå§‹åŒ–ä¹‹åå°±ä¸èƒ½å†å¼•ç”¨å…¶å®ƒæ•°ç»„ã€‚è€Œ <code>String</code> å†…éƒ¨æ²¡æœ‰æ”¹å˜ <code>value</code> æ•°ç»„å†…å®¹çš„æ–¹æ³•ï¼Œè¿™å°±ä¿è¯äº† <code>String</code> ä¸å¯å˜ã€‚</p>
<p><strong>å­—ç¬¦ä¸²å¸¸é‡æ± </strong></p>
<blockquote>
<p>ä¸ºäº†æä¾›æ‰§è¡Œæ•ˆç‡ï¼ŒJava ä¸º 8 ç§åŸºæœ¬ç±»å‹å’Œ <code>String</code> ç±»å‹æä¾›äº†å¸¸é‡æ± çš„æ¦‚å¿µã€‚</p>
<p>String Poolæ˜¯ä¸€ä¸ªå›ºå®šå¤§å°çš„ <code>Hashtable</code>ï¼Œé»˜è®¤å€¼å¤§å°é•¿åº¦æ˜¯1009ï¼Œå¦‚æœæ”¾è¿› String Poolçš„ Stringéå¸¸å¤šï¼Œå°±ä¼šé€ æˆ Hash å†²çªä¸¥é‡ï¼Œä»è€Œå¯¼è‡´é“¾è¡¨ä¼šå¾ˆé•¿ï¼Œè€Œé“¾è¡¨é•¿äº†åç›´æ¥ä¼šé€ æˆçš„å½±å“å°±æ˜¯è°ƒç”¨ <code>String.intern</code> æ—¶æ€§èƒ½ä¼šå¤§å¹…ä¸‹é™ã€‚</p>
</blockquote>
<blockquote>
<p>String Pool ä¿å­˜ç€æ‰€æœ‰å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆliteral stringsï¼‰ï¼Œè¿™äº›å­—é¢é‡åœ¨ç¼–è¯‘æ—¶æœŸå°±ç¡®å®šã€‚ä¸ä»…å¦‚æ­¤ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ String çš„ intern() æ–¹æ³•åœ¨è¿è¡Œè¿‡ç¨‹å°†å­—ç¬¦ä¸²æ·»åŠ åˆ° String Pool ä¸­ã€‚</p>
<p>å½“ä¸€ä¸ªå­—ç¬¦ä¸²è°ƒç”¨ intern() æ–¹æ³•æ—¶ï¼Œå¦‚æœ String Pool ä¸­å·²ç»å­˜åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²å’Œè¯¥å­—ç¬¦ä¸²å€¼ç›¸ç­‰ï¼ˆä½¿ç”¨ equals() æ–¹æ³•è¿›è¡Œç¡®å®šï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å› String Pool ä¸­å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼›å¦åˆ™ï¼Œå°±ä¼šåœ¨ String Pool ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›è¿™ä¸ªæ–°å­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚</p>
<p>åœ¨ Java 7 ä¹‹å‰ï¼ŒString Pool è¢«æ”¾åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ï¼Œå±äºæ°¸ä¹…ä»£ã€‚Java 7 ä¹‹åï¼ŒString Pool è¢«ç§»åˆ°å †ä¸­ã€‚å› ä¸ºæ°¸ä¹…ä»£çš„ç©ºé—´æœ‰é™ï¼Œåœ¨å¤§é‡ä½¿ç”¨å­—ç¬¦ä¸²çš„åœºæ™¯ä¸‹ä¼šå¯¼è‡´ OutOfMemoryError é”™è¯¯ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String s1 = <span class="keyword">new</span> String(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">String s2 = <span class="keyword">new</span> String(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">System.out.println(s1 == s2);  <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">String s3 = s1.intern();</span><br><span class="line">System.out.println(s3 == s1);  <span class="comment">// false</span></span><br><span class="line">String s4 = s2.intern();</span><br><span class="line">System.out.println(s3 == s4);  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">String s5 = <span class="string">&quot;abc&quot;</span>; </span><br><span class="line">System.out.println(s3 == s5);  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String s = <span class="keyword">new</span> String(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    System.out.println(System.identityHashCode(s)); <span class="comment">// 1846274136</span></span><br><span class="line">    System.out.println(System.identityHashCode(s.intern())); <span class="comment">// 1639705018</span></span><br><span class="line">    String s2 = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    System.out.println(System.identityHashCode(s2)); <span class="comment">// 1639705018</span></span><br><span class="line">    System.out.println(s == s2); <span class="comment">// jdk6: false  jdk7: false</span></span><br><span class="line"></span><br><span class="line">    String s3 = <span class="keyword">new</span> String(<span class="string">&quot;1&quot;</span>) + <span class="keyword">new</span> String(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    System.out.println(System.identityHashCode(s3)); <span class="comment">// 1627674070</span></span><br><span class="line">    System.out.println(System.identityHashCode(s3.intern())); <span class="comment">// 1627674070</span></span><br><span class="line">    String s4 = <span class="string">&quot;11&quot;</span>;</span><br><span class="line">    System.out.println(System.identityHashCode(s4)); <span class="comment">// 1627674070</span></span><br><span class="line">    System.out.println(s3 == s4); <span class="comment">// jdk6: false jdk7: true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">    String s = <span class="keyword">new</span> String(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    System.out.println(System.identityHashCode(s)); <span class="comment">// 1846274136</span></span><br><span class="line">    String s2 = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    System.out.println(System.identityHashCode(s2)); <span class="comment">// 1639705018</span></span><br><span class="line">    System.out.println(System.identityHashCode(s.intern())); <span class="comment">// 1639705018</span></span><br><span class="line">    System.out.println(s == s2); <span class="comment">// jdk6: false  jdk7: false</span></span><br><span class="line"></span><br><span class="line">    String s3 = <span class="keyword">new</span> String(<span class="string">&quot;1&quot;</span>) + <span class="keyword">new</span> String(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    System.out.println(System.identityHashCode(s3)); <span class="comment">// 1627674070</span></span><br><span class="line">    String s4 = <span class="string">&quot;11&quot;</span>;</span><br><span class="line">    System.out.println(System.identityHashCode(s4)); <span class="comment">// 1360875712</span></span><br><span class="line">    System.out.println(System.identityHashCode(s3.intern())); <span class="comment">// 1360875712</span></span><br><span class="line">    System.out.println(s3 == s4); <span class="comment">// jdk6: false jdk7: false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>new String(&quot;abc&quot;)</code> ä¼šåˆ›å»ºå‡ ä¸ªå¯¹è±¡ï¼Ÿ</p>
<blockquote>
<p>2 ä¸ª</p>
</blockquote>
<h4 id="åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å‹ä¸ç¼“å­˜æ± "><a class="markdownIt-Anchor" href="#åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å‹ä¸ç¼“å­˜æ± "></a> åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å‹ä¸ç¼“å­˜æ± </h4>
<p>åŸºæœ¬ç±»å‹éƒ½æœ‰å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼Œå¦‚ï¼šint ç±»å‹çš„åŒ…è£…ç±»å‹æ˜¯ Integerã€‚</p>
<p>å¯¹äºæ¯ç§åŒ…è£…ç±»å‹ï¼Œéƒ½æœ‰ä¸€ä¸ªç¼“å­˜æ± ï¼Œå¦‚ï¼šInteger ç¼“å­˜æ± é»˜è®¤å¤§å°æ˜¯ -128ï½127ã€‚</p>
<p>åŸºæœ¬ç±»å‹ä¸å¯¹åº”çš„åŒ…è£…ç±»å‹ä¹‹é—´çš„èµ‹å€¼é€šè¿‡è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±å®Œæˆã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Integer x = <span class="number">2</span>;     <span class="comment">// è£…ç®± è°ƒç”¨äº† Integer.valueOf(2)</span></span><br><span class="line"><span class="keyword">int</span> y = x;         <span class="comment">// æ‹†ç®± è°ƒç”¨äº† X.intValue()</span></span><br></pre></td></tr></table></figure>
<p><code>new Integer(123)</code> å’Œ <code>Integer.valueOf(123)</code> çš„åŒºåˆ«ï¼š</p>
<blockquote>
<ul>
<li><code>new Integer(123)</code> æ¯æ¬¡éƒ½ä¼šæ–°å»ºä¸€ä¸ªå¯¹è±¡ï¼›</li>
<li><code>Integer.valueOf(123)</code> ä¼šä½¿ç”¨ç¼“å­˜æ± ä¸­çš„å¯¹è±¡ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½è¿”å›åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</li>
</ul>
</blockquote>
<h4 id="æµ…æ‹·è´ä¸æ·±æ‹·è´"><a class="markdownIt-Anchor" href="#æµ…æ‹·è´ä¸æ·±æ‹·è´"></a> æµ…æ‹·è´ä¸æ·±æ‹·è´</h4>
<ul>
<li>
<p>æµ…æ‹·è´</p>
<blockquote>
<p>åªæ‹·è´å¯¹è±¡çš„åœ°å€ï¼Œå³åŸå¼•ç”¨å’Œæ‹·è´åçš„å¼•ç”¨æŒ‡å‘åŒä¸€å¯¹è±¡ã€‚</p>
</blockquote>
</li>
<li>
<p>æ·±æ‹·è´</p>
<blockquote>
<p>åˆ›å»ºæ–°çš„å¯¹è±¡ï¼ŒåŸå¼•ç”¨å’Œæ–°å¼•ç”¨æŒ‡å‘ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ã€‚</p>
</blockquote>
</li>
</ul>
<h4 id="åå°„"><a class="markdownIt-Anchor" href="#åå°„"></a> åå°„</h4>
<p>é€šè¿‡åå°„ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶è·å¾—ç¨‹åºä¸­æ¯ä¸€ä¸ªç±»å‹çš„æˆå‘˜å’Œæˆå‘˜çš„ä¿¡æ¯ã€‚</p>
<p><strong>è·å– <code>Class</code> å¯¹è±¡çš„ä¸‰ç§æ–¹å¼ï¼š</strong></p>
<ul>
<li>é€šè¿‡ç»§æ‰¿è‡ª <code>Object</code> ç±»çš„ <code>getClass()</code> æ–¹æ³•</li>
<li>é€šè¿‡æ¯ä¸ªæ•°æ®ç±»å‹ï¼ˆåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹ï¼‰é™æ€çš„ <code>class</code> å±æ€§</li>
<li>é€šè¿‡ <code>Class</code> ç±»é™æ€çš„ <code>forName(&quot;path&quot;)</code> æ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s = <span class="keyword">new</span> String(); </span><br><span class="line">        System.out.println(s.getClass());  <span class="comment">// class java.lang.String</span></span><br><span class="line">        System.out.println(String.class);  <span class="comment">// class java.lang.String</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(Class.forName(<span class="string">&quot;com.tw.Main&quot;</span>));  <span class="comment">// class com.tw.Main</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>åˆ¤æ–­æ˜¯å¦ä¸ºæŸä¸ªç±»çš„å®ä¾‹</strong>:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String s = <span class="keyword">new</span> String();</span><br><span class="line"></span><br><span class="line">    System.out.println(s <span class="keyword">instanceof</span> String);  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">    Class clazz = s.getClass();</span><br><span class="line"></span><br><span class="line">    System.out.println(clazz.isInstance(s));  <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>åˆ›å»ºå®ä¾‹ï¼š</strong></p>
<ul>
<li>é€šè¿‡ <code>Class</code> ç±»çš„ <code>newInstance()</code> æ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; clazz = String.class;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String s = (String) clazz.newInstance();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InstantiationException | IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡ <code>Constructor</code> ç±»çš„ <code>newInstance()</code> æ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; clazz = String.class;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Constructor&lt;?&gt; constructor = clazz.getConstructor(String.class);</span><br><span class="line">        String s = (String) constructor.newInstance(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoSuchMethodException | IllegalAccessException | InstantiationException | InvocationTargetException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯å¯ä»¥ç”¨æŒ‡å®šçš„æ„é€ èµ·åˆ›å»ºå¯¹è±¡ã€‚</p>
<p><strong>è·å–å’Œä½¿ç”¨æ–¹æ³•ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿”å›ç±»æˆ–æ¥å£å£°æ˜çš„æ‰€æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬å…¬å…±ã€ä¿æŠ¤ã€é»˜è®¤ï¼ˆåŒ…ï¼‰è®¿é—®å’Œç§æœ‰æ–¹æ³•ï¼Œä½†ä¸åŒ…æ‹¬ç»§æ‰¿çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> Method[] getDeclaredMethods() <span class="keyword">throws</span> SecurityException</span><br><span class="line">  </span><br><span class="line"><span class="comment">// è¿”å›æŸä¸ªç±»çš„æ‰€æœ‰å…¬ç”¨ï¼ˆpublicï¼‰æ–¹æ³•ï¼ŒåŒ…æ‹¬å…¶ç»§æ‰¿ç±»çš„å…¬ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> Method[] getMethods() <span class="keyword">throws</span> SecurityException</span><br><span class="line">  </span><br><span class="line"><span class="comment">// è¿”å›ä¸€ä¸ªç‰¹å®šçš„æ–¹æ³•ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–¹æ³•åç§°ï¼Œåé¢çš„å‚æ•°ä¸ºæ–¹æ³•çš„å‚æ•°å¯¹åº”Classçš„å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Method <span class="title">getMethod</span><span class="params">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object obj, Object... args)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> IllegalAccessException, IllegalArgumentException,</span></span><br><span class="line"><span class="function">           InvocationTargetException</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; clazz = ArrayList.class;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ArrayList list = (ArrayList) clazz.newInstance();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            list.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">        Method method = clazz.getMethod(<span class="string">&quot;get&quot;</span>, <span class="keyword">int</span>.class);</span><br><span class="line">        System.out.println(method.invoke(list, <span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InstantiationException | IllegalAccessException | NoSuchMethodException | InvocationTargetException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ³›å‹"><a class="markdownIt-Anchor" href="#æ³›å‹"></a> æ³›å‹</h4>
<p>æ³›å‹æ˜¯ä¸€ç§å‚æ•°åŒ–ç±»å‹çš„æœºåˆ¶ï¼Œæä¾›äº†ç¼–è¯‘æœŸçš„ç±»å‹å®‰å…¨ï¼Œç¡®ä¿åªèƒ½æŠŠæ­£ç¡®ç±»å‹çš„å¯¹è±¡æ”¾å…¥é›†åˆä¸­ï¼Œä»è€Œé¿å…äº†åœ¨è¿è¡Œæ—¶å‡ºç°<code>ClassCastException</code>ã€‚</p>
<ul>
<li>
<p>Java æ³›å‹çš„å·¥ä½œåŸç†</p>
</li>
<li>
<p>ä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤</p>
<blockquote>
<p>é¿å…ç±»å‹è†¨èƒ€ã€‚</p>
</blockquote>
</li>
<li>
<p>æ³›å‹ä¸­çš„é€šé…ç¬¦</p>
<ul>
<li>
<p>é™å®šé€šé…ç¬¦</p>
<p>å¯¹ç±»å‹è¿›è¡Œäº†é™åˆ¶ï¼Œæœ‰ä¸¤ç§é™å®šé€šé…ç¬¦ï¼š</p>
<ol>
<li>
<p><code>List&lt;? extends T&gt;</code></p>
<blockquote>
<p>é€šè¿‡é™å®šç±»å‹å¿…é¡»æ˜¯ <code>T</code> çš„å­ç±»æ¥è®¾å®šç±»å‹çš„ä¸Šç•Œ</p>
</blockquote>
</li>
<li>
<p><code>List&lt;? super T&gt;</code></p>
<blockquote>
<p>é€šè¿‡é™å®šç±»å‹å¿…é¡»æ˜¯ <code>T</code> çš„çˆ¶ç±»æ¥è®¾å®šç±»å‹çš„ä¸‹ç•Œ</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p>é™å®šé€šé…ç¬¦ <code>&lt;?&gt;</code></p>
</li>
</ul>
</li>
<li>
<p>å’Œ</p>
</li>
<li>
<p>å¯ä»¥æŠŠ <code>List&lt;String&gt;</code> ä¼ é€’ç»™ä¸€ä¸ªæ¥å— <code>List&lt;Object&gt;</code> å‚æ•°çš„æ–¹æ³•å—</p>
<blockquote>
<p>ä¸èƒ½ã€‚</p>
<p>ä½†æ˜¯å¯ä»¥ä¼ é€’ç»™æ¥å— <code>List</code> æˆ– <code>List&lt;?&gt;</code> å‚æ•°çš„æ–¹æ³•ã€‚</p>
</blockquote>
</li>
<li>
<p><code>Array</code> ä¸­å¯ä»¥ç”¨æ³›å‹å—</p>
<blockquote>
<p>ä¸èƒ½</p>
</blockquote>
</li>
</ul>
<h4 id="java-8-æ–°ç‰¹æ€§"><a class="markdownIt-Anchor" href="#java-8-æ–°ç‰¹æ€§"></a> Java 8 æ–°ç‰¹æ€§</h4>
<ol>
<li>
<p>æ¥å£çš„é»˜è®¤æ–¹æ³•</p>
<blockquote>
<p>Java 8 å…è®¸ä¸ºæ¥å£æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•å®ç°ï¼Œç”¨ <code>default</code> å…³é”®å­—ä¿®é¥°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   	<span class="comment">// ...</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li>
<p>å‡½æ•°å¼ç¼–ç¨‹</p>
<ul>
<li>Lambda è¡¨è¾¾å¼</li>
<li>æ–¹æ³•å¼•ç”¨</li>
<li>å‡½æ•°å¼æ¥å£</li>
</ul>
</li>
<li>
<p>æµç¼–ç¨‹</p>
</li>
</ol>
<h4 id="java-ä¸-c-çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#java-ä¸-c-çš„åŒºåˆ«"></a> Java ä¸ C++ çš„åŒºåˆ«</h4>
<ol>
<li>
<p>çº¯é¢å‘å¯¹è±¡</p>
<blockquote>
<p>Java æ˜¯çº¯ç²¹çš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ç»§æ‰¿è‡ª java.lang.Objectï¼›</p>
<p>C++ ä¸ºäº†å…¼å®¹ C å³æ”¯æŒé¢å‘å¯¹è±¡ä¹Ÿæ”¯æŒé¢å‘è¿‡ç¨‹ã€‚</p>
</blockquote>
</li>
<li>
<p>è·¨å¹³å°</p>
<blockquote>
<p>Java é€šè¿‡è™šæ‹Ÿæœºä»è€Œå®ç°è·¨å¹³å°ç‰¹æ€§ï¼›</p>
<p>C++ ä¾èµ–äºç‰¹å®šçš„å¹³å°ã€‚</p>
</blockquote>
</li>
<li>
<p>æŒ‡é’ˆ</p>
<blockquote>
<p>Java æ²¡æœ‰æŒ‡é’ˆï¼Œå®ƒçš„å¼•ç”¨å¯ä»¥ç†è§£ä¸ºå®‰å…¨æŒ‡é’ˆï¼›</p>
<p>C++ å…·æœ‰å’Œ C ä¸€æ ·çš„æŒ‡é’ˆã€‚</p>
</blockquote>
</li>
<li>
<p>åƒåœ¾å›æ”¶</p>
<blockquote>
<p>Java æ”¯æŒè‡ªåŠ¨åƒåœ¾å›æ”¶ï¼›</p>
<p>C++ éœ€è¦æ‰‹åŠ¨å›æ”¶ã€‚</p>
</blockquote>
</li>
<li>
<p>å¤šé‡ç»§æ‰¿</p>
<blockquote>
<p>Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œä½†å¯ä»¥é€šè¿‡å®ç°å¤šä¸ªæ¥å£æ¥è¾¾åˆ°ç›¸åŒç›®çš„ï¼›</p>
<p>C++ æ”¯æŒå¤šé‡ç»§æ‰¿ã€‚</p>
</blockquote>
</li>
<li>
<p>æ“ä½œç¬¦é‡è½½</p>
<blockquote>
<p>Java ä¸æ”¯æŒæ“ä½œç¬¦é‡è½½ï¼›</p>
<p>C++ å¯ä»¥ã€‚</p>
</blockquote>
</li>
</ol>
<h4 id="å¯¹è±¡çš„åˆå§‹åŒ–"><a class="markdownIt-Anchor" href="#å¯¹è±¡çš„åˆå§‹åŒ–"></a> å¯¹è±¡çš„åˆå§‹åŒ–</h4>
<p>å‡è®¾æœ‰ä¸ª <code>Dog</code> ç±»ï¼Œæ‰§è¡Œ <code>new Dog()</code> ä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>
<p>å¦‚æœæ˜¯<strong>é¦–æ¬¡åˆ›å»º <code>Dog</code> ç±»å‹çš„å¯¹è±¡</strong>æˆ–æ˜¯<strong>é¦–æ¬¡è®¿é—® <code>Dog</code> ç±»çš„é™æ€æ–¹æ³•æˆ–å±æ€§</strong>æ—¶ï¼ŒJVM æŸ¥æ‰¾å¹¶åŠ è½½ <code>Dog.class</code>ã€‚</p>
</li>
<li>
<p>åŠ è½½å®Œ <code>Dog.class</code> åï¼Œæ‰§è¡Œé™æ€åˆå§‹åŒ–è¯­å¥ï¼ˆå—ï¼‰ï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰ã€‚</p>
</li>
<li>
<p>åœ¨å †ä¸Šä¸º <code>Dog</code> åˆ†é…è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ã€‚</p>
</li>
<li>
<p>åˆ†é…çš„å­˜å‚¨ç©ºé—´é¦–å…ˆä¼šè¢«æ¸…é›¶ï¼Œå³ä¼šå°† <code>Dog</code> å¯¹è±¡ä¸­çš„æ‰€æœ‰åŸºæœ¬ç±»å‹æ•°æ®è®¾ç½®ä¸ºé»˜è®¤å€¼ï¼Œå¼•ç”¨è¢«ç½®ä¸º <code>null</code>ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œæ‰€æœ‰çš„åˆå§‹åŒ–è¯­å¥ï¼ˆå—ï¼‰ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œæ„é€ å™¨ã€‚</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InitializeDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Mug mug1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Mug mug2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ‰§è¡Œæ™®é€šåˆå§‹åŒ–è¯­å¥ï¼ˆå—ï¼‰ï¼Œæ¯ new ä¸€ä¸ªå¯¹è±¡å°±æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    &#123;</span><br><span class="line">        mug1 = <span class="keyword">new</span> Mug(<span class="number">1</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;mug1 initialized&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// 1. æ‰§è¡Œé™æ€åˆå§‹åŒ–è¯­å¥ï¼ˆå—ï¼‰ï¼Œåªæ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        mug2 = <span class="keyword">new</span> Mug(<span class="number">2</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;mug2 initialized&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. æ‰§è¡Œæ„é€ å™¨</span></span><br><span class="line">    InitializeDemo() &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;InitializeDemo()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    InitializeDemo(<span class="keyword">int</span> i) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;InitializeDemo(int)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Inside main()&quot;</span>);</span><br><span class="line">        <span class="keyword">new</span> InitializeDemo();</span><br><span class="line">        System.out.println(<span class="string">&quot;new InitializeDemo() completed&quot;</span>);</span><br><span class="line">        <span class="keyword">new</span> InitializeDemo(<span class="number">1</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;new InitializeDemo(1) completed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mug</span> </span>&#123;</span><br><span class="line">    Mug(<span class="keyword">int</span> marker) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Mug(&quot;</span> + marker + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>JavaåŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaå®¹å™¨</title>
    <url>/archives/58b717aa.html</url>
    <content><![CDATA[<h3 id="æ¦‚è§ˆ"><a class="markdownIt-Anchor" href="#æ¦‚è§ˆ"></a> æ¦‚è§ˆ</h3>
<p>Java å®¹å™¨ä¸»è¦åŒ…æ‹¬ <code>Collection</code> å’Œ <code>Map</code>ã€‚</p>
<h4 id="collection"><a class="markdownIt-Anchor" href="#collection"></a> Collection</h4>
<p><img data-src="/archives/58b717aa/Collection.png" alt="Collection"></p>
<span id="more"></span>
<ol>
<li><strong>Set</strong></li>
</ol>
<ul>
<li>TreeSetï¼šåŸºäº<strong>çº¢é»‘æ ‘</strong>å®ç°ï¼Œæ”¯æŒæœ‰åºæ€§æ“ä½œï¼Œä¾‹å¦‚æ ¹æ®ä¸€ä¸ªèŒƒå›´æŸ¥æ‰¾å…ƒç´ çš„æ“ä½œã€‚ä½†æ˜¯æŸ¥æ‰¾æ•ˆç‡ä¸å¦‚ HashSetï¼ŒHashSet æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼ŒTreeSet åˆ™ä¸º O(logN)ã€‚</li>
<li>HashSetï¼šåŸºäº<strong>å“ˆå¸Œè¡¨</strong>å®ç°ï¼Œæ”¯æŒå¿«é€ŸæŸ¥æ‰¾ï¼Œä½†ä¸æ”¯æŒæœ‰åºæ€§æ“ä½œã€‚å¹¶ä¸”å¤±å»äº†å…ƒç´ çš„æ’å…¥é¡ºåºä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨ Iterator éå† HashSet å¾—åˆ°çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚</li>
<li>LinkedHashSetï¼šå…·æœ‰ HashSet çš„æŸ¥æ‰¾æ•ˆç‡ï¼Œå¹¶ä¸”å†…éƒ¨ä½¿ç”¨<strong>åŒå‘é“¾è¡¨</strong>ç»´æŠ¤å…ƒç´ çš„æ’å…¥é¡ºåºã€‚</li>
</ul>
<ol start="2">
<li><strong>List</strong></li>
</ol>
<ul>
<li>ArrayListï¼šåŸºäº<strong>åŠ¨æ€æ•°ç»„</strong>å®ç°ï¼Œæ”¯æŒéšæœºè®¿é—®ã€‚</li>
<li>Vectorï¼šå’Œ ArrayList ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„ã€‚</li>
<li>LinkedListï¼šåŸºäº<strong>åŒå‘é“¾è¡¨</strong>å®ç°ï¼Œåªèƒ½é¡ºåºè®¿é—®ï¼Œä½†æ˜¯å¯ä»¥å¿«é€Ÿåœ°åœ¨é“¾è¡¨ä¸­é—´æ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚ä¸ä»…å¦‚æ­¤ï¼ŒLinkedList è¿˜å¯ä»¥ç”¨ä½œæ ˆã€é˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—ã€‚</li>
</ul>
<ol start="3">
<li><strong>Queue</strong></li>
</ol>
<ul>
<li>LinkedListï¼šå¯ä»¥ç”¨å®ƒæ¥å®ç°åŒå‘é˜Ÿåˆ—ã€‚</li>
<li>PriorityQueueï¼šåŸºäºå †ç»“æ„å®ç°ï¼Œå¯ä»¥ç”¨å®ƒæ¥å®ç°ä¼˜å…ˆé˜Ÿåˆ—ã€‚</li>
</ul>
<h4 id="map"><a class="markdownIt-Anchor" href="#map"></a> Map</h4>
<p><img data-src="/archives/58b717aa/Map.png" alt="Map"></p>
<ul>
<li>TreeMapï¼šåŸºäº<strong>çº¢é»‘æ ‘</strong>å®ç°ã€‚</li>
<li>HashMapï¼šåŸºäº<strong>å“ˆå¸Œè¡¨</strong>å®ç°ã€‚</li>
<li>HashTableï¼šå’Œ HashMap ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„ï¼Œè¿™æ„å‘³ç€åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™å…¥ HashTable ä¸ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚å®ƒæ˜¯é—ç•™ç±»ï¼Œä¸åº”è¯¥å»ä½¿ç”¨å®ƒï¼Œè€Œæ˜¯ä½¿ç”¨ ConcurrentHashMap æ¥æ”¯æŒçº¿ç¨‹å®‰å…¨ï¼ŒConcurrentHashMap çš„æ•ˆç‡ä¼šæ›´é«˜ï¼Œå› ä¸º <strong>ConcurrentHashMap å¼•å…¥äº†åˆ†æ®µé”</strong>ã€‚</li>
<li>LinkedHashMapï¼šä½¿ç”¨åŒå‘é“¾è¡¨æ¥ç»´æŠ¤å…ƒç´ çš„é¡ºåºï¼Œé¡ºåºä¸ºæ’å…¥é¡ºåºæˆ–è€…æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰é¡ºåºã€‚</li>
</ul>
<h3 id="æºç åˆ†æ"><a class="markdownIt-Anchor" href="#æºç åˆ†æ"></a> æºç åˆ†æ</h3>
<h4 id="arraylist"><a class="markdownIt-Anchor" href="#arraylist"></a> ArrayList</h4>
<p>åŸºäºæ•°ç»„å®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é»˜è®¤å®¹é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è°ƒç”¨å¸¦å‚æ„é€ å‡½æ•°æ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°æ—¶ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æ¥å­˜å‚¨æ•°æ®çš„æ•°ç»„ï¼Œå¦‚æœ elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATAï¼Œ</span></span><br><span class="line"><span class="comment"> * åˆ™åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªæ•°æ®å ArrayList çš„é»˜è®¤å®¹é‡å°±ä¸º DEFAULT_CAPACITY</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Object[] elementData; <span class="comment">// non-private to simplify nested class access</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒ…å«çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> size;</span><br></pre></td></tr></table></figure>
<p><strong>æ·»åŠ å…ƒç´ </strong></p>
<p>æ·»åŠ å…ƒç´ æ—¶ä½¿ç”¨ <code>ensureCapacityInternal()</code> æ–¹æ³•æ¥ä¿è¯å®¹é‡è¶³å¤Ÿï¼Œå¦‚æœä¸å¤Ÿï¼Œä½¿ç”¨ <code>grow()</code> æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œæ–°å®¹é‡çš„å¤§å°ä¸º <code>oldCapacity + (oldCapacity &gt;&gt; 1)</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateCapacity</span><span class="params">(Object[] elementData, <span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> minCapacity;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">        grow(minCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Fail-Fast</strong></p>
<p><code>modCount</code> ç”¨æ¥è®°å½• <code>ArrayList</code> ç»“æ„å‘ç”Ÿå˜åŒ–çš„æ¬¡æ•°ã€‚ç»“æ„å‘ç”Ÿå˜åŒ–æ˜¯æŒ‡æ·»åŠ æˆ–è€…åˆ é™¤è‡³å°‘ä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰æ“ä½œï¼Œæˆ–è€…æ˜¯è°ƒæ•´å†…éƒ¨æ•°ç»„çš„å¤§å°ï¼Œä»…ä»…åªæ˜¯è®¾ç½®å…ƒç´ çš„å€¼ä¸ç®—ç»“æ„å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>åœ¨è¿›è¡Œåºåˆ—åŒ–æˆ–è€…è¿­ä»£ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ¯”è¾ƒæ“ä½œå‰å <code>modCount</code> æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœæ”¹å˜äº†éœ€è¦æŠ›å‡º <code>ConcurrentModificationException</code>ã€‚</p>
<p><strong>ä¸ <code>Vector</code> çš„æ¯”è¾ƒ</strong></p>
<ul>
<li><code>Vector</code> æ˜¯åŒæ­¥çš„ï¼Œå¼€é”€æ¯” <code>ArrayList</code> è¦å¤§ã€‚æœ€å¥½ä½¿ç”¨ <code>ArrayList</code> è€Œä¸æ˜¯ <code>Vector</code>ï¼Œå› ä¸ºåŒæ­¥æ“ä½œå¯ä»¥ç”±ç¨‹åºå‘˜è‡ªå·±æ¥æ§åˆ¶ï¼›</li>
<li><code>Vector</code> å¦‚æœä¸å¸¦å‚æ•°ï¼Œæ‰©å®¹é»˜è®¤æ˜¯åŸæ¥å¤§å°çš„ 2 å€ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°è®¾ç½®å¢é•¿çš„å®¹é‡ï¼‰ï¼Œè€Œ <code>ArrayList</code> æ˜¯ 1.5 å€ã€‚</li>
</ul>
<h4 id="linkedlist"><a class="markdownIt-Anchor" href="#linkedlist"></a> LinkedList</h4>
<p>åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œä½¿ç”¨ <code>Node</code> å­˜å‚¨èŠ‚ç‚¹ä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"></span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.item = element;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">        <span class="keyword">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸ <code>ArrayList</code> çš„æ¯”è¾ƒ</strong></p>
<p><code>ArrayList</code> åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œ<code>LinkedList</code> åŸºäºåŒå‘é“¾è¡¨å®ç°ã€‚<code>ArrayList</code> å’Œ <code>LinkedList</code> çš„åŒºåˆ«å¯ä»¥å½’ç»“ä¸ºæ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«ï¼š</p>
<ul>
<li>æ•°ç»„æ”¯æŒéšæœºè®¿é—®ï¼Œä½†æ’å…¥åˆ é™¤çš„ä»£ä»·å¾ˆé«˜ï¼Œéœ€è¦ç§»åŠ¨å¤§é‡å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <code>O(N)</code>ï¼›</li>
<li>é“¾è¡¨ä¸æ”¯æŒéšæœºè®¿é—®ï¼Œä½†æ’å…¥åˆ é™¤åªéœ€è¦æ”¹å˜å‡ ä¸ªæŒ‡é’ˆæŒ‡å‘ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <code>O(1)</code>ã€‚</li>
</ul>
<h4 id="copyonwritelist"><a class="markdownIt-Anchor" href="#copyonwritelist"></a> CopyOnWriteList</h4>
<p><strong>è¯»å†™åˆ†ç¦»</strong></p>
<ul>
<li>
<p>å†™æ“ä½œåœ¨ä¸€ä¸ª<strong>å¤åˆ¶æ•°ç»„</strong>ä¸Šè¿›è¡Œï¼Œè¯»æ“ä½œè¿˜æ˜¯åœ¨åŸå§‹æ•°ç»„ä¸­è¿›è¡Œï¼Œè¯»å†™åˆ†ç¦»ï¼Œäº’ä¸å½±å“ã€‚</p>
</li>
<li>
<p>å†™æ“ä½œéœ€è¦<strong>åŠ é”</strong>ï¼Œé˜²æ­¢å¹¶å‘å†™å…¥æ—¶å¯¼è‡´å†™å…¥æ•°æ®ä¸¢å¤±ã€‚</p>
</li>
<li>
<p>å†™æ“ä½œç»“æŸä¹‹åéœ€è¦<strong>æŠŠåŸå§‹æ•°ç»„æŒ‡å‘å¤åˆ¶æ•°ç»„</strong>ã€‚</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</span><br><span class="line">    lock.lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Object[] elements = getArray();</span><br><span class="line">        <span class="keyword">int</span> len = elements.length;</span><br><span class="line">        Object[] newElements = Arrays.copyOf(elements, len + <span class="number">1</span>);</span><br><span class="line">        newElements[len] = e;</span><br><span class="line">        setArray(newElements);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setArray</span><span class="params">(Object[] a)</span> </span>&#123;</span><br><span class="line">    array = a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>CopyOnWriteArrayList</code> åœ¨å†™æ“ä½œçš„åŒæ—¶å…è®¸è¯»æ“ä½œï¼Œå¤§å¤§æé«˜äº†è¯»æ“ä½œçš„æ€§èƒ½ï¼Œå› æ­¤å¾ˆ<strong>é€‚åˆè¯»å¤šå†™å°‘çš„åº”ç”¨åœºæ™¯</strong>ã€‚</p>
<p><strong>ç¼ºé™·</strong>ï¼š</p>
<ul>
<li>å†…å­˜å ç”¨ï¼šåœ¨å†™æ“ä½œæ—¶éœ€è¦å¤åˆ¶ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œä½¿å¾—å†…å­˜å ç”¨ä¸ºåŸæ¥çš„ä¸¤å€å·¦å³ï¼›</li>
<li>æ•°æ®ä¸ä¸€è‡´ï¼šè¯»æ“ä½œä¸èƒ½è¯»å–å®æ—¶æ€§çš„æ•°æ®ï¼Œå› ä¸ºéƒ¨åˆ†å†™æ“ä½œçš„æ•°æ®è¿˜æœªåŒæ­¥åˆ°è¯»æ•°ç»„ä¸­ã€‚</li>
</ul>
<h4 id="hashmap"><a class="markdownIt-Anchor" href="#hashmap"></a> HashMap</h4>
<p>åŸºäº <strong>æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</strong> å®ç°</p>
<p><strong>å­˜å‚¨ç»“æ„</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;  <span class="comment">// å®šä½ Node[] table ç´¢å¼•ä½ç½®</span></span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    V value;</span><br><span class="line">    Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">    Node(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç¡®å®šç´¢å¼•ä½ç½®</strong></p>
<p>ä¸ç®¡å¢åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾é”®å€¼å¯¹ï¼Œå®šä½åˆ°å“ˆå¸Œæ¡¶æ•°ç»„çš„ä½ç½®éƒ½æ˜¯å¾ˆå…³é”®çš„ç¬¬ä¸€æ­¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦å®šä½åˆ°ç´¢å¼•ä½ç½®ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯ç”¨å…¶ <code>hashCode</code> å€¼å¯¹ <code>HashMap</code> çš„æ•°ç»„é•¿åº¦è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œä½†æ˜¯å–æ¨¡è¿ç®—æ•ˆç‡è¾ƒä½ï¼Œ<code>HashMap</code> é€šè¿‡ä½è¿ç®—æ¥è·å–ç´¢å¼•ä½ç½®ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">               <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç´¢å¼•ä½ç½®çš„è®¡ç®—æ–¹å¼æ˜¯ <code>i = (n - 1) &amp; hash</code>ï¼Œè€Œ <code>HashMap</code> ä¸­ <code>n = tab.length</code> æ€»æ˜¯ 2 çš„å¹‚æ–¹ï¼Œä¿è¯äº† <code>(n - 1) &amp; hash</code> ä¸ <code>hash % n</code> çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ <code>&amp;</code> è¿ç®—æ•ˆç‡æ¯” <code>%</code> è¿ç®—æ›´é«˜ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>HashMap</code> çš„ <code>capacity</code> æ€»æ˜¯ 2 çš„å¹‚æ–¹çš„åŸå› ã€‚</p>
<p><strong><code>put()</code> æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">               <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­ table æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">// è®¡ç®—ç´¢å¼•ä½ç½® iï¼Œå¹¶åˆ¤æ–­ p = tab[i] æ˜¯å¦ä¸ºç©ºã€‚æ˜¯ï¼Œç›´æ¥æ’å…¥æ–°èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">      	<span class="comment">// åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦å·²ç»å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">        		e = p;</span><br><span class="line">      	<span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">          	<span class="comment">// 	éå†é“¾è¡¨</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">              	<span class="comment">// å°¾æ’å…¥</span></span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                  	<span class="comment">// é“¾è¡¨é•¿åº¦å¦‚æœå¤§äºé˜ˆå€¼ï¼Œè½¬ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">              	<span class="comment">// æ‰¾åˆ°å·²å­˜åœ¨çš„èŠ‚ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      	<span class="comment">// 	å·²å­˜åœ¨èŠ‚ç‚¹ï¼Œæ›´æ–° value</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount;</span><br><span class="line">  	<span class="comment">// size åŠ ä¸€ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ‰©å®¹</strong></p>
<p>å’Œæ‰©å®¹æœ‰å…³çš„ä¸»è¦å‚æ•°</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>capacity</code></td>
<td><code>table</code> çš„å®¹é‡å¤§å°ï¼Œé»˜è®¤ä¸º 16ã€‚ <code>capacity</code> ä¿è¯ä¸º 2 çš„ n æ¬¡æ–¹ã€‚</td>
</tr>
<tr>
<td><code>size</code></td>
<td>é”®å€¼å¯¹æ•°é‡</td>
</tr>
<tr>
<td><code>loadFactor</code></td>
<td>è£…è½½å› å­ã€‚<code>table</code> ä½¿ç”¨æ¯”ä¾‹ã€‚</td>
</tr>
<tr>
<td><code>threshold</code></td>
<td><code>size</code> çš„ä¸´ç•Œå€¼ï¼Œå½“ <code>size &gt;= threshold</code> è¿›è¡Œæ‰©å®¹æ“ä½œã€‚<code>threshold</code> = (<code>capacity * loadFactor</code>)</td>
</tr>
</tbody>
</table>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Initializes or doubles table size. If null, allocates in accord with initial capacity target held in field threshold. Otherwise, because we are using power-of-two expansion, the elements from each bin must either stay at same index, or move with a power of two offset in the new table.</span></span><br><span class="line"><span class="comment">Returns: the table</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">    <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">    <span class="keyword">int</span> oldThr = threshold;</span><br><span class="line">    <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœåŸæœ‰å®¹é‡å·²ç»æ˜¯ MAXIMUM_CAPACITYï¼Œä¿®æ”¹ thresholdï¼Œè¿™æ ·ä¹‹åå°±ä¸ä¼šå†æœ‰æ‰©å®¹æ“ä½œ</span></span><br><span class="line">        <span class="comment">// ç„¶åç›´æ¥è¿”å›æ—§æ•°ç»„ï¼Œä¸æ‰©å®¹</span></span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">      	<span class="comment">// å¦åˆ™ï¼Œæ–°å®¹é‡å’Œæ–° threshold éƒ½æ‰©å¤§ä¸€å€</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line">  	<span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">           Node&lt;K,V&gt; e;</span><br><span class="line">           <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">               oldTab[j] = <span class="keyword">null</span>;</span><br><span class="line">               <span class="keyword">if</span> (e.next == <span class="keyword">null</span>)</span><br><span class="line">                   newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">               <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                   ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">               <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                   Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                   Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ Java 1.7ï¼Œ<code>HashMap</code> æ‰©å®¹åï¼ŒåŒä¸€æ¡é“¾è¡¨ä¸Šçš„å…ƒç´ éœ€è¦é€šè¿‡é‡æ–°è®¡ç®—ç´¢å¼•ä½ç½®åï¼Œæ‰èƒ½çŸ¥é“ä¼šè¢«æ”¾åœ¨æ–°æ•°ç»„çš„å“ªä¸ªä½ç½®ã€‚</p>
<p>è€Œåœ¨ Java 1.8 ä¸­ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—ç´¢å¼•ä½ç½®ï¼Œåªéœ€åˆ¤æ–­ä¹‹å‰è®¡ç®—å¾—åˆ°çš„ <code>hashCode</code> çš„ä¸‹ä¸€ä½æ˜¯ 0 è¿˜æ˜¯ 1ï¼Œå³å¯çŸ¥é“åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ã€‚è¿™é‡Œä¼˜åŒ–åŒ…æ‹¬ï¼š</p>
<ul>
<li>çœå»é‡æ–°è®¡ç®—ç´¢å¼•ä½ç½®çš„æ—¶é—´ï¼›</li>
<li>æ—§æ•°ç»„æ¯ä¸ªç´¢å¼•ä½ç½®ä¸‹çš„é“¾è¡¨æˆ–çº¢é»‘æ ‘ä¸­çš„èŠ‚ç‚¹ä¼šæ¯”è¾ƒå‡åŒ€åœ°é‡æ–°åˆ’åˆ†åˆ°æ–°æ•°ç»„ä¸­ã€‚</li>
</ul>
<p><strong>ä¸ <code>Hashtable</code> çš„æ¯”è¾ƒ</strong></p>
<ul>
<li><code>Hashtable</code> ä½¿ç”¨ <code>synchronized</code> æ¥è¿›è¡ŒåŒæ­¥ã€‚</li>
<li><code>HashMap</code> å¯ä»¥æ’å…¥é”®ä¸º <code>null</code> çš„ <code>Entry</code>ã€‚</li>
<li><code>HashMap</code> çš„è¿­ä»£å™¨æ˜¯ <code>fail-fast</code> è¿­ä»£å™¨ã€‚</li>
<li><code>HashMap</code> ä¸èƒ½ä¿è¯éšç€æ—¶é—´çš„æ¨ç§» <code>Map</code> ä¸­çš„å…ƒç´ æ¬¡åºæ˜¯ä¸å˜çš„ã€‚</li>
</ul>
<h4 id="concurrenthashmap"><a class="markdownIt-Anchor" href="#concurrenthashmap"></a> ConcurrentHashMap</h4>
<p><code>ConcurrentHashMap</code> å’Œ <code>HashMap</code> å®ç°ä¸Šç±»ä¼¼ï¼Œæœ€ä¸»è¦çš„å·®åˆ«æ˜¯ <code>ConcurrentHashMap</code> é‡‡ç”¨äº†åˆ†æ®µé”ï¼ˆ<code>Segment</code>ï¼‰ï¼Œæ¯ä¸ªåˆ†æ®µé”ç»´æŠ¤ç€å‡ ä¸ªæ¡¶ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ä¸åŒåˆ†æ®µé”ä¸Šçš„æ¡¶ï¼Œä»è€Œä½¿å…¶å¹¶å‘åº¦æ›´é«˜ï¼ˆå¹¶å‘åº¦å°±æ˜¯ <code>Segment</code> çš„ä¸ªæ•°ï¼‰ã€‚</p>
<p><code>Segment</code> ç»§æ‰¿è‡ª <code>ReentrantLock</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸ <code>HashMap</code> çš„æ¯”è¾ƒ</p>
<ul>
<li>Java 1.7 ä¹‹å‰ <code>ConcurrentHashMap</code>å¯¹æ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†æ®µ(<code>Segment</code>)ï¼Œæ¯ä¸€ä¸ªåˆ†æ®µä¸Šéƒ½ç”¨ <code>lock</code> é”è¿›è¡Œä¿æŠ¤ï¼Œç›¸å¯¹äº<code>HashTable</code> çš„ <code>synchronized</code> é”çš„ç²’åº¦æ›´ç»†ä¸€äº›ï¼Œå¹¶å‘æ€§èƒ½æ›´å¥½ï¼›ä» 1.8 å¼€å§‹æ‘’å¼ƒäº†<code>Segment</code> çš„æ¦‚å¿µï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ <code>synchronized</code> å’Œ <code>CAS</code> æ¥æ“ä½œã€‚<code>HashMap</code> æ²¡æœ‰é”æœºåˆ¶ï¼Œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>
<li><code>HashMap</code> çš„é”®å€¼å¯¹å…è®¸ä¸º <code>null</code>ï¼Œè€Œ <code>ConCurrentHashMap</code> éƒ½ä¸å…è®¸ã€‚</li>
</ul>
<h4 id="hashset"><a class="markdownIt-Anchor" href="#hashset"></a> HashSet</h4>
<h3 id="å¸¸è§é—®é¢˜"><a class="markdownIt-Anchor" href="#å¸¸è§é—®é¢˜"></a> å¸¸è§é—®é¢˜</h3>
<h4 id="collection-ä¸­çš„-foreach"><a class="markdownIt-Anchor" href="#collection-ä¸­çš„-foreach"></a> <code>Collection</code> ä¸­çš„ <code>forEach</code></h4>
<p>ä»¥ <code>ArrayList</code> ä¸ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">forEach</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> E&gt; action)</span> </span>&#123;</span><br><span class="line">    Objects.requireNonNull(action);</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="keyword">final</span> E[] elementData = (E[]) <span class="keyword">this</span>.elementData;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> size = <span class="keyword">this</span>.size;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; modCount == expectedModCount &amp;&amp; i &lt; size; i++) &#123;</span><br><span class="line">        action.accept(elementData[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (modCount != expectedModCount) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨ <code>forEach</code> éå† <code>Collection</code> æ—¶ä¸èƒ½æ”¹å˜ <code>Collection</code> çš„ç»“æ„ï¼ˆå³ä¸èƒ½æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥ <code>ConcurrentModificationException</code> å¼‚å¸¸ã€‚</p>
<h4 id="hashmap-çš„-capacity-ä¸ºä»€ä¹ˆè®¾è®¡æˆ-2-çš„å¹‚æ–¹"><a class="markdownIt-Anchor" href="#hashmap-çš„-capacity-ä¸ºä»€ä¹ˆè®¾è®¡æˆ-2-çš„å¹‚æ–¹"></a> <code>HashMap</code> çš„ <code>capacity</code> ä¸ºä»€ä¹ˆè®¾è®¡æˆ 2 çš„å¹‚æ–¹</h4>
<p>ä¸»è¦æ˜¯ä¸ºäº†åœ¨å–æ¨¡å’Œæ‰©å®¹æ—¶åšä¼˜åŒ–ã€‚åŒæ—¶ä¸ºäº†å‡å°‘å†²çªï¼Œ<code>HashMap</code> å®šä½å“ˆå¸Œæ¡¶ç´¢å¼•ä½ç½®æ—¶ï¼Œè®©é”®çš„ <code>hashCode</code> çš„é«˜ä½ä¹Ÿå‚ä¸è¿ç®—ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">               <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±æºç å¯çŸ¥ï¼Œ<code>HashMap</code> åœ¨æ’å…¥æ•°æ®æ—¶ï¼Œç´¢å¼•ä½ç½® <code>i = (n - 1) &amp; hash</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ <code>HashMap</code> çš„ <code>capacity</code> æ€»æ˜¯ 2 çš„å¹‚æ–¹çš„åŸå› ï¼Œå› ä¸ºåªæœ‰å½“ <code>n (capacity)</code> æ˜¯ 2 çš„å¹‚æ–¹æ—¶ï¼Œæ‰èƒ½ä¿è¯ <code>hash % n</code> çš„ç»“æœä¸ <code>(n - 1) &amp; hash</code> ä¸€è‡´ï¼Œè€Œä½è¿ç®—çš„æ•ˆç‡è¦é«˜äºå–æ¨¡è¿ç®—ã€‚</p>
<h4 id="hashmap-æ˜¯å¦‚ä½•è§£å†³å“ˆå¸Œå†²çªçš„"><a class="markdownIt-Anchor" href="#hashmap-æ˜¯å¦‚ä½•è§£å†³å“ˆå¸Œå†²çªçš„"></a> <code>HashMap</code> æ˜¯å¦‚ä½•è§£å†³å“ˆå¸Œå†²çªçš„</h4>
<p>å“ˆå¸Œï¼šé€šè¿‡æ•£åˆ—ç®—æ³•æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œå˜æ¢æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ï¼ˆå“ˆå¸Œå€¼ï¼‰ã€‚</p>
<p>å“ˆå¸Œå†²çªï¼šä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºç›¸åŒçš„æ•£åˆ—å€¼çš„ç°è±¡ã€‚</p>
<p><code>HashMap</code> åº•å±‚æ•°æ®ç»“æ„æ˜¯<strong>æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</strong>ï¼Œæ•°ç»„çš„æ¯ä¸€ä¸ªå­˜å‚¨å•å…ƒç§°ä¸ºä¸€ä¸ªæ¡¶ï¼ˆ<code>bucket</code>ï¼‰ã€‚å½“å‘ <code>HashMap</code> æ·»åŠ é”®å€¼å¯¹æ—¶ï¼Œä¼šæ ¹æ®é”®çš„å“ˆå¸Œå€¼æ¥å®šä½åº”è¯¥æ”¾åœ¨å“ªä¸ª <code>bucket</code> å¯¹åº”çš„é“¾è¡¨ä¸Šã€‚å“ˆå¸Œå€¼ç›¸åŒçš„å¯¹è±¡ç»„æˆä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨é•¿åº¦è¿‡é•¿æ—¶ï¼Œ<code>HashMap</code> çš„å¢åˆ æ”¹æŸ¥æ€§èƒ½éƒ½ä¼šå—åˆ°å½±å“ã€‚ä¸ºæ­¤ï¼ŒJava 1.8 è¿›è¡Œäº†ä¼˜åŒ–ï¼Œè§„å®šå½“é“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼æ—¶ï¼ˆé»˜è®¤ä¸º8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºä¼šçº¢é»‘æ ‘ï¼Œåˆ©ç”¨çº¢é»‘æ ‘å¿«é€Ÿå¢åˆ æ”¹æŸ¥çš„ç‰¹ç‚¹æé«˜ <code>HashMap</code> çš„æ€§èƒ½ã€‚</p>
<p><strong>æ‹‰é“¾æ³•</strong>å’Œ<strong>æ‰°åŠ¨</strong>å¯ä»¥è®©æ•°æ®åœ¨ <code>bucket</code> åˆ†å¸ƒæ›´å‡åŒ€ï¼Œå‡å°‘å“ˆå¸Œç¢°æ’ã€‚</p>
<h4 id="concurrenthashmap-åº•å±‚å®ç°åŸç†"><a class="markdownIt-Anchor" href="#concurrenthashmap-åº•å±‚å®ç°åŸç†"></a> <code>ConcurrentHashMap</code> åº•å±‚å®ç°åŸç†</h4>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Javaå®¹å™¨</tag>
        <tag>ArrayList</tag>
        <tag>HashMap</tag>
        <tag>ConcurrentHashMap</tag>
      </tags>
  </entry>
  <entry>
    <title>å¹¶å‘åŸºç¡€</title>
    <url>/archives/46bf65ac.html</url>
    <content><![CDATA[<h4 id="ä½¿ç”¨çº¿ç¨‹"><a class="markdownIt-Anchor" href="#ä½¿ç”¨çº¿ç¨‹"></a> ä½¿ç”¨çº¿ç¨‹</h4>
<h5 id="å®ç°-runnable-æ¥å£"><a class="markdownIt-Anchor" href="#å®ç°-runnable-æ¥å£"></a> å®ç° <code>Runnable</code> æ¥å£</h5>
<p>éœ€è¦å®ç° <code>run()</code> æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Task</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RunnableDemo task = <span class="keyword">new</span> RunnableDemo();</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(task, <span class="string">&quot;çº¿ç¨‹&quot;</span>);</span><br><span class="line">        t.start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹: i å’Œ main: i ä¼šäº¤æ›¿æ˜¾ç¤º</span></span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h5 id="å®ç°-callable-æ¥å£"><a class="markdownIt-Anchor" href="#å®ç°-callable-æ¥å£"></a> å®ç° <code>Callable</code> æ¥å£</h5>
<p>éœ€è¦å®ç° <code>call()</code> æ–¹æ³•ï¼Œä¸ <code>Runnable</code> ç›¸æ¯”ï¼Œ<code>Callable</code> æœ‰è¿”å›å€¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallableDemo</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    String s;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CallableDemo</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.s = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ExecutorService executorService = Executors.newSingleThreadExecutor();</span><br><span class="line"></span><br><span class="line">        Future&lt;String&gt; future = executorService.submit(<span class="keyword">new</span> CallableDemo(<span class="string">&quot;Callable&lt;String&gt;&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(future.get());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException | ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            executorService.shutdown();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹: i å’Œ main: i ä¼šäº¤æ›¿æ˜¾ç¤º</span></span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ç° <code>Runnable</code> æˆ– <code>Callable</code> æ¥å£çš„ç±»æœ¬èº«å¹¶ä¸å…·æœ‰çº¿ç¨‹è¡Œä¸ºï¼Œå¯ä»¥æŠŠè¿™äº›ç±»çœ‹ä½œæ˜¯æ‰§è¡ŒæŸäº›ä»»åŠ¡çš„ç±»ï¼Œè¦ä½¿è¿™äº›ä»»åŠ¡æ‰§è¡Œèµ·æ¥è¿˜æ˜¯éœ€è¦çœŸæ­£çš„çº¿ç¨‹æ¥é©±åŠ¨ã€‚</p>
<h5 id="ç»§æ‰¿-thread-ç±»"><a class="markdownIt-Anchor" href="#ç»§æ‰¿-thread-ç±»"></a> ç»§æ‰¿ <code>Thread</code> ç±»</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateThread1</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreadDemo</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.MILLISECONDS.sleep(<span class="number">1</span>); <span class="comment">// è®©çº¿ç¨‹ä¼‘çœ ï¼Œæ›´å¥½åœ°çœ‹åˆ°çº¿ç¨‹äº¤æ›¿æ‰§è¡Œæ•ˆæœ</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Thread thread = <span class="keyword">new</span> ThreadDemo(<span class="string">&quot;çº¿ç¨‹&quot;</span>);</span><br><span class="line">        thread.start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.MILLISECONDS.sleep(<span class="number">1</span>); <span class="comment">// è®©çº¿ç¨‹ä¼‘çœ ï¼Œæ›´å¥½åœ°çœ‹åˆ°çº¿ç¨‹äº¤æ›¿æ‰§è¡Œæ•ˆæœ</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: &quot;</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§æ‰¿ <code>Thread</code> ç±»ä¸å®ç° <code>Runnable</code> æ¥å£çš„æ¯”è¾ƒï¼š</p>
<ol>
<li>
<p>å®ç° <code>Runnable</code> æ¥å£å¯ä»¥æ›´å¥½çš„è§£è€¦ã€‚</p>
<blockquote>
<p><code>Runnable</code> åªæœ‰ä¸€ä¸ª <code>run()</code> æ–¹æ³•ï¼Œå®šä¹‰éœ€è¦å®ç°çš„ä»»åŠ¡;</p>
<p><code>Thread</code> åˆ™è´Ÿè´£çº¿ç¨‹çš„å±æ€§è®¾ç½®å’Œå¯åŠ¨ç­‰å†…å®¹ã€‚</p>
</blockquote>
</li>
<li>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ç° <code>Runnable</code> æ¥å£å¯ä»¥æé«˜æ€§èƒ½ã€‚</p>
<blockquote>
<p>ä½¿ç”¨ç»§æ‰¿ <code>Thread</code> ç±»çš„æ–¹å¼ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œéƒ½éœ€è¦é‡æ–°åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç­‰ä»»åŠ¡æ‰§è¡Œå®Œï¼Œçº¿ç¨‹éœ€è¦è¢«é”€æ¯ï¼Œå¢åŠ äº†é¢å¤–çš„å¼€é”€ï¼›</p>
<p>ä½¿ç”¨å®ç° <code>Runnable</code> æ¥å£çš„æ–¹å¼ï¼Œåœ¨ä»»åŠ¡å®šä¹‰å®Œä¹‹åï¼Œé…åˆçº¿ç¨‹æ± ï¼Œåªéœ€å°†ä»»åŠ¡ä¼ å…¥çº¿ç¨‹æ± ï¼Œä½¿ç”¨çº¿ç¨‹æ± ä¸­å›ºæœ‰çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»ºé”€æ¯çº¿ç¨‹ã€‚</p>
</blockquote>
</li>
<li>
<p>Java ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œå¦‚æœç»§æ‰¿äº† <code>Thread</code> ç±»ï¼Œä¹‹åå°±ä¸èƒ½å†ç»§æ‰¿å…¶ä»–ç±»ï¼Œé™åˆ¶äº†ä»£ç ä»£ç çš„å¯æ‰©å±•æ€§ã€‚</p>
</li>
</ol>
<h4 id="çº¿ç¨‹åŸºæœ¬æœºåˆ¶"><a class="markdownIt-Anchor" href="#çº¿ç¨‹åŸºæœ¬æœºåˆ¶"></a> çº¿ç¨‹åŸºæœ¬æœºåˆ¶</h4>
<ul>
<li><strong>ä¼‘çœ ï¼ˆ<code>sleep</code>ï¼‰</strong></li>
</ul>
<p>è°ƒç”¨ <code>sleep()</code> ä¸ä¼šé‡Šæ”¾å¯¹è±¡é”ã€‚</p>
<p><code>sleep()</code> å¯èƒ½ä¼šæŠ›å‡º <code>InterruptedException</code>ï¼Œå› ä¸ºå¼‚å¸¸ä¸èƒ½è·¨çº¿ç¨‹ä¼ æ’­ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚çº¿ç¨‹ä¸­æŠ›å‡ºçš„å…¶å®ƒå¼‚å¸¸ä¹ŸåŒæ ·éœ€è¦åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>è®©æ­¥ï¼ˆ<code>yield</code>ï¼‰</strong></li>
</ul>
<p>ç»™çº¿ç¨‹è°ƒåº¦æœºåˆ¶ä¸€ä¸ªå»ºè®®ï¼Œå½“å‰çº¿ç¨‹çš„å·¥ä½œå·²ç»åšå¾—å·®ä¸å¤šäº†ï¼Œå¯ä»¥æŠŠ <code>CPU</code> è®©ç»™å…¶ä»–çº¿ç¨‹ï¼Œå½“å‰çº¿ç¨‹é‡æ–°è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚</p>
<p><code>yield()</code> åªæ˜¯ç»™ä¸€ä¸ªå»ºè®®ï¼Œä¸ä¸€å®šä¼šè¢«é‡‡çº³ã€‚</p>
<p>è°ƒç”¨ <code>yield()</code> ä¸ä¼šé‡Šæ”¾å¯¹è±¡é”ã€‚</p>
<ul>
<li>æ’<strong>é˜Ÿï¼ˆ<code>join</code>ï¼‰</strong></li>
</ul>
<p>åœ¨ <code>A</code> çº¿ç¨‹ä¸­è°ƒç”¨ <code>B.join()</code>ï¼Œ<code>A</code> çº¿ç¨‹å°†è¢«æŒ‚èµ·ï¼Œç›´åˆ° <code>B</code> çº¿ç¨‹ç»“æŸæ‰æ¢å¤ï¼Œ<code>B</code> çº¿ç¨‹æ˜¯ä¸€ä¸ªæ’é˜Ÿçº¿ç¨‹ã€‚</p>
<p>å¯¹ <code>join()</code> çš„è°ƒç”¨å¯ä»¥è¢«ä¸­æ–­ï¼Œåšæ³•æ˜¯è°ƒç”¨æ’é˜Ÿçº¿ç¨‹çš„ <code>interrupt()</code> æ–¹æ³•ã€‚</p>
<ul>
<li><strong>ä¸­æ–­ï¼ˆ<code>interrupt</code>ï¼‰</strong></li>
</ul>
<p>å¯¹äº <code>Java</code> æ¥è¯´ï¼Œåœæ­¢çº¿ç¨‹çš„æ­£ç¡®æ–¹å¼æ˜¯è°ƒç”¨çº¿ç¨‹çš„ <code>interrupt()</code> æ–¹æ³•ã€‚</p>
<p>è°ƒç”¨çº¿ç¨‹çš„ <code>interrupt()</code> æ–¹æ³•ï¼Œå°†è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹å·²ç»è¢«é˜»å¡ï¼Œæˆ–æ­£è¯•å›¾æ‰§è¡Œä¸€ä¸ªé˜»å¡æ“ä½œï¼Œé‚£ä¹ˆè®¾ç½®è¿™ä¸ªçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€å°†æŠ›å‡º <code>java.lang.InterruptedException</code> å¼‚å¸¸ã€‚</p>
<p>ä¸ºäº†è°ƒç”¨ <code>interrupt()</code>ï¼Œéœ€è¦å…ˆæŒæœ‰ <code>Thread</code> å¯¹è±¡ã€‚æ–°çš„ <code>concurrent</code> ç±»åº“ä¸­å°½é‡åœ¨é¿å…å¯¹ <code>Thread</code> å¯¹è±¡çš„ç›´æ¥æ“ä½œï¼Œè½¬è€Œå°½é‡é€šè¿‡ <code>Executor</code> æ¥æ‰§è¡Œæ‰€æœ‰æ“ä½œã€‚</p>
<p>å¦‚æœåœ¨ <code>Executor</code> ä¸Šè°ƒç”¨ <code>shutdownNow()</code>ï¼Œå°†ä¼šå‘é€ä¸€ä¸ª <code>interrupt()</code> è°ƒç”¨ç»™å®ƒå¯åŠ¨çš„æ‰€æœ‰çº¿ç¨‹ã€‚</p>
<p>å¦‚æœå¸Œæœ›åªä¸­æ–­æŸä¸ªå•ä¸€ä»»åŠ¡ï¼Œå¯ä»¥é€šè¿‡ <code>submit()</code> æ¥å¯åŠ¨ä»»åŠ¡ï¼Œå¹¶æŒæœ‰ä»»åŠ¡çš„ä¸Šä¸‹æ–‡ã€‚<code>submit()</code> è¿”å›ä¸€ä¸ª <code>Future&lt;?&gt;</code>ï¼Œå¯ä»¥åœ¨å…¶ä¸Šè°ƒç”¨ <code>cancel()</code>ï¼Œå¦‚æœæŠŠ <code>true</code> ä¼ ç»™ <code>cancel()</code>ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥åœ¨è¯¥çº¿ç¨‹ä¸Šè°ƒç”¨ <code>interrupt()</code> ä»¥åœæ­¢è¿™ä¸ªçº¿ç¨‹ã€‚</p>
<p><code>I/O</code> å’Œåœ¨ <code>synchronized</code> å—ä¸Šçš„é˜»å¡æ˜¯ä¸å¯ä¸­æ–­çš„ã€‚</p>
<p><code>interrupt()</code> å°†ä¼šç»™çº¿ç¨‹è®¾å®šä¸€ä¸ªä¸­æ–­æ ‡å¿—ï¼Œä½†ä¸­æ–­ä¸€ä¸ªé˜»å¡çš„çº¿ç¨‹å°†æŠ›å‡º <code>InterruptedException</code> å¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸è¢«æ•è·æ—¶å°†æ¸…é™¤çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ï¼Œæ‰€ä»¥åœ¨ <code>catch</code> å­å¥ä¸­ï¼Œåœ¨å¼‚å¸¸è¢«æ•è·æ—¶è¿™ä¸ªæ ‡å¿—æ€»æ˜¯ä¸ºå‡ã€‚</p>
<h4 id="çº¿ç¨‹çŠ¶æ€"><a class="markdownIt-Anchor" href="#çº¿ç¨‹çŠ¶æ€"></a> çº¿ç¨‹çŠ¶æ€</h4>
<ul>
<li><code>NEW</code></li>
</ul>
<p>åˆ›å»ºåè¿˜æœªå¯åŠ¨çš„çº¿ç¨‹å¤„äºè¿™ä¸ªçŠ¶æ€ã€‚</p>
<ul>
<li><code>RUNNABLE</code></li>
</ul>
<p>å¯è¿è¡Œï¼ˆå°±ç»ªï¼‰çŠ¶æ€ã€‚å¯èƒ½æ­£åœ¨è¿è¡Œï¼Œä¹Ÿå¯èƒ½åœ¨ç­‰å¾… <code>CPU</code> è°ƒåº¦ã€‚</p>
<ul>
<li><code>BLOCKED</code></li>
</ul>
<p>é˜»å¡ï¼ˆç­‰å¾…è·å–ä¸€ä¸ªå¯¹è±¡é”ï¼‰çŠ¶æ€ã€‚</p>
<ul>
<li><code>WAITING</code></li>
</ul>
<p>æ— é™æœŸç­‰å¾…å…¶ä»–çº¿ç¨‹å”¤é†’ã€‚</p>
<p>çº¿ç¨‹è¿›å…¥è¿™ç§çŠ¶æ€å¯èƒ½æ˜¯è°ƒç”¨äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<blockquote>
<ul>
<li><code>Object.wait()</code></li>
<li><code>Thread.join()</code></li>
<li><code>LockSupport.park()</code></li>
</ul>
</blockquote>
<ul>
<li><code>TIMED_WAITING</code></li>
</ul>
<p>åœ¨æœ‰é™æ—¶é—´å†…ç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡ŒæŸäº›æ“ä½œã€‚</p>
<p>çº¿ç¨‹è¿›å…¥è¿™ç§çŠ¶æ€å¯èƒ½æ˜¯è°ƒç”¨äº†ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<blockquote>
<ul>
<li><code>Thread.sleep(long timeout)</code></li>
<li><code>Object.wait(long timeout)</code></li>
<li><code>Thread.join(long timeout)</code></li>
<li><code>LockSupport.parkNanos(long timeout)</code></li>
<li><code>LockSupport.parkUntil(long timeout)</code></li>
</ul>
</blockquote>
<ul>
<li><code>TERMINATED</code></li>
</ul>
<p>çº¿ç¨‹ç»ˆæ­¢ã€‚</p>
<h4 id="çº¿ç¨‹åŒæ­¥"><a class="markdownIt-Anchor" href="#çº¿ç¨‹åŒæ­¥"></a> çº¿ç¨‹åŒæ­¥</h4>
<p><code>Java</code> æœ‰ä¸¤ç§é”æœºåˆ¶æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ï¼Œç¬¬ä¸€ä¸ªæ˜¯ <code>JVM</code> å®ç°çš„ <code>synchronized</code>ï¼Œè€Œå¦ä¸€ä¸ªæ˜¯ <code>JDK</code> å®ç°çš„ <code>ReentrantLock</code>ã€‚</p>
<h5 id="synchronized"><a class="markdownIt-Anchor" href="#synchronized"></a> <code>synchronized</code></h5>
<h6 id="synchronized-åŸºæœ¬ä½¿ç”¨"><a class="markdownIt-Anchor" href="#synchronized-åŸºæœ¬ä½¿ç”¨"></a> <code>synchronized</code> åŸºæœ¬ä½¿ç”¨</h6>
<ul>
<li>åŒæ­¥ä»£ç å—</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åŒæ­¥æ–¹æ³•</li>
</ul>
<p>é”å®šè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡ ï¼ˆthisï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">g</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæŸä¸ªçº¿ç¨‹åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨äº† <code>f()</code>ï¼Œå¯¹äºè¯¥å¯¹è±¡è€Œè¨€ï¼Œåªæœ‰ç­‰åˆ° <code>f()</code> è°ƒç”¨ç»“æŸé‡Šæ”¾äº†å¯¹è±¡é”ï¼Œå…¶ä»–çº¿ç¨‹æ‰èƒ½è°ƒç”¨ <code>f()</code> å’Œ <code>g()</code>ã€‚ä¹Ÿå³æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªç‰¹å®šå¯¹è±¡æ¥è¯´ï¼Œå…¶æ‰€æœ‰çš„ <code>synchronized</code> æ–¹æ³•å…±äº«åŒä¸€ä¸ªé”ã€‚</p>
<h6 id="synchronized-çš„å®ç°åŸç†"><a class="markdownIt-Anchor" href="#synchronized-çš„å®ç°åŸç†"></a> <code>synchronized</code> çš„å®ç°åŸç†</h6>
<p><code>Java</code> ä¸­æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª <code>monitor</code> ä¸ä¹‹å…³è”ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„ <code>monitor</code> è¢«è·å–åï¼Œè¯¥å¯¹è±¡å°†å¤„äºé”å®šçŠ¶æ€ã€‚</p>
<p>åœ¨ <code>Java</code> è™šæ‹Ÿæœºï¼ˆ<code>HotSpot</code>ï¼‰ä¸­ï¼Œ<code>monitor</code> æ˜¯åŸºäº <code>ObjectMonitor</code> å®ç°çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ObjectMonitor() &#123;</span><br><span class="line">  _header       = NULL;</span><br><span class="line">  _count        = <span class="number">0</span>;</span><br><span class="line">  _waiters      = <span class="number">0</span>,</span><br><span class="line">  _recursions   = <span class="number">0</span>;  <span class="comment">// é”çš„é‡å…¥æ¬¡æ•°</span></span><br><span class="line">  _object       = NULL;</span><br><span class="line">  _owner        = NULL;  <span class="comment">// æŒæœ‰å¯¹è±¡ monitor çš„çº¿ç¨‹</span></span><br><span class="line">  _WaitSet      = NULL;  <span class="comment">// å¤„äº wait çŠ¶æ€çš„çº¿ç¨‹é˜Ÿåˆ—</span></span><br><span class="line">  _WaitSetLock  = <span class="number">0</span> ;</span><br><span class="line">  _Responsible  = NULL ;</span><br><span class="line">  _succ         = NULL ;</span><br><span class="line">  _cxq          = NULL ;</span><br><span class="line">  FreeNext      = NULL ;</span><br><span class="line">  _EntryList    = NULL ;  <span class="comment">// å¤„äº blocked çŠ¶æ€çš„çº¿ç¨‹é˜Ÿåˆ—</span></span><br><span class="line">  _SpinFreq     = <span class="number">0</span> ;</span><br><span class="line">  _SpinClock    = <span class="number">0</span> ;</span><br><span class="line">  OwnerIsThread = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€æ®µåŒæ­¥ä»£ç æ—¶ï¼Œçº¿ç¨‹è¿›å…¥ <code>_EntryList</code> é˜Ÿåˆ—ä¸­ï¼›</p>
</li>
<li>
<p>æŸä¸ªçº¿ç¨‹è·å–åˆ°å¯¹è±¡çš„ <code>monitor</code> åï¼Œ<code>_Owner</code> æŒ‡å‘å½“å‰çº¿ç¨‹ï¼ŒåŒæ—¶ <code>monitor</code> ä¸­çš„è®¡æ•°å™¨ <code>_count</code> åŠ 1ï¼›</p>
</li>
<li>
<p>è‹¥æŒæœ‰ <code>monitor</code> çš„çº¿ç¨‹åœ¨å¯¹è±¡ä¸Šè°ƒç”¨ <code>wait()</code> æ–¹æ³•ï¼Œå°†é‡Šæ”¾è¯¥å¯¹è±¡ <code>monitor</code>ï¼Œ<code>_owner</code> å˜é‡æ¢å¤ä¸º <code>null</code>ï¼Œ<code>_count</code>è‡ªå‡1ï¼ŒåŒæ—¶è¯¥çº¿ç¨‹è¿›å…¥ <code>_WaitSet</code> é›†åˆä¸­ç­‰å¾…è¢«å”¤é†’ã€‚</p>
</li>
</ul>
<h6 id="synchronized-ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#synchronized-ä¼˜åŒ–"></a> <code>synchronized</code> ä¼˜åŒ–</h6>
<ul>
<li>è‡ªæ—‹é”</li>
</ul>
<div class="note "><p>çº¿ç¨‹çš„é˜»å¡å’Œå”¤é†’ä¼šä½¿ <code>CPU</code> ä»ç”¨æˆ·æ€é™·å…¥å†…æ ¸æ€ï¼Œé¢‘ç¹çš„é˜»å¡å’Œå”¤é†’æ“ä½œå¯¹ <code>CPU</code> æ¥è¯´æ˜¯ä¸€é¡¹è´Ÿæ‹…å¾ˆé‡çš„å·¥ä½œï¼Œä¼šå½±å“å¹¶å‘åº¦ã€‚</p>
<p>è®¸å¤šåº”ç”¨ï¼Œå¯¹è±¡é”çš„é”çŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ã€‚åŸºäºè¿™ä¸ªè§‚å¯Ÿï¼Œå¼•å…¥<strong>è‡ªæ—‹é”</strong>ã€‚æ‰€è°“è‡ªæ—‹é”ï¼Œå°±æ˜¯è®©çº¿ç¨‹è‡ªæ—‹ä¸€æ®µæ—¶é—´ï¼Œç­‰å¾…é”è¢«é‡Šæ”¾ï¼Œè¿™æ ·å¯ä»¥é¿å…è®©çº¿ç¨‹æŒ‚èµ·ï¼ˆé˜»å¡ï¼‰ã€‚</p>
<p>è‡ªæ—‹é”è™½ç„¶é¿å…äº†åˆ‡æ¢çº¿ç¨‹å¸¦æ¥çš„å¼€é”€ï¼Œä½†è‡ªæ—‹å ç”¨äº† <code>CPU</code> çš„æ—¶é—´ã€‚å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹å¾ˆå¿«é‡Šæ”¾äº†é”ï¼Œè‡ªæ—‹é”çš„æ•ˆç‡å°±å¾ˆé«˜ï¼›åä¹‹ï¼Œè‡ªæ—‹çš„çº¿ç¨‹å°±ä¼šç™½ç™½æ¶ˆè€—å¤„ç†å™¨çš„èµ„æºï¼Œåè€Œä¼šé™ä½æ€§èƒ½ã€‚æ‰€ä»¥ä¸€èˆ¬è‡ªæ—‹éœ€è¦é™å®šä¸€æ®µæ—¶é—´æˆ–é™å®šè‡ªæ—‹çš„æ¬¡æ•°ï¼Œè¶…è¿‡è§„å®šçš„æ—¶é—´æˆ–æ¬¡æ•°ï¼Œè¿˜æ²¡æœ‰è·å¾—é”çš„è¯å°±å°†è‡ªæ—‹çš„çº¿ç¨‹æŒ‚èµ·ã€‚</p>
</div>
<ul>
<li>é€‚åº”æ€§è‡ªæ—‹é”</li>
</ul>
<div class="note "><p>é€‚åº”æ€§è‡ªæ—‹é”çš„å·¥ä½œåŸç†å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<p>å¯¹äºæŸä¸ªé”ï¼Œå¦‚æœè‡ªæ—‹æˆåŠŸï¼Œé‚£ä¹ˆä¸‹æ¬¡åœ¨è·å–è¯¥é”æ—¶å°±ä¼šè‡ªæ—‹æ›´ä¹…ï¼Œå› ä¸ºè™šæ‹Ÿæœºè®¤ä¸ºæ—¢ç„¶ä¸Šæ¬¡è‡ªæ—‹æˆåŠŸï¼Œé‚£ä¹ˆè¿™æ¬¡è‡ªæ—‹ä¹Ÿå¾ˆå¯èƒ½ä¼šæˆåŠŸï¼›</p>
<p>åä¹‹ï¼Œå¦‚æœå¯¹äºæŸä¸ªé”çš„è·å–å¾ˆå°‘è‡ªæ—‹æˆåŠŸï¼Œé‚£ä¹ˆä¸‹æ¬¡è·å–è¯¥é”æ—¶å°±è‡ªæ—‹å¾ˆå°‘çš„æ—¶é—´æˆ–åœ¨å‹æ ¹ä¸è‡ªæ—‹ï¼Œç›´æ¥æŒ‚èµ·çº¿ç¨‹ï¼Œä»¥å…è‡ªæ—‹æµªè´¹æ—¶é—´ã€‚</p>
</div>
<ul>
<li>é”æ¶ˆé™¤</li>
</ul>
<div class="note "><p>åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œå¦‚æœ <code>JVM</code> æ£€æµ‹åˆ°ä¸ä¼šæœ‰å…±äº«æ•°æ®ç«äº‰çš„é—®é¢˜ï¼Œå°±ä¼šå¯¹å…¶ä¸­çš„åŒæ­¥é”è¿›è¡Œæ¶ˆé™¤ï¼ŒèŠ‚çœè¯·æ±‚é”çš„æ—¶é—´ã€‚</p>
</div>
<ul>
<li>é”ç²—åŒ–</li>
</ul>
<div class="note "><p>åœ¨ä½¿ç”¨åŒæ­¥é”æ—¶ï¼Œç»å¸¸éœ€è¦è®©åŒæ­¥çš„ä½œç”¨èŒƒå›´å°½å¯èƒ½å°ï¼Œè¿™æ ·åŒæ­¥å—å†…çš„ä»£ç é‡å°‘ï¼Œå¦‚æœå­˜åœ¨é”ç«äº‰ï¼ŒæŒæœ‰é”çš„çº¿ç¨‹èƒ½å°½å¿«æ‰§è¡Œå®ŒåŒæ­¥å—å†…çš„ä»£ç å¹¶é‡Šæ”¾é”ï¼Œè¯·æ±‚é”çš„çº¿ç¨‹ä¹Ÿå¯ä»¥å°½å¿«åœ°è·å–é”ã€‚</p>
<p>é€šå¸¸è¿™æ˜¯åŒæ­¥ä»£ç çš„æŒ‡å¯¼åŸåˆ™ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œå› ä¸ºåŠ é”å’Œé‡Šæ”¾é”çš„æ“ä½œæ¯”è¾ƒè€—æ—¶ï¼Œå¦‚æœ<strong>è¿ç»­å¤šå¤„æœ‰åŒæ­¥ä»£ç å—</strong>ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘å°†é”çš„ä½œç”¨èŒƒå›´æ‰©å¤§ï¼Œå°†å¤šä¸ªåŠ é”çš„ä»£ç å—åˆå¹¶ä¸ºä¸€ä¸ªï¼Œä»è€Œå‡å°‘åŠ é”å’Œè§£é”æ“ä½œã€‚</p>
</div>
<ul>
<li>åå‘é”</li>
</ul>
<div class="note "><p>å¼•å…¥åå‘é”ä¸»è¦ç›®çš„æ˜¯ï¼šä¸ºäº†åœ¨æ— å¤šçº¿ç¨‹ç«äº‰çš„æƒ…å†µä¸‹å°½é‡å‡å°‘ä¸å¿…è¦çš„è½»é‡çº§é”æ‰§è¡Œè·¯å¾„ã€‚ä¸Šé¢æåˆ°äº†è½»é‡çº§é”çš„åŠ é”è§£é”æ“ä½œæ˜¯éœ€è¦ä¾èµ–å¤šæ¬¡ <code>CAS</code> åŸå­æŒ‡ä»¤çš„ã€‚</p>
<p>ä½¿ç”¨åå‘é”åªéœ€è¦æ£€æŸ¥æ˜¯å¦ä¸ºåå‘é”ã€é”æ ‡è¯†ä¸ºä»¥åŠ <code>ThreadID</code> å³å¯ã€‚</p>
</div>
<ul>
<li>è½»é‡çº§é”</li>
</ul>
<div class="note "><p>å½“å…³é—­åå‘é”åŠŸèƒ½æˆ–è€…å¤šä¸ªçº¿ç¨‹ç«äº‰åå‘é”å¯¼è‡´åå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼Œåˆ™ä¼šå°è¯•è·å–è½»é‡çº§é”ã€‚</p>
</div>
<h5 id="reentrantlock"><a class="markdownIt-Anchor" href="#reentrantlock"></a> <code>ReentrantLock</code></h5>
<p><strong><code>ReentrantLock</code> åŸºæœ¬ä½¿ç”¨</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     lock.lock();  <span class="comment">// block until condition holds</span></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="comment">// ... method body</span></span><br><span class="line">     &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">       lock.unlock()</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="synchronized-å’Œ-reentrantlock-çš„æ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#synchronized-å’Œ-reentrantlock-çš„æ¯”è¾ƒ"></a> <code>synchronized</code> å’Œ <code>ReentrantLock</code> çš„æ¯”è¾ƒ</h5>
<ul>
<li>
<p><code>synchronized</code> æ˜¯ <code>JVM</code> å®ç°çš„ï¼Œ<code>ReentrantLock</code> æ˜¯ <code>JDK</code> å®ç°çš„ï¼›</p>
</li>
<li>
<p><code>ReentrantLock</code> é˜»å¡å¯ä¸­æ–­ï¼Œ <code>synchronized</code> é˜»å¡ä¸å¯ä¸­æ–­ï¼›</p>
</li>
<li>
<p>å…¬å¹³é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„å…ˆåé¡ºåºæ¥ä¾æ¬¡è·å¾—é”ã€‚</p>
<p><code>synchronized</code> é”æ˜¯éå…¬å¹³çš„ï¼Œ<code>ReentrantLock</code> é»˜è®¤ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†æ˜¯å¯ä»¥è®¾ç½®ä¸ºå…¬å¹³çš„;</p>
</li>
<li>
<p><code>ReentrantLock</code> å¯ä»¥åŒæ—¶ç»‘å®šå®šå¤šä¸ª <code>Condition</code> å¯¹è±¡ï¼›</p>
</li>
<li>
<p>é™¤ééœ€è¦ä½¿ç”¨ <code>ReentrantLock</code> çš„é«˜çº§åŠŸèƒ½ï¼Œå¦åˆ™<strong>ä¼˜å…ˆä½¿ç”¨ <code>synchronized</code></strong>ã€‚</p>
</li>
</ul>
<h4 id="çº¿ç¨‹åä½œ"><a class="markdownIt-Anchor" href="#çº¿ç¨‹åä½œ"></a> çº¿ç¨‹åä½œ</h4>
<p><strong>ä¿¡å·ä¸¢å¤±</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// T1</span></span><br><span class="line"><span class="keyword">synchronized</span> (sharedMonitor) &#123;</span><br><span class="line">  	&lt;setup condition <span class="keyword">for</span> T2&gt;</span><br><span class="line">    sharedMonitor.notify();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// T2</span></span><br><span class="line"><span class="keyword">while</span> (someCondition) &#123;</span><br><span class="line">  	<span class="comment">// point1</span></span><br><span class="line">    <span class="keyword">synchronized</span> (sharedMonitor) &#123;</span><br><span class="line">      	sharedMonitor.wait();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ <code>T2</code> å…ˆæ‰§è¡Œï¼Œå¹¶å‘ç° <code>someCondition</code> ä¸º <code>true</code>ï¼Œåœ¨ <code>point1</code>ï¼Œ<code>CPU</code> åˆ‡æ¢åˆ° <code>T1</code>ã€‚</p>
<p><code>T1</code> æ‰§è¡Œè®¾ç½®ï¼Œç„¶åè°ƒç”¨ <code>notify()</code>ã€‚å½“ <code>T2</code> è¢«é‡æ–°è°ƒåº¦ï¼Œè·å¾— <code>shareMonitor</code> åç»§ç»­æ‰§è¡Œè¿›å…¥ <code>wait()</code>ï¼Œå¹¶é‡Šæ”¾ <code>shareMonitor</code>ã€‚</p>
<p>ä½†æ˜¯å› ä¸º <code>T1</code> å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œä¸ä¼šå†è°ƒç”¨ <code>notify()</code>ï¼Œ<code>T2</code> å°†ä¸€ç›´ç­‰å¾…è¿™ä¸ªå·²ç»å‘é€è¿‡çš„ä¿¡å·ï¼Œä»è€Œäº§ç”Ÿæ­»é”ã€‚</p>
<p>äº§ç”Ÿè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯åœ¨ <code>someCondition</code> å‘ç”Ÿäº†<strong>ç«äº‰æ¡ä»¶</strong>ï¼Œ<code>T1</code> å’Œ <code>T2</code> èƒ½å¦æ­£å¸¸åä½œï¼Œå–å†³äº <code>someCondition</code> çš„è®¾ç½®å’Œåˆ¤æ–­é¡ºåºã€‚</p>
<p>è§£å†³æ–¹æ³•æ˜¯æ¶ˆé™¤åœ¨ <code>someCondition</code> ä¸Šçš„ç«äº‰æ¡ä»¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// T2</span></span><br><span class="line"><span class="keyword">synchronized</span> (sharedMonitor) &#123;</span><br><span class="line">  	<span class="keyword">while</span> (someCondition) &#123;</span><br><span class="line">      	sharedMonitor.wait();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šï¼Œä½¿ç”¨ <code>wait()</code> çš„å®‰å…¨æ–¹å¼æ­£æ˜¯åœ¨ä¸Šè¿°è¿™ç§æ–¹å¼ï¼Œåœ¨åŒæ­¥ä»£ç å—ä¸­ï¼Œä½¿ç”¨ <code>while</code> ç­‰å¾…æŸç§æ¡ä»¶ç”Ÿæ•ˆã€‚</p>
<p><strong>è™šå‡å”¤é†’</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">   <span class="keyword">if</span> (&lt;condition does not hold&gt;)</span><br><span class="line">       obj.wait(); <span class="comment">// point1</span></span><br><span class="line">   <span class="comment">// point2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œå‡è®¾æœ‰ 2 ä¸ªçº¿ç¨‹ <code>T1</code> å’Œ <code>T2</code> å…ˆåè·å– <code>obj</code> å¯¹è±¡é”åï¼Œ<code>if</code> åˆ¤æ–­éƒ½ä¸ºå‡ï¼Œ<code>T1</code> ã€<code>T2</code> è¿›å…¥é˜»å¡çŠ¶æ€ï¼›</p>
<p>ç„¶åæœ‰å¦ä¸€ä¸ªçº¿ç¨‹ <code>T3</code> è·å–äº† <code>obj</code> å¯¹è±¡åå°† <code>condition</code> è®¾ç½®ä¸º <code>true</code> ï¼Œå¹¶è°ƒç”¨ <code>notify()</code>ï¼ŒåŒæ—¶å”¤é†’ <code>T1</code>ã€<code>T2</code>ï¼›</p>
<p>å‡è®¾ <code>T1</code> ç«äº‰è·å¾— <code>obj</code> å¯¹è±¡é”ï¼Œä¸ä¼šé‡æ–°åˆ¤æ–­ <code>condition</code>ï¼Œè€Œæ˜¯æ¥ç€æ‰§è¡Œ <code>point2</code> å¤„ä»£ç ï¼Œç„¶åç»“æŸå…è®¸å¹¶é‡Šæ”¾é”ï¼›</p>
<p>æœ€åï¼Œ<code>T2</code> ç»ˆé‡æ–°è·å¾— <code>obj</code> å¯¹è±¡é”ï¼ŒåŒæ ·ä¸ä¼šé‡æ–°åˆ¤æ–­ <code>condition</code>ï¼Œå¹¶æ¥ç€æ‰§è¡Œ <code>point2</code> å¤„ä»£ç ã€‚å¦‚æœ <code>T1</code> æ‰§è¡Œå®Œå <code>condition</code> åˆä¸ºå‡ï¼Œ<code>T2</code> å› ä¸ºæ²¡æœ‰é‡æ–°åˆ¤æ–­æ¡ä»¶ï¼Œå†æ‰§è¡Œåç»­ä»£ç å°±å‡ºé”™äº†ã€‚</p>
<p>è¿™å°±æ˜¯è™šå‡å”¤é†’æ‰€å¯¼è‡´çš„é—®é¢˜ï¼Œæ­£ç¡®çš„å†™æ³•æ˜¯å°† <code>condtion</code> æ”¾åœ¨ <code>while</code> å¾ªç¯é‡Œï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (obj) &#123;</span><br><span class="line">   <span class="keyword">while</span> (&lt;condition does not hold&gt;)</span><br><span class="line">       obj.wait(); <span class="comment">// point1</span></span><br><span class="line">   <span class="comment">// point2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±ä¿è¯äº†ï¼Œçº¿ç¨‹ä» <code>wait()</code> ä¸­è¿”å›ï¼ˆè¢«å”¤é†’ï¼‰åï¼Œä¸ä¼šç›´æ¥æ‰§è¡Œ <code>point2</code> å¤„ä»£ç ï¼Œè€Œæ˜¯æ¥ç€åˆ¤æ–­ <code>condition</code>ï¼Œå¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œæ¥ç€è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œä¿è¯å¹¶å‘çš„æ­£ç¡®æ‰§è¡Œã€‚</p>
<h5 id="ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜"><a class="markdownIt-Anchor" href="#ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜"></a> ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜</h5>
<ul>
<li><strong>ä½¿ç”¨ <code>BlockingQueue</code> å®ç°</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BlockingQueuePC</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      	<span class="comment">// è¿™ä¸ªç¨‹åºä¸ä¼šè‡ªåŠ¨åœæ­¢ï¼Œæ·»åŠ ä¸€ä¸ª Timerï¼Œä»¥ä¾¿åœ¨ 100 æ¯«ç§’ååœæ­¢</span></span><br><span class="line">        <span class="keyword">new</span> Timer().schedule(<span class="keyword">new</span> TimerTask() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                System.err.println(<span class="string">&quot;Aborting&quot;</span>);</span><br><span class="line">                System.exit(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">100</span>);</span><br><span class="line">        </span><br><span class="line">        BlockingQueue&lt;Object&gt; queue = <span class="keyword">new</span> ArrayBlockingQueue&lt;&gt;(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®šä¹‰ç”Ÿäº§ä»»åŠ¡</span></span><br><span class="line">        Runnable producer = () -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    queue.put(<span class="keyword">new</span> Object());</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; produce the &quot;</span> + queue.size() + <span class="string">&quot;th Object&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸¤ä¸ªç”Ÿäº§è€…çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">new</span> Thread(producer, <span class="string">&quot;Producer1&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(producer, <span class="string">&quot;Producer2&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®šä¹‰æ¶ˆè´¹ä»»åŠ¡</span></span><br><span class="line">        Runnable consumer = () -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; consume the &quot;</span> + queue.size() + <span class="string">&quot;th Object&quot;</span>);</span><br><span class="line">                    queue.take();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸¤ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">new</span> Thread(consumer, <span class="string">&quot;Consumer1&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(consumer, <span class="string">&quot;Consumer2&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>ä½¿ç”¨ <code>wait + notify/notifyAll</code> å®ç°</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰ç®€å•é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBlockingQueue</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> capacity = <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">private</span> LinkedList&lt;Object&gt; storage;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyBlockingQueue</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.capacity = capacity;</span><br><span class="line">        storage = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">produce</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå®¹å™¨æ»¡äº†ï¼Œå°±é˜»å¡ç”Ÿäº§è€…</span></span><br><span class="line">        <span class="keyword">while</span> (storage.size() == capacity) &#123;</span><br><span class="line">            <span class="keyword">this</span>.wait();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        storage.add(<span class="keyword">new</span> Object());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å”¤é†’æ¶ˆè´¹è€…</span></span><br><span class="line">        <span class="keyword">this</span>.notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> Object <span class="title">consume</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå®¹å™¨ä¸ºç©ºï¼Œå°±é˜»å¡æ¶ˆè´¹è€…</span></span><br><span class="line">        <span class="keyword">while</span> (storage.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.wait();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Object o = storage.remove();</span><br><span class="line">        <span class="comment">// å”¤é†’ç”Ÿäº§è€…</span></span><br><span class="line">        <span class="keyword">this</span>.notifyAll();</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿäº§è€…</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> MyBlockingQueue storage;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(MyBlockingQueue storage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.storage = storage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                storage.produce();</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; produce &quot;</span> + i);</span><br><span class="line">                TimeUnit.MILLISECONDS.sleep(<span class="number">500</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> MyBlockingQueue storage;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(MyBlockingQueue storage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.storage = storage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                storage.consume();</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; consume &quot;</span> + i);</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>ä½¿ç”¨ <code>await + signal/signalAll</code> å®ç°</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªç®€å•é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBlockingQueue</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Queue queue;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> capacity = <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">private</span> ReentrantLock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸¤ä¸ª Condition</span></span><br><span class="line">    <span class="keyword">private</span> Condition notEmpty = lock.newCondition();</span><br><span class="line">    <span class="keyword">private</span> Condition notFull = lock.newCondition();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyBlockingQueue</span><span class="params">(<span class="keyword">int</span> capacity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.capacity = capacity;</span><br><span class="line">        queue = <span class="keyword">new</span> LinkedList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(Object o)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å®¹å™¨æ»¡äº†ï¼Œé˜»å¡ç”Ÿäº§è€…ï¼Œç­‰å¾…å”¤é†’</span></span><br><span class="line">            <span class="keyword">while</span> (queue.size() == capacity) &#123;</span><br><span class="line">                notFull.await();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            queue.add(o);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å”¤é†’æ¶ˆè´¹è€…</span></span><br><span class="line">            notEmpty.signalAll();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">take</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (queue.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                notEmpty.await();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Object o = queue.remove();</span><br><span class="line">            notFull.signalAll();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> o;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ä»£ç ç±»ä¼¼ã€‚</p>
<h4 id="çº¿ç¨‹å®‰å…¨"><a class="markdownIt-Anchor" href="#çº¿ç¨‹å®‰å…¨"></a> çº¿ç¨‹å®‰å…¨</h4>
<p>ä¿è¯çº¿ç¨‹å®‰å…¨çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ã€‚</p>
<h5 id="ä¸å¯å˜"><a class="markdownIt-Anchor" href="#ä¸å¯å˜"></a> ä¸å¯å˜</h5>
<p>ä¸å¯å˜çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®åœ°æ„å»ºå‡ºæ¥ï¼Œå°±ä¸ä¼šçœ‹åˆ°å®ƒåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œåº”å½“å°½é‡ä½¿å¯¹è±¡æˆä¸ºä¸å¯å˜ï¼Œæ¥æ»¡è¶³çº¿ç¨‹å®‰å…¨ã€‚</p>
<p>ä¸å¯å˜ç±»å‹ï¼š</p>
<ul>
<li><code>final</code> ä¿®é¥°çš„åŸºæœ¬æ•°æ®ç±»å‹</li>
<li><code>String</code></li>
<li>æšä¸¾ç±»å‹</li>
<li><code>Number</code> éƒ¨åˆ†å­ç±»</li>
</ul>
<h5 id="äº’æ–¥åŒæ­¥"><a class="markdownIt-Anchor" href="#äº’æ–¥åŒæ­¥"></a> äº’æ–¥åŒæ­¥</h5>
<p>å³ä½¿ç”¨ <code>synchronized</code> æˆ– <code>ReentrantLock</code> å¯¹è®¿é—®å…±äº«èµ„æºçš„ä»£ç åŠ é”ã€‚</p>
<h5 id="éé˜»å¡åŒæ­¥"><a class="markdownIt-Anchor" href="#éé˜»å¡åŒæ­¥"></a> éé˜»å¡åŒæ­¥</h5>
<p>äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œäº’æ–¥åŒæ­¥ç§°ä¸ºé˜»å¡åŒæ­¥ã€‚</p>
<p>äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œè®¤ä¸ºåªè¦ä¸åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œå°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ‰€ä»¥æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œéƒ½è¦è¿›è¡ŒåŠ é”ã€‚</p>
<p>ä¸æ‚²è§‚å¹¶å‘ç­–ç•¥ç›¸å¯¹çš„æ˜¯ä¹è§‚å¹¶å‘ç­–ç•¥ï¼šå…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶å®ƒçº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼Œå¦åˆ™é‡‡å–è¡¥å¿æªæ–½ï¼ˆä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼‰ã€‚è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦å°†çº¿ç¨‹é˜»å¡ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ã€‚</p>
<p>å¯ä»¥ç”¨ <code>CAS</code> å®ç°éé˜»å¡åŒæ­¥ã€‚</p>
<h5 id="threadlocal"><a class="markdownIt-Anchor" href="#threadlocal"></a> <code>ThreadLocal</code></h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocalExample1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ThreadLocal threadLocal1 = <span class="keyword">new</span> ThreadLocal();</span><br><span class="line">        ThreadLocal threadLocal2 = <span class="keyword">new</span> ThreadLocal();</span><br><span class="line">        Thread thread1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            threadLocal1.set(<span class="number">1</span>);</span><br><span class="line">            threadLocal2.set(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        Thread thread2 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            threadLocal1.set(<span class="number">2</span>);</span><br><span class="line">            threadLocal2.set(<span class="number">2</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ThreadLocal</code> çš„åº•å±‚æ•°æ®ç»“æ„ï¼š</p>
<p><img data-src="/archives/46bf65ac/ThreadLocalMap.png" alt="ThreadLocalMap"></p>
<p>æ¯ä¸ª <code>Thread</code> éƒ½æœ‰ä¸€ä¸ª <code>ThreadLocal.ThreadLocalMap</code> å¯¹è±¡ã€‚</p>
<p>å½“è°ƒç”¨ä¸€ä¸ª <code>ThreadLocal</code> çš„ <code>set(T value)</code> æ–¹æ³•æ—¶ï¼Œå…ˆå¾—åˆ°å½“å‰çº¿ç¨‹çš„ <code>ThreadLocalMap</code> å¯¹è±¡ï¼Œç„¶åå°† <code>ThreadLocal-&gt;value</code> é”®å€¼å¯¹æ’å…¥åˆ°è¯¥ <code>Map</code> ä¸­ã€‚</p>
<p>åœ¨ä¸€äº›åœºæ™¯ (å°¤å…¶æ˜¯ä½¿ç”¨çº¿ç¨‹æ± ) ä¸‹ï¼Œç”±äº <code>ThreadLocal.ThreadLocalMap</code> çš„åº•å±‚æ•°æ®ç»“æ„å¯¼è‡´ <code>ThreadLocal</code> æœ‰å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Œåº”è¯¥å°½å¯èƒ½åœ¨æ¯æ¬¡ä½¿ç”¨ <code>ThreadLocal</code> åæ‰‹åŠ¨è°ƒç”¨ <code>remove()</code>ï¼Œä»¥é¿å…å‡ºç° <code>ThreadLocal</code> ç»å…¸çš„å†…å­˜æ³„æ¼ç”šè‡³æ˜¯é€ æˆè‡ªèº«ä¸šåŠ¡æ··ä¹±çš„é£é™©ã€‚</p>
<h4 id="juc-ä¸­çš„æ„ä»¶"><a class="markdownIt-Anchor" href="#juc-ä¸­çš„æ„ä»¶"></a> <code>J.U.C</code> ä¸­çš„æ„ä»¶</h4>
<h5 id="countdownlatch"><a class="markdownIt-Anchor" href="#countdownlatch"></a> <code>CountDownLatch</code></h5>
<p>ç”¨æ¥åŒæ­¥å¤šä¸ªä»»åŠ¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Driver</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">     CountDownLatch startSignal = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line">     CountDownLatch doneSignal = <span class="keyword">new</span> CountDownLatch(N);</span><br><span class="line"></span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">       <span class="keyword">new</span> Thread(<span class="keyword">new</span> Worker(startSignal, doneSignal)).start();</span><br><span class="line"></span><br><span class="line">     <span class="comment">// do something</span></span><br><span class="line">     <span class="comment">// ä¸»çº¿ç¨‹åšå®Œå‡†å¤‡å·¥ä½œåï¼Œè°ƒç”¨ startSignal çš„ countDown()ï¼Œé€šçŸ¥åœ¨ startSignal ä¸Šç­‰å¾…çš„   </span></span><br><span class="line">     <span class="comment">// çº¿ç¨‹å¯ä»¥å¼€å§‹å·¥ä½œäº†</span></span><br><span class="line">     startSignal.countDown();</span><br><span class="line">     </span><br><span class="line">     <span class="comment">// ä¸»çº¿ç¨‹åœ¨åšæ”¶å°¾å·¥ä½œå‰ï¼Œåœ¨ doneSignal ä¸Šç­‰å¾…</span></span><br><span class="line">     doneSignal.await(); </span><br><span class="line">     <span class="comment">// do something</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> CountDownLatch startSignal;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> CountDownLatch doneSignal;</span><br><span class="line">   Worker(CountDownLatch startSignal, CountDownLatch doneSignal) &#123;</span><br><span class="line">     <span class="keyword">this</span>.startSignal = startSignal;</span><br><span class="line">     <span class="keyword">this</span>.doneSignal = doneSignal;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">       startSignal.await(); <span class="comment">// å¯åŠ¨è¿™ä¸ªä»»åŠ¡çš„çº¿ç¨‹ä¼šåœ¨ startSignal ä¸Šç­‰å¾…</span></span><br><span class="line">       <span class="comment">// do something</span></span><br><span class="line">       doneSignal.countDown(); <span class="comment">// æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œåï¼Œåœ¨ doneSignal ä¸Šç­‰å¾…çš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œ</span></span><br><span class="line">     &#125; <span class="keyword">catch</span> (InterruptedException ex) &#123;&#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="cyclicbarrier"><a class="markdownIt-Anchor" href="#cyclicbarrier"></a> <code>CyclicBarrier</code></h5>
<p><code>CyclicBarrier</code> é€‚ç”¨äºè¿™æ ·çš„æƒ…å†µï¼šä½ å¸Œæœ›åˆ›å»ºä¸€ç»„ä»»åŠ¡ï¼Œå®ƒä»¬å¹¶è¡Œåœ°æ‰§è¡Œå·¥ä½œï¼Œç„¶ååœ¨è¿›è¡Œä¸‹ä¸€ä¸ªæ­¥éª¤ä¹‹å‰ç­‰å¾…ï¼Œç›´è‡³æ‰€ä»¥ä»»åŠ¡éƒ½å®Œæˆã€‚<code>CyclicBarrier</code> ä½¿å¾—æ‰€æœ‰çš„å¹¶è¡Œä»»åŠ¡éƒ½å°†åœ¨æ …æ å¤„åˆ—é˜Ÿï¼Œç„¶åå†ä¸€è‡´åœ°å‘å‰ç§»åŠ¨ã€‚</p>
<p><code>CyclicBarrier</code> ä½œç”¨ç±»ä¼¼äº <code>CountDownLatch</code>ï¼Œåªæ˜¯ <code>CountDownLatch</code> åªèƒ½è§¦å‘ä¸€æ¬¡ï¼Œè€Œ <code>CyclicBarrier</code> é€šè¿‡è°ƒç”¨ <code>reset()</code> å¯ä»¥é‡å¤ä½¿ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CyclicBarrierDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> totalThread = <span class="number">10</span>;</span><br><span class="line">        CyclicBarrier cyclicBarrier = <span class="keyword">new</span> CyclicBarrier(totalThread);</span><br><span class="line">        ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; totalThread; i++) &#123;</span><br><span class="line">            executorService.execute(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// 1</span></span><br><span class="line">                    cyclicBarrier.await(); <span class="comment">// æ¯ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå®Œ 1 å¤„ä»£ç ä¼šç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œ 1 å¤„ä»£ç æ‰ä¼šå†æ‰§è¡Œ 2 å¤„ä»£ç </span></span><br><span class="line">                    <span class="comment">// 2</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException | BrokenBarrierException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        executorService.shutdown();</span><br><span class="line"></span><br><span class="line">        cyclicBarrier.reset();</span><br><span class="line"></span><br><span class="line">        System.out.println(cyclicBarrier.getParties()); <span class="comment">// 10</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="semaphore"><a class="markdownIt-Anchor" href="#semaphore"></a> <code>Semaphore</code></h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SemaphoreExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> clientCount = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> totalRequestCount = <span class="number">10</span>;</span><br><span class="line">      	<span class="comment">// ä¿¡å·é‡æ§åˆ¶æœ€å¤šåªæœ‰ clientCount å¹¶å‘æ‰§è¡Œ</span></span><br><span class="line">        Semaphore semaphore = <span class="keyword">new</span> Semaphore(clientCount);</span><br><span class="line">        ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; totalRequestCount; i++) &#123;</span><br><span class="line">            executorService.execute(()-&gt;&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    semaphore.acquire();</span><br><span class="line">                    System.out.print(semaphore.availablePermits() + <span class="string">&quot; &quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    semaphore.release();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        executorService.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="blockingqueue"><a class="markdownIt-Anchor" href="#blockingqueue"></a> <code>BlockingQueue</code></h5>
<p><code>BlockingQueue</code> ä¸»è¦ç”¨åœ¨ç”Ÿäº§è€…æ¶ˆè´¹è€…åœºæ™¯ï¼Œåœ¨ä»¥ä¸‹æƒ…å†µè®¿é—® <code>BlockingQueue</code> ä¼šé€ æˆé˜»å¡ï¼š</p>
<ul>
<li><code>BlockingQueue</code> å·²æ»¡çš„æƒ…å†µä¸‹è¿›è¡Œå…¥é˜Ÿæ“ä½œ</li>
<li><code>BlockingQueue</code> ä¸ºç©ºçš„æƒ…å†µä¸‹è¿›è¡Œå‡ºé˜Ÿæ“ä½œ</li>
</ul>
<p><code>BlockingQueue</code> æœ‰ä¸åŒçš„æ–¹æ³•è¿›è¡Œå…¥é˜Ÿã€å‡ºé˜Ÿæ“ä½œï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:center">æŠ›å‡ºå¼‚å¸¸</th>
<th style="text-align:center">è¿”å›å¸ƒå°”å€¼</th>
<th style="text-align:center">é˜»å¡</th>
<th style="text-align:center">é™æ—¶ç­‰å¾…</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>Insert</code></td>
<td style="text-align:center"><code>add(e)</code></td>
<td style="text-align:center"><code>offer(e)</code></td>
<td style="text-align:center"><code>put(e)</code></td>
<td style="text-align:center"><code>offer(e, time, unit)</code></td>
</tr>
<tr>
<td style="text-align:left"><code>Remove</code></td>
<td style="text-align:center"><code>remove()</code></td>
<td style="text-align:center"><code>poll()</code></td>
<td style="text-align:center"><code>take()</code></td>
<td style="text-align:center"><code>poll(time, unit)</code></td>
</tr>
<tr>
<td style="text-align:left"><code>Examine</code></td>
<td style="text-align:center"><code>element()</code></td>
<td style="text-align:center"><code>peek()</code></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>å…¶ä¸­é™æ—¶ç­‰å¾…æ“ä½œåœ¨åˆ°æ—¶åè¿”å› <code>true</code> æˆ– <code>false</code> ã€‚</p>
<p><code>BlockingQueue</code> ä¸»è¦å®ç°ç±»ï¼š</p>
<ul>
<li><code>ArrayBlockingQueue</code></li>
</ul>
<p>åŸºäºæ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</p>
<p>å¯ä»¥æ‰§è¡Œçº¿ç¨‹è®¿é—®é˜Ÿåˆ—çš„ç­–ç•¥ï¼Œé»˜è®¤ä¸ºéå…¬å¹³è®¿é—®ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayBlockingQueue</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractQueue</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">BlockingQueue</span>&lt;<span class="title">E</span>&gt;, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å…¥é˜Ÿå…ƒç´  */</span></span><br><span class="line">    <span class="keyword">final</span> Object[] items;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ä¸‹ä¸€ä¸ª take, poll, peek æˆ– remove çš„å…ƒç´ ä¸‹æ ‡ */</span></span><br><span class="line">    <span class="keyword">int</span> takeIndex;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ä¸‹ä¸€ä¸ª put, offer, æˆ– add çš„å…ƒç´ ä¸‹æ ‡ */</span></span><br><span class="line">    <span class="keyword">int</span> putIndex;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** é˜Ÿåˆ—ä¸­å…ƒç´ ä¸ªæ•° */</span></span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç­‰å¾… takes çš„ Condition */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Condition notEmpty;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ç­‰å¾… puts çš„ Condition */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Condition notFull;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¥é˜Ÿï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** Throws:</span></span><br><span class="line"><span class="comment">InterruptedException</span></span><br><span class="line"><span class="comment">NullPointerException */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(E e)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    checkNotNull(e); <span class="comment">// æ£€æŸ¥å…¥é˜Ÿå…ƒç´ æ˜¯å¦éç©º</span></span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</span><br><span class="line">    lock.lockInterruptibly();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (count == items.length)</span><br><span class="line">            notFull.await(); <span class="comment">// å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œçº¿ç¨‹é˜»å¡ï¼Œåœ¨ notFull ä¸Šç­‰å¾…å”¤é†’</span></span><br><span class="line">        enqueue(e); <span class="comment">// çœŸæ­£çš„å…¥é˜Ÿæ“ä½œ</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">checkNotNull</span><span class="params">(Object v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (v == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">enqueue</span><span class="params">(E x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Object[] items = <span class="keyword">this</span>.items;</span><br><span class="line">    items[putIndex] = x;</span><br><span class="line">    <span class="keyword">if</span> (++putIndex == items.length)</span><br><span class="line">        putIndex = <span class="number">0</span>;</span><br><span class="line">    count++;</span><br><span class="line">    notEmpty.signal(); <span class="comment">// å…¥é˜Ÿä¸€ä¸ªå…ƒç´ ï¼Œé˜Ÿåˆ—éç©ºï¼Œå”¤é†’åœ¨ notEmpty ä¸Šç­‰å¾…çš„çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‡ºé˜Ÿï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">take</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</span><br><span class="line">    lock.lockInterruptibly();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (count == <span class="number">0</span>)</span><br><span class="line">            notEmpty.await(); <span class="comment">// é˜Ÿåˆ—ä¸ºç©ºï¼Œçº¿ç¨‹é˜»å¡ï¼Œåœ¨ notEmpty ä¸Šç­‰å¾…å”¤é†’</span></span><br><span class="line">        <span class="keyword">return</span> dequeue(); <span class="comment">// å‡ºé˜Ÿ</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> E <span class="title">dequeue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Object[] items = <span class="keyword">this</span>.items;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    E x = (E) items[takeIndex];</span><br><span class="line">    items[takeIndex] = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (++takeIndex == items.length)</span><br><span class="line">        takeIndex = <span class="number">0</span>;</span><br><span class="line">    count--;</span><br><span class="line">    <span class="keyword">if</span> (itrs != <span class="keyword">null</span>)</span><br><span class="line">        itrs.elementDequeued(); <span class="comment">// æ›´æ–° iterator</span></span><br><span class="line">    notFull.signal(); <span class="comment">// é˜Ÿåˆ—æœªæ»¡ï¼Œå”¤é†’åœ¨ notFull ä¸Šç­‰å¾…çš„çº¿ç¨‹</span></span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>LinkedBlockingQueue</code></li>
</ul>
<p>åŸºäºé“¾è¡¨å®ç°çš„é˜»å¡é˜Ÿåˆ—ï¼Œé»˜è®¤é˜Ÿåˆ—é•¿åº¦æ˜¯ <code>Integer.MAX_VALUE</code>ï¼Œå¯ä»¥æ‰§è¡Œé˜Ÿåˆ—å¤§å°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedBlockingQueue</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractQueue</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">BlockingQueue</span>&lt;<span class="title">E</span>&gt;, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">        E item;</span><br><span class="line"></span><br><span class="line">        Node&lt;E&gt; next;</span><br><span class="line"></span><br><span class="line">        Node(E x) &#123; item = x; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å®¹é‡, é»˜è®¤ Integer.MAX_VALUE */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> capacity;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å…ƒç´ ä¸ªæ•° */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AtomicInteger count = <span class="keyword">new</span> AtomicInteger();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¡¨å¤´</span></span><br><span class="line"><span class="comment">     * Invariant: head.item == null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> Node&lt;E&gt; head;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¡¨å°¾</span></span><br><span class="line"><span class="comment">     * Invariant: last.next == null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Node&lt;E&gt; last;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å…¥é˜Ÿé” */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReentrantLock takeLock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Condition notEmpty = takeLock.newCondition();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** å‡ºé˜Ÿé” */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReentrantLock putLock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Condition notFull = putLock.newCondition();</span><br></pre></td></tr></table></figure>
<p>å…¥é˜Ÿï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">put</span><span class="params">(E e)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e == <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    <span class="comment">// Note: convention in all put/take/etc is to preset local var</span></span><br><span class="line">    <span class="comment">// holding count negative to indicate failure unless set.</span></span><br><span class="line">    <span class="keyword">int</span> c = -<span class="number">1</span>;</span><br><span class="line">    Node&lt;E&gt; node = <span class="keyword">new</span> Node&lt;E&gt;(e);</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock putLock = <span class="keyword">this</span>.putLock;</span><br><span class="line">    <span class="keyword">final</span> AtomicInteger count = <span class="keyword">this</span>.count;</span><br><span class="line">    putLock.lockInterruptibly();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (count.get() == capacity) &#123; <span class="comment">// é˜Ÿåˆ—å·²æ»¡</span></span><br><span class="line">            notFull.await(); <span class="comment">// çº¿ç¨‹é˜»å¡ï¼Œåœ¨ notFull ä¸Šç­‰å¾…</span></span><br><span class="line">        &#125;</span><br><span class="line">        enqueue(node); <span class="comment">// å…¥é˜Ÿ</span></span><br><span class="line">        c = count.getAndIncrement(); <span class="comment">// count + 1</span></span><br><span class="line">        <span class="keyword">if</span> (c + <span class="number">1</span> &lt; capacity)</span><br><span class="line">            notFull.signal();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        putLock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="number">0</span>)</span><br><span class="line">        signalNotEmpty();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">enqueue</span><span class="params">(Node&lt;E&gt; node)</span> </span>&#123;</span><br><span class="line">    last = last.next = node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‡ºé˜Ÿï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">take</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    E x;</span><br><span class="line">    <span class="keyword">int</span> c = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">final</span> AtomicInteger count = <span class="keyword">this</span>.count;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock takeLock = <span class="keyword">this</span>.takeLock;</span><br><span class="line">    takeLock.lockInterruptibly();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (count.get() == <span class="number">0</span>) &#123; <span class="comment">// é˜Ÿåˆ—ä¸ºç©º</span></span><br><span class="line">            notEmpty.await(); <span class="comment">// çº¿ç¨‹é˜»å¡ï¼Œåœ¨ notEmpty ä¸Šé˜»å¡</span></span><br><span class="line">        &#125;</span><br><span class="line">        x = dequeue(); <span class="comment">// å‡ºé˜Ÿ</span></span><br><span class="line">        c = count.getAndDecrement(); <span class="comment">// count - 1</span></span><br><span class="line">        <span class="keyword">if</span> (c &gt; <span class="number">1</span>)</span><br><span class="line">            notEmpty.signal(); </span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        takeLock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (c == capacity)</span><br><span class="line">        signalNotFull();</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> E <span class="title">dequeue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Node&lt;E&gt; h = head;</span><br><span class="line">    Node&lt;E&gt; first = h.next;</span><br><span class="line">    h.next = h; <span class="comment">// help GC</span></span><br><span class="line">    head = first;</span><br><span class="line">    E x = first.item;</span><br><span class="line">    first.item = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>PriorityBlockingQueue</code></li>
<li><code>DelayQueue</code></li>
</ul>
<h5 id="forkjoin"><a class="markdownIt-Anchor" href="#forkjoin"></a> ForkJoin</h5>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForkJoinDemo</span> <span class="keyword">extends</span> <span class="title">RecursiveTask</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> threshold;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> first;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> last;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ForkJoinDemo</span><span class="params">(<span class="keyword">int</span> threshold, <span class="keyword">int</span> first, <span class="keyword">int</span> last)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.threshold = threshold;</span><br><span class="line">        <span class="keyword">this</span>.first = first;</span><br><span class="line">        <span class="keyword">this</span>.last = last;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Integer <span class="title">compute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (last - first &lt;= threshold) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = first; i &lt;= last; i++) &#123;</span><br><span class="line">                result += i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> middle = first + (last - first) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">            ForkJoinDemo leftTask = <span class="keyword">new</span> ForkJoinDemo(threshold, first, middle);</span><br><span class="line">            leftTask.fork();</span><br><span class="line"></span><br><span class="line">            ForkJoinDemo rightTask = <span class="keyword">new</span> ForkJoinDemo(threshold, middle + <span class="number">1</span>, last);</span><br><span class="line">            rightTask.fork();</span><br><span class="line"></span><br><span class="line">            result = leftTask.join() + rightTask.join();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException </span>&#123;</span><br><span class="line">        ForkJoinDemo example = <span class="keyword">new</span> ForkJoinDemo(<span class="number">5</span>, <span class="number">1</span>, <span class="number">10000</span>);</span><br><span class="line">        <span class="comment">// ForkJoinPool æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ•°é‡å–å†³äº CPU æ ¸æ•°</span></span><br><span class="line">        ForkJoinPool forkJoinPool = <span class="keyword">new</span> ForkJoinPool();</span><br><span class="line">        Future result = forkJoinPool.submit(example);</span><br><span class="line">        System.out.println(result.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="aqs"><a class="markdownIt-Anchor" href="#aqs"></a> <code>AQS</code></h4>
<p>é˜Ÿåˆ—åŒæ­¥å™¨ï¼ˆ<code>AbstractQueuedSynchronizer</code>ï¼Œ<code>AQS</code>ï¼‰æ˜¯æ„å»ºé”ï¼ˆ<code>ReentrantLock</code>ï¼‰æˆ–å…¶ä»–åŒæ­¥ç»„ä»¶ï¼ˆ<code>CountDownLatch</code>ã€<code>CyclicBarrier</code>ã€<code>Semaphore</code> ç­‰ï¼‰çš„åŸºç¡€æ¡†æ¶ã€‚</p>
<h4 id="cas"><a class="markdownIt-Anchor" href="#cas"></a> <code>CAS</code></h4>
<p>æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare-and-Swapï¼Œ<code>CAS</code>ï¼‰ã€‚<code>CAS</code> æŒ‡ä»¤éœ€è¦æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜åœ°å€ <code>V</code>ã€æ—§çš„é¢„æœŸå€¼ <code>A</code> å’Œæ–°å€¼ <code>B</code>ã€‚å½“æ‰§è¡Œæ“ä½œæ—¶ï¼Œåªæœ‰å½“ <code>V</code> çš„å€¼ç­‰äº <code>A</code>ï¼Œæ‰å°† <code>V</code> çš„å€¼æ›´æ–°ä¸º <code>B</code>ã€‚</p>
<p>é—®é¢˜ï¼š</p>
<ul>
<li><code>ABA</code> é—®é¢˜</li>
<li>è‡ªæ—‹æ¶ˆè€—èµ„æº</li>
<li>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ</li>
</ul>
<h4 id="javaå†…å­˜æ¨¡å‹"><a class="markdownIt-Anchor" href="#javaå†…å­˜æ¨¡å‹"></a> Javaå†…å­˜æ¨¡å‹</h4>
<p><code>Java</code> å†…å­˜æ¨¡å‹è¯•å›¾å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ï¼Œä»¥å®ç°è®© <code>Java</code> ç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚</p>
<h5 id="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"><a class="markdownIt-Anchor" href="#ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"></a> ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜</h5>
<p><code>CPU</code> å¯„å­˜å™¨çš„è¯»å†™é€Ÿåº¦æ¯”å†…å­˜å¿«å‡ ä¸ªæ•°é‡çº§ï¼Œä¸ºäº†ç¼“è§£è¿™ç§é€Ÿåº¦çŸ›ç›¾ï¼Œåœ¨å®ƒä»¬ä¹‹é—´åŠ å…¥äº†é«˜é€Ÿç¼“å­˜ã€‚</p>
<p>ä½†æ˜¯åŠ å…¥é«˜é€Ÿç¼“å­˜å¸¦æ¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼š<strong>ç¼“å­˜ä¸€è‡´æ€§</strong>ã€‚</p>
<p>åœ¨å¹¶å‘ç¯å¢ƒä¸­ï¼Œé€šå¸¸å¤šä¸ªçº¿ç¨‹éœ€è¦å…±äº«ä¸»å†…å­˜ä¸­çš„æ•°æ®ï¼›æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œçº¿ç¨‹åªèƒ½åªèƒ½æ“ä½œè‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„æ•°æ®ï¼Œå› æ­¤éœ€è¦å°†ä¸»å†…å­˜ä¸­çš„æ•°æ®æ‹·è´åˆ°å·¥ä½œå†…å­˜ã€‚</p>
<h5 id="å†…å­˜é—´çš„äº¤äº’æ“ä½œ"><a class="markdownIt-Anchor" href="#å†…å­˜é—´çš„äº¤äº’æ“ä½œ"></a> å†…å­˜é—´çš„äº¤äº’æ“ä½œ</h5>
<p><img data-src="/archives/46bf65ac/%E5%86%85%E5%AD%98%E9%97%B4%E7%9A%84%E4%BA%A4%E4%BA%92%E6%93%8D%E4%BD%9C.png" alt="å†…å­˜é—´äº¤äº’æ“ä½œ"></p>
<ul>
<li>readï¼šæŠŠä¸€ä¸ªå˜é‡çš„å€¼ä»ä¸»å†…å­˜è¯»åˆ°å·¥ä½œå†…å­˜</li>
<li>loadï¼šæŠŠè¯»åˆ°çš„å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬</li>
<li>useï¼šä½¿ç”¨å˜é‡å‰¯æœ¬</li>
<li>assignï¼šæŠŠä¸€ä¸ªæ–°å€¼èµ‹ç»™å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬</li>
<li>storeï¼šæŠŠå·¥ä½œå†…å­˜ä¸­å˜é‡å‰¯æœ¬çš„å€¼å­˜åˆ°ä¸»å†…å­˜</li>
<li>writeï¼šæŠŠå€¼å†™å…¥ä¸»å†…å­˜ä¸­çš„å˜é‡</li>
<li>lockï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡</li>
<li>unlock</li>
</ul>
<h5 id="ä¸‰å¤§ç‰¹æ€§"><a class="markdownIt-Anchor" href="#ä¸‰å¤§ç‰¹æ€§"></a> ä¸‰å¤§ç‰¹æ€§</h5>
<ul>
<li>
<p><strong>åŸå­æ€§</strong></p>
<p>ä½¿ç”¨ç»§æ‰¿ <code>Number</code> ç±»çš„åŸå­ç±»æˆ–è€… <code>synchronized</code> å¯ä»¥ä¿è¯æ“ä½œçš„åŸå­æ€§</p>
</li>
<li>
<p><strong>å¯è§æ€§</strong></p>
<p>ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå…¶ä»–çº¿ç¨‹ç«‹åˆ»å¯è§ã€‚</p>
<p>ä½¿ç”¨ <code>volatile</code> æˆ– <code>synchronized</code> æ¥ä¿è¯å¯è§æ€§ã€‚</p>
</li>
<li>
<p><strong>æœ‰åºæ€§</strong></p>
<p>åœ¨ <code>Java</code> å†…å­˜æ¨¡å‹ä¸­ï¼Œå…è®¸ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œé‡æ’åºè¿‡ç¨‹ä¸ä¼šå½±å“åˆ°å•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œï¼Œå´ä¼šå½±å“åˆ°å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚</p>
<p><code>volatile</code> å…³é”®å­—é€šè¿‡æ·»åŠ <strong>å†…å­˜å±éšœ</strong>çš„æ–¹å¼æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œå³é‡æ’åºæ—¶ä¸èƒ½æŠŠåé¢çš„æŒ‡ä»¤æ”¾åˆ°å†…å­˜å±éšœä¹‹å‰ï¼›ä¹Ÿå¯ä»¥é€šè¿‡ <code>synchronized</code> æ¥ä¿è¯æœ‰åºæ€§ã€‚</p>
</li>
</ul>
<p>æ€»ç»“ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>synchronized</code> å¯ä»¥åŒæ—¶ä¿è¯ä¸‰å¤§ç‰¹æ€§</li>
<li><code>volatile</code> åªèƒ½ä¿è¯å¯è§æ€§ï¼Œæ— æ³•ä¿è¯åŸå­æ€§</li>
</ul>
<h5 id="happens-before"><a class="markdownIt-Anchor" href="#happens-before"></a> happens-before</h5>
<p>é™¤äº†å¯ä»¥ç”¨ <code>volatile</code> å’Œ <code>synchronized</code> æ¥ä¿è¯æœ‰åºæ€§ä¹‹å¤–ï¼Œ<code>JVM</code> è¿˜è§„å®šäº†å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼ˆhappens-beforeï¼‰ï¼Œè®©ä¸€ä¸ªæ“ä½œæ— éœ€æ§åˆ¶å°±èƒ½å…ˆäºå¦ä¸€ä¸ªæ“ä½œå®Œæˆã€‚</p>
<ul>
<li>
<p>å•ä¸€çº¿ç¨‹åŸåˆ™</p>
</li>
<li>
<p>ç®¡ç¨‹é”å®šåŸåˆ™</p>
<blockquote>
<p>ä¸€ä¸ª <code>unlock</code> æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„ <code>lock</code> æ“ä½œã€‚</p>
</blockquote>
</li>
<li>
<p><code>volatile</code> å˜é‡åŸåˆ™</p>
<blockquote>
<p>å¯¹ä¸€ä¸ª <code>volatile</code> å˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œã€‚</p>
</blockquote>
</li>
<li>
<p>çº¿ç¨‹å¯åŠ¨åŸåˆ™</p>
</li>
<li>
<p>çº¿ç¨‹åŠ å…¥åŸåˆ™</p>
</li>
<li>
<p>çº¿ç¨‹ä¸­æ–­åŸåˆ™</p>
</li>
<li>
<p>å¯¹è±¡ç»ˆç»“åŸåˆ™</p>
</li>
<li>
<p>ä¼ é€’æ€§åŸåˆ™</p>
</li>
</ul>
<h4 id="é¢è¯•é¢˜"><a class="markdownIt-Anchor" href="#é¢è¯•é¢˜"></a> é¢è¯•é¢˜</h4>
<h5 id="start-å’Œ-run-çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#start-å’Œ-run-çš„åŒºåˆ«"></a> <code>start()</code> å’Œ <code>run()</code> çš„åŒºåˆ«</h5>
<h5 id="sleep-å’Œ-wait-çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#sleep-å’Œ-wait-çš„åŒºåˆ«"></a> <code>sleep()</code> å’Œ <code>wait()</code> çš„åŒºåˆ«</h5>
<ul>
<li><code>wait</code> æ˜¯ <code>Object</code> ç±»ä¸­çš„æ–¹æ³•ï¼Œ<code>sleep</code> æ˜¯ <code>Thread</code>ç±»ä¸­çš„æ–¹æ³•ï¼›</li>
<li><code>wai</code>t ä¼šé‡Šæ”¾é”ï¼Œ<code>sleep</code> ä¸ä¼šé‡Šæ”¾é”ï¼›</li>
<li><code>wait</code> åªèƒ½åœ¨åŒæ­¥ä»£ç å—ä¸­ä½¿ç”¨ï¼Œ<code>sleep</code> åˆ™æ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚</li>
</ul>
<h5 id="æäº¤ä»»åŠ¡æ—¶ä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ä¼šå‘ç”Ÿä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#æäº¤ä»»åŠ¡æ—¶ä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ä¼šå‘ç”Ÿä»€ä¹ˆ"></a> æäº¤ä»»åŠ¡æ—¶ï¼Œä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆ</h5>
<h5 id="volatile-æ•°ç»„"><a class="markdownIt-Anchor" href="#volatile-æ•°ç»„"></a> <code>volatile</code> æ•°ç»„</h5>
<h5 id="synchronized-å’Œ-volatile-çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#synchronized-å’Œ-volatile-çš„åŒºåˆ«"></a> <code>synchronized</code> å’Œ <code>volatile</code> çš„åŒºåˆ«</h5>
<h5 id="æ‚²è§‚é”å’Œä¹è§‚é”"><a class="markdownIt-Anchor" href="#æ‚²è§‚é”å’Œä¹è§‚é”"></a> æ‚²è§‚é”å’Œä¹è§‚é”</h5>
<ul>
<li>æ‚²è§‚é”</li>
</ul>
<div class="note "><p>æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œè®¤ä¸ºåªè¦ä¸åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œå°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ‰€ä»¥æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œéƒ½è¦è¿›è¡ŒåŠ é”ã€‚</p>
</div>
<ul>
<li>ä¹è§‚é”</li>
</ul>
<h5 id="threadlocal-é€ æˆå†…å­˜æ³„æ¼çš„åŸå› "><a class="markdownIt-Anchor" href="#threadlocal-é€ æˆå†…å­˜æ³„æ¼çš„åŸå› "></a> <code>ThreadLocal</code> é€ æˆå†…å­˜æ³„æ¼çš„åŸå› </h5>
<h5 id="linkedblockingqueue-å…¥é˜Ÿå‡ºé˜Ÿä¸ºä»€ä¹ˆç”¨ä¸åŒçš„é”"><a class="markdownIt-Anchor" href="#linkedblockingqueue-å…¥é˜Ÿå‡ºé˜Ÿä¸ºä»€ä¹ˆç”¨ä¸åŒçš„é”"></a> <code>LinkedBlockingQueue</code> å…¥é˜Ÿå‡ºé˜Ÿä¸ºä»€ä¹ˆç”¨ä¸åŒçš„é”</h5>
]]></content>
      <categories>
        <category>å¹¶å‘</category>
      </categories>
      <tags>
        <tag>çº¿ç¨‹æ± </tag>
        <tag>å¹¶å‘</tag>
        <tag>çº¿ç¨‹çŠ¶æ€</tag>
        <tag>çº¿ç¨‹åŒæ­¥</tag>
        <tag>çº¿ç¨‹åä½œ</tag>
        <tag>J.U.C æ„ä»¶</tag>
      </tags>
  </entry>
</search>
